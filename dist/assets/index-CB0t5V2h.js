const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Hero-CDI0wvTv.js","assets/react-vendor-CFUw3ryi.js","assets/ui-vendor-eNYioA07.js","assets/three-vendor-BrABmvss.js","assets/utils-DHB884HB.js","assets/Gallery-CmGTIS8R.js","assets/SortSelector-CEzyUWZ9.js","assets/UploadModal-BlFGJflc.js","assets/useCachedResource-n6WnA5U0.js","assets/Music-BhfX1ECh.js","assets/Videos-BIt8DV1d.js","assets/Articles-BskP2nIc.js","assets/Events-CB0wXrOA.js","assets/HomeCategories-5YaRZN-V.js","assets/About-B4hrRpC1.js","assets/AdminDashboard-CJ_w9TJE.js","assets/NotFound-BxedmCRO.js","assets/browser-ponyfill-DUDQbm29.js"])))=>i.map(i=>d[i]);
var Is=Object.defineProperty;var Us=(t,e,n)=>e in t?Is(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var he=(t,e,n)=>Us(t,typeof e!="symbol"?e+"":e,n);import{a as p,j as a,R as te,A as re,m as U,b as Bt,u as xt,L as st,c as Ds,d as As,H as Bs,e as Fs,f as ce}from"./react-vendor-CFUw3ryi.js";import{s as Hs,V as Z,U as we,S as q,D as $s,a as Gs,b as Vs,c as Ws,W as oe,L as it,M as Ks,C as An,N as at,F as qs,B as ze,E as Ft,d as Bn,e as Fn,f as P,g as Kt,O as Xs,h as Zs,i as Ze,j as Je,k as me,l as Js,m as Ce,n as Hn,T as $n,R as Gn,P as Ys,A as Qs,o as Ht,p as qt,q as Xt,u as Vn,r as ei,H as ti,t as Oe,v as ni,w as si,x as ii,y as ai,z as ri,G as oi,I as wt,J as Me,K as Pt,Q as Wn,X as Kn,Y as We,Z as et,_ as vt,$ as Zt,a0 as rt,a1 as se,a2 as li}from"./three-vendor-BrABmvss.js";import{n as W,R as Jt,G as ci,X as de,U as qn,L as Xn,a as Zn,A as Jn,S as Yn,b as Qn,F as es,H as ts,M as ns,C as ss,D as is,B as as,N as rs,W as os,O as ls,c as ui,d as di,e as ot,I as lt,f as Be,g as ct,h as ut,i as dt,j as Yt,k as cs,l as Ue,m as hi,o as St,p as fi,P as Qt,q as pi,r as mi,s as gi,t as en,u as xi,v as vi,w as tn,x as nn,y as sn,z as yi,E as bi,J as wi,K as Si,Q as ji,T as Ci,V as _i,Y as Ei}from"./ui-vendor-eNYioA07.js";import{a as tt}from"./utils-DHB884HB.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const us=p.createContext(),Ni=()=>p.useContext(us),Ti=({children:t})=>{const[e,n]=p.useState(null),[s,i]=p.useState(!1),[r,o]=p.useState([]),[l,c]=p.useState(!1),u=p.useRef(new Audio),h=()=>{s?u.current.pause():u.current.play().catch(m=>console.error("Playback failed",m)),i(!s)},d=(m,x=[])=>{x.length>0&&o(x),(e==null?void 0:e.id)===m.id?h():(n(m),i(!0),c(!0),u.current.src=m.audio,u.current.play().catch(v=>console.error("Playback failed",v)))};p.useEffect(()=>{const m=u.current,x=()=>{if(r.length>0&&e){const y=(r.findIndex(w=>w.id===e.id)+1)%r.length;d(r[y],r)}else i(!1)};return m.addEventListener("ended",x),()=>m.removeEventListener("ended",x)},[e,r]);const g=()=>{if(r.length===0||!e)return;const x=(r.findIndex(v=>v.id===e.id)+1)%r.length;d(r[x])},f=()=>{if(r.length===0||!e)return;const x=(r.findIndex(v=>v.id===e.id)-1+r.length)%r.length;d(r[x])};return a.jsx(us.Provider,{value:{currentTrack:e,isPlaying:s,playlist:r,playTrack:d,togglePlay:h,nextTrack:g,prevTrack:f,audioRef:u,isMiniPlayerVisible:l,setIsMiniPlayerVisible:c},children:t})},B=tt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});B.interceptors.request.use(t=>{const e=sessionStorage.getItem("token")||localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));B.interceptors.response.use(t=>t,async t=>{const e=t.config;return(!e||!e.retry)&&(e.retry=0),e.retry<3&&(t.message==="Network Error"||t.response&&t.response.status>=500)?(e.retry+=1,await new Promise(s=>setTimeout(s,1e3*e.retry)),B(e)):(console.error("API Error:",t.response?t.response.data:t.message),Promise.reject(t))});const xl=(t,e)=>B.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}),ds=p.createContext(),yt=()=>p.useContext(ds),ki=({children:t})=>{const[e,n]=p.useState({pagination_enabled:"false",theme:"space",language:"zh",site_title:"拓途浙享"}),[s,i]=p.useState(()=>{const f=localStorage.getItem("cursorEnabled");return f!==null?JSON.parse(f):!0}),[r,o]=p.useState(()=>localStorage.getItem("background_scene")||"space"),l=f=>{o(f),localStorage.setItem("background_scene",f)},c=()=>{i(f=>{const m=!f;return localStorage.setItem("cursorEnabled",JSON.stringify(m)),m})},[u,h]=p.useState(!0),d=()=>{B.get("/settings").then(f=>{n(m=>({...m,...f.data})),h(!1)}).catch(f=>{console.error("Failed to fetch settings:",f),h(!1)})};p.useEffect(()=>{d()},[]);const g=(f,m)=>{B.post("/settings",{key:f,value:m}).then(x=>{x.data.success&&n(v=>({...v,[f]:String(m)}))}).catch(x=>console.error("Failed to update setting:",x))};return a.jsx(ds.Provider,{value:{settings:e,updateSetting:g,loading:u,cursorEnabled:s,toggleCursor:c,backgroundScene:r,changeBackgroundScene:l},children:t})},hs=p.createContext(),Ke=()=>p.useContext(hs),Ri=({children:t})=>{const[e,n]=p.useState(null),[s,i]=p.useState(!0);p.useEffect(()=>{const u=localStorage.getItem("token");u?(B.defaults.headers.common.Authorization=`Bearer ${u}`,B.get("/auth/me").then(h=>n(h.data)).catch(h=>{h.response&&(h.response.status===401||h.response.status===403)&&(localStorage.removeItem("token"),delete B.defaults.headers.common.Authorization)}).finally(()=>i(!1))):i(!1)},[]);const r=async(u,h)=>{var d,g;try{const f=await B.post("/auth/login",{username:u,password:h}),{token:m,user:x}=f.data;return localStorage.setItem("token",m),B.defaults.headers.common.Authorization=`Bearer ${m}`,n(x),W.success(`Welcome back, ${x.username}!`),!0}catch(f){return console.error(f),W.error(((g=(d=f.response)==null?void 0:d.data)==null?void 0:g.error)||"Login failed"),!1}},o=async(u,h)=>{var d,g;try{const f=await B.post("/auth/register",{username:u,password:h}),{token:m,user:x}=f.data;return localStorage.setItem("token",m),B.defaults.headers.common.Authorization=`Bearer ${m}`,n(x),W.success(`Welcome, ${x.username}!`),!0}catch(f){return console.error(f),W.error(((g=(d=f.response)==null?void 0:d.data)==null?void 0:g.error)||"Registration failed"),!1}},l=()=>{localStorage.removeItem("token"),delete B.defaults.headers.common.Authorization,n(null),W.success("Logged out successfully")},c=async()=>{try{const u=await B.get("/auth/me");n(u.data)}catch(u){console.error(u)}};return a.jsx(hs.Provider,{value:{user:e,login:r,register:o,logout:l,loading:s,refreshUser:c,isAdmin:(e==null?void 0:e.role)==="admin"},children:t})};var fs=(t=>(t.BASE="base",t.BODY="body",t.HEAD="head",t.HTML="html",t.LINK="link",t.META="meta",t.NOSCRIPT="noscript",t.SCRIPT="script",t.STYLE="style",t.TITLE="title",t.FRAGMENT="Symbol(react.fragment)",t))(fs||{}),jt={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}};Object.values(fs);var $t={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"};Object.entries($t).reduce((t,[e,n])=>(t[n]=e,t),{});var Fe="data-rh",Pi=t=>Array.isArray(t)?t.join(""):t,zi=(t,e)=>{const n=Object.keys(t);for(let s=0;s<n.length;s+=1)if(e[n[s]]&&e[n[s]].includes(t[n[s]]))return!0;return!1},Ct=(t,e)=>Array.isArray(t)?t.reduce((n,s)=>(zi(s,e)?n.priority.push(s):n.default.push(s),n),{priority:[],default:[]}):{default:t,priority:[]},Oi=["noscript","script","style"],zt=(t,e=!0)=>e===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),ps=t=>Object.keys(t).reduce((e,n)=>{const s=typeof t[n]<"u"?`${n}="${t[n]}"`:`${n}`;return e?`${e} ${s}`:s},""),Mi=(t,e,n,s)=>{const i=ps(n),r=Pi(e);return i?`<${t} ${Fe}="true" ${i}>${zt(r,s)}</${t}>`:`<${t} ${Fe}="true">${zt(r,s)}</${t}>`},Li=(t,e,n=!0)=>e.reduce((s,i)=>{const r=i,o=Object.keys(r).filter(u=>!(u==="innerHTML"||u==="cssText")).reduce((u,h)=>{const d=typeof r[h]>"u"?h:`${h}="${zt(r[h],n)}"`;return u?`${u} ${d}`:d},""),l=r.innerHTML||r.cssText||"",c=Oi.indexOf(t)===-1;return`${s}<${t} ${Fe}="true" ${o}${c?"/>":`>${l}</${t}>`}`},""),ms=(t,e={})=>Object.keys(t).reduce((n,s)=>{const i=$t[s];return n[i||s]=t[s],n},e),Ii=(t,e,n)=>{const s={key:e,[Fe]:!0},i=ms(n,s);return[te.createElement("title",i,e)]},nt=(t,e)=>e.map((n,s)=>{const i={key:s,[Fe]:!0};return Object.keys(n).forEach(r=>{const l=$t[r]||r;if(l==="innerHTML"||l==="cssText"){const c=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:c}}else i[l]=n[r]}),te.createElement(t,i)}),ne=(t,e,n=!0)=>{switch(t){case"title":return{toComponent:()=>Ii(t,e.title,e.titleAttributes),toString:()=>Mi(t,e.title,e.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>ms(e),toString:()=>ps(e)};default:return{toComponent:()=>nt(t,e),toString:()=>Li(t,e,n)}}},Ui=({metaTags:t,linkTags:e,scriptTags:n,encode:s})=>{const i=Ct(t,jt.meta),r=Ct(e,jt.link),o=Ct(n,jt.script);return{priorityMethods:{toComponent:()=>[...nt("meta",i.priority),...nt("link",r.priority),...nt("script",o.priority)],toString:()=>`${ne("meta",i.priority,s)} ${ne("link",r.priority,s)} ${ne("script",o.priority,s)}`},metaTags:i.default,linkTags:r.default,scriptTags:o.default}},Di=t=>{const{baseTag:e,bodyAttributes:n,encode:s=!0,htmlAttributes:i,noscriptTags:r,styleTags:o,title:l="",titleAttributes:c,prioritizeSeoTags:u}=t;let{linkTags:h,metaTags:d,scriptTags:g}=t,f={toComponent:()=>{},toString:()=>""};return u&&({priorityMethods:f,linkTags:h,metaTags:d,scriptTags:g}=Ui(t)),{priority:f,base:ne("base",e,s),bodyAttributes:ne("bodyAttributes",n,s),htmlAttributes:ne("htmlAttributes",i,s),link:ne("link",h,s),meta:ne("meta",d,s),noscript:ne("noscript",r,s),script:ne("script",g,s),style:ne("style",o,s),title:ne("title",{title:l,titleAttributes:c},s)}},Ai=Di,Ye=[],gs=!!(typeof window<"u"&&window.document&&window.document.createElement),Bi=class{constructor(t,e){he(this,"instances",[]);he(this,"canUseDOM",gs);he(this,"context");he(this,"value",{setHelmet:t=>{this.context.helmet=t},helmetInstances:{get:()=>this.canUseDOM?Ye:this.instances,add:t=>{(this.canUseDOM?Ye:this.instances).push(t)},remove:t=>{const e=(this.canUseDOM?Ye:this.instances).indexOf(t);(this.canUseDOM?Ye:this.instances).splice(e,1)}}});this.context=t,this.canUseDOM=e||!1,e||(t.helmet=Ai({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Fi={},Hi=te.createContext(Fi),be,$i=(be=class extends p.Component{constructor(n){super(n);he(this,"helmetData");this.helmetData=new Bi(this.props.context||{},be.canUseDOM)}render(){return te.createElement(Hi.Provider,{value:this.helmetData.value},this.props.children)}},he(be,"canUseDOM",gs),be);class Re extends te.Component{constructor(n){super(n);he(this,"handleReset",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("Uncaught error:",n,s)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:this.props.silent||this.props.variant==="inline"?null:a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black text-white p-6 text-center z-[100] relative",children:[a.jsx("h1",{className:"text-4xl font-bold font-serif text-red-500 mb-4",children:"Something went wrong"}),a.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:"The application encountered an error but has attempted to contain it."}),this.state.error&&a.jsx("div",{className:"bg-white/5 border border-white/10 p-4 rounded-lg text-left text-xs font-mono text-red-300 max-w-2xl overflow-auto mb-8 w-full max-h-48",children:this.state.error.toString()}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("button",{onClick:()=>{this.handleReset()},className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-full transition-colors font-bold",children:[a.jsx(Jt,{size:20}),"Try Again"]}),a.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors font-bold",children:[a.jsx(Jt,{size:20}),"Force Reload"]})]})]}):this.props.children}}const C=t=>typeof t=="string",Le=()=>{let t,e;const n=new Promise((s,i)=>{t=s,e=i});return n.resolve=t,n.reject=e,n},an=t=>t==null?"":""+t,Gi=(t,e,n)=>{t.forEach(s=>{e[s]&&(n[s]=e[s])})},Vi=/###/g,rn=t=>t&&t.indexOf("###")>-1?t.replace(Vi,"."):t,on=t=>!t||C(t),De=(t,e,n)=>{const s=C(e)?e.split("."):e;let i=0;for(;i<s.length-1;){if(on(t))return{};const r=rn(s[i]);!t[r]&&n&&(t[r]=new n),Object.prototype.hasOwnProperty.call(t,r)?t=t[r]:t={},++i}return on(t)?{}:{obj:t,k:rn(s[i])}},ln=(t,e,n)=>{const{obj:s,k:i}=De(t,e,Object);if(s!==void 0||e.length===1){s[i]=n;return}let r=e[e.length-1],o=e.slice(0,e.length-1),l=De(t,o,Object);for(;l.obj===void 0&&o.length;)r=`${o[o.length-1]}.${r}`,o=o.slice(0,o.length-1),l=De(t,o,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${r}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${r}`]=n},Wi=(t,e,n,s)=>{const{obj:i,k:r}=De(t,e,Object);i[r]=i[r]||[],i[r].push(n)},ht=(t,e)=>{const{obj:n,k:s}=De(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,s))return n[s]},Ki=(t,e,n)=>{const s=ht(t,n);return s!==void 0?s:ht(e,n)},xs=(t,e,n)=>{for(const s in e)s!=="__proto__"&&s!=="constructor"&&(s in t?C(t[s])||t[s]instanceof String||C(e[s])||e[s]instanceof String?n&&(t[s]=e[s]):xs(t[s],e[s],n):t[s]=e[s]);return t},Ne=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var qi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Xi=t=>C(t)?t.replace(/[&<>"'\/]/g,e=>qi[e]):t;class Zi{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const s=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,s),this.regExpQueue.push(e),s}}const Ji=[" ",",","?","!",";"],Yi=new Zi(20),Qi=(t,e,n)=>{e=e||"",n=n||"";const s=Ji.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(s.length===0)return!0;const i=Yi.getRegExp(`(${s.map(o=>o==="?"?"\\?":o).join("|")})`);let r=!i.test(t);if(!r){const o=t.indexOf(n);o>0&&!i.test(t.substring(0,o))&&(r=!0)}return r},Ot=(t,e,n=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const s=e.split(n);let i=t;for(let r=0;r<s.length;){if(!i||typeof i!="object")return;let o,l="";for(let c=r;c<s.length;++c)if(c!==r&&(l+=n),l+=s[c],o=i[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<s.length-1)continue;r+=c-r+1;break}i=o}return i},He=t=>t==null?void 0:t.replace("_","-"),ea={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var n,s;(s=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||s.call(n,console,e)}};class ft{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||ea,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,s,i){return i&&!this.debug?null:(C(e[0])&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new ft(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ft(this.logger,e)}}var ae=new ft;class bt{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(s=>{this.observers[s]||(this.observers[s]=new Map);const i=this.observers[s].get(n)||0;this.observers[s].set(n,i+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([i,r])=>{for(let o=0;o<r;o++)i(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,r])=>{for(let o=0;o<r;o++)i.apply(i,[e,...n])})}}class cn extends bt{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,s,i={}){var u,h;const r=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],s&&(Array.isArray(s)?l.push(...s):C(s)&&r?l.push(...s.split(r)):l.push(s)));const c=ht(this.data,l);return!c&&!n&&!s&&e.indexOf(".")>-1&&(e=l[0],n=l[1],s=l.slice(2).join(".")),c||!o||!C(s)?c:Ot((h=(u=this.data)==null?void 0:u[e])==null?void 0:h[n],s,r)}addResource(e,n,s,i,r={silent:!1}){const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let l=[e,n];s&&(l=l.concat(o?s.split(o):s)),e.indexOf(".")>-1&&(l=e.split("."),i=n,n=l[1]),this.addNamespaces(n),ln(this.data,l,i),r.silent||this.emit("added",e,n,s,i)}addResources(e,n,s,i={silent:!1}){for(const r in s)(C(s[r])||Array.isArray(s[r]))&&this.addResource(e,n,r,s[r],{silent:!0});i.silent||this.emit("added",e,n,s)}addResourceBundle(e,n,s,i,r,o={silent:!1,skipCopy:!1}){let l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),i=s,s=n,n=l[1]),this.addNamespaces(n);let c=ht(this.data,l)||{};o.skipCopy||(s=JSON.parse(JSON.stringify(s))),i?xs(c,s,r):c={...c,...s},ln(this.data,l,c),o.silent||this.emit("added",e,n,s)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(i=>n[i]&&Object.keys(n[i]).length>0)}toJSON(){return this.data}}var vs={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,s,i){return t.forEach(r=>{var o;e=((o=this.processors[r])==null?void 0:o.process(e,n,s,i))??e}),e}};const ys=Symbol("i18next/PATH_KEY");function ta(){const t=[],e=Object.create(null);let n;return e.get=(s,i)=>{var r;return(r=n==null?void 0:n.revoke)==null||r.call(n),i===ys?t:(t.push(i),n=Proxy.revocable(s,e),n.proxy)},Proxy.revocable(Object.create(null),e).proxy}function Mt(t,e){const{[ys]:n}=t(ta());return n.join((e==null?void 0:e.keySeparator)??".")}const un={},_t=t=>!C(t)&&typeof t!="boolean"&&typeof t!="number";class pt extends bt{constructor(e,n={}){super(),Gi(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ae.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const s={...n};if(e==null)return!1;const i=this.resolve(e,s);if((i==null?void 0:i.res)===void 0)return!1;const r=_t(i.res);return!(s.returnObjects===!1&&r)}extractFromKey(e,n){let s=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let r=n.ns||this.options.defaultNS||[];const o=s&&e.indexOf(s)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!Qi(e,s,i);if(o&&!l){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:C(r)?[r]:r};const u=e.split(s);(s!==i||s===i&&this.options.ns.indexOf(u[0])>-1)&&(r=u.shift()),e=u.join(i)}return{key:e,namespaces:C(r)?[r]:r}}translate(e,n,s){let i=typeof n=="object"?{...n}:n;if(typeof i!="object"&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),typeof i=="object"&&(i={...i}),i||(i={}),e==null)return"";typeof e=="function"&&(e=Mt(e,{...this.options,...i})),Array.isArray(e)||(e=[String(e)]);const r=i.returnDetails!==void 0?i.returnDetails:this.options.returnDetails,o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],i),u=c[c.length-1];let h=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const d=i.lng||this.language,g=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((d==null?void 0:d.toLowerCase())==="cimode")return g?r?{res:`${u}${h}${l}`,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:`${u}${h}${l}`:r?{res:l,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:l;const f=this.resolve(e,i);let m=f==null?void 0:f.res;const x=(f==null?void 0:f.usedKey)||l,v=(f==null?void 0:f.exactUsedKey)||l,y=["[object Number]","[object Function]","[object RegExp]"],w=i.joinArrays!==void 0?i.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,_=i.count!==void 0&&!C(i.count),L=pt.hasDefaultValue(i),H=_?this.pluralResolver.getSuffix(d,i.count,i):"",D=i.ordinal&&_?this.pluralResolver.getSuffix(d,i.count,{ordinal:!1}):"",$=_&&!i.ordinal&&i.count===0,z=$&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${H}`]||i[`defaultValue${D}`]||i.defaultValue;let T=m;S&&!m&&L&&(T=z);const A=_t(T),j=Object.prototype.toString.apply(T);if(S&&T&&A&&y.indexOf(j)<0&&!(C(w)&&Array.isArray(T))){if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const N=this.options.returnedObjectHandler?this.options.returnedObjectHandler(x,T,{...i,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return r?(f.res=N,f.usedParams=this.getUsedParamsDetails(i),f):N}if(o){const N=Array.isArray(T),k=N?[]:{},I=N?v:x;for(const F in T)if(Object.prototype.hasOwnProperty.call(T,F)){const G=`${I}${o}${F}`;L&&!m?k[F]=this.translate(G,{...i,defaultValue:_t(z)?z[F]:void 0,joinArrays:!1,ns:c}):k[F]=this.translate(G,{...i,joinArrays:!1,ns:c}),k[F]===G&&(k[F]=T[F])}m=k}}else if(S&&C(w)&&Array.isArray(m))m=m.join(w),m&&(m=this.extendTranslation(m,e,i,s));else{let N=!1,k=!1;!this.isValidLookup(m)&&L&&(N=!0,m=z),this.isValidLookup(m)||(k=!0,m=l);const F=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&k?void 0:m,G=L&&z!==m&&this.options.updateMissing;if(k||N||G){if(this.logger.log(G?"updateKey":"missingKey",d,u,l,G?z:m),o){const O=this.resolve(l,{...i,keySeparator:!1});O&&O.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let b=[];const K=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if(this.options.saveMissingTo==="fallback"&&K&&K[0])for(let O=0;O<K.length;O++)b.push(K[O]);else this.options.saveMissingTo==="all"?b=this.languageUtils.toResolveHierarchy(i.lng||this.language):b.push(i.lng||this.language);const V=(O,Q,le)=>{var Ee;const ge=L&&le!==m?le:F;this.options.missingKeyHandler?this.options.missingKeyHandler(O,u,Q,ge,G,i):(Ee=this.backendConnector)!=null&&Ee.saveMissing&&this.backendConnector.saveMissing(O,u,Q,ge,G,i),this.emit("missingKey",O,u,Q,m)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?b.forEach(O=>{const Q=this.pluralResolver.getSuffixes(O,i);$&&i[`defaultValue${this.options.pluralSeparator}zero`]&&Q.indexOf(`${this.options.pluralSeparator}zero`)<0&&Q.push(`${this.options.pluralSeparator}zero`),Q.forEach(le=>{V([O],l+le,i[`defaultValue${le}`]||z)})}):V(b,l,z))}m=this.extendTranslation(m,e,i,f,s),k&&m===l&&this.options.appendNamespaceToMissingKey&&(m=`${u}${h}${l}`),(k||N)&&this.options.parseMissingKeyHandler&&(m=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${h}${l}`:l,N?m:void 0,i))}return r?(f.res=m,f.usedParams=this.getUsedParamsDetails(i),f):m}extendTranslation(e,n,s,i,r){var c,u;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const h=C(e)&&(((u=s==null?void 0:s.interpolation)==null?void 0:u.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(h){const f=e.match(this.interpolator.nestingRegexp);d=f&&f.length}let g=s.replace&&!C(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),e=this.interpolator.interpolate(e,g,s.lng||this.language||i.usedLng,s),h){const f=e.match(this.interpolator.nestingRegexp),m=f&&f.length;d<m&&(s.nest=!1)}!s.lng&&i&&i.res&&(s.lng=this.language||i.usedLng),s.nest!==!1&&(e=this.interpolator.nest(e,(...f)=>(r==null?void 0:r[0])===f[0]&&!s.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):this.translate(...f,n),s)),s.interpolation&&this.interpolator.reset()}const o=s.postProcess||this.options.postProcess,l=C(o)?[o]:o;return e!=null&&(l!=null&&l.length)&&s.applyPostProcessor!==!1&&(e=vs.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),e}resolve(e,n={}){let s,i,r,o,l;return C(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(s))return;const u=this.extractFromKey(c,n),h=u.key;i=h;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const g=n.count!==void 0&&!C(n.count),f=g&&!n.ordinal&&n.count===0,m=n.context!==void 0&&(C(n.context)||typeof n.context=="number")&&n.context!=="",x=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);d.forEach(v=>{var y,w;this.isValidLookup(s)||(l=v,!un[`${x[0]}-${v}`]&&((y=this.utils)!=null&&y.hasLoadedNamespace)&&!((w=this.utils)!=null&&w.hasLoadedNamespace(l))&&(un[`${x[0]}-${v}`]=!0,this.logger.warn(`key "${i}" for languages "${x.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),x.forEach(S=>{var H;if(this.isValidLookup(s))return;o=S;const _=[h];if((H=this.i18nFormat)!=null&&H.addLookupKeys)this.i18nFormat.addLookupKeys(_,h,S,v,n);else{let D;g&&(D=this.pluralResolver.getSuffix(S,n.count,n));const $=`${this.options.pluralSeparator}zero`,z=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(g&&(n.ordinal&&D.indexOf(z)===0&&_.push(h+D.replace(z,this.options.pluralSeparator)),_.push(h+D),f&&_.push(h+$)),m){const T=`${h}${this.options.contextSeparator||"_"}${n.context}`;_.push(T),g&&(n.ordinal&&D.indexOf(z)===0&&_.push(T+D.replace(z,this.options.pluralSeparator)),_.push(T+D),f&&_.push(T+$))}}let L;for(;L=_.pop();)this.isValidLookup(s)||(r=L,s=this.getResource(S,v,L,n))}))})}),{res:s,usedKey:i,exactUsedKey:r,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,s,i={}){var r;return(r=this.i18nFormat)!=null&&r.getResource?this.i18nFormat.getResource(e,n,s,i):this.resourceStore.getResource(e,n,s,i)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=e.replace&&!C(e.replace);let i=s?e.replace:e;if(s&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!s){i={...i};for(const r of n)delete i[r]}return i}static hasDefaultValue(e){const n="defaultValue";for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&n===s.substring(0,n.length)&&e[s]!==void 0)return!0;return!1}}class dn{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ae.create("languageUtils")}getScriptPartFromCode(e){if(e=He(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=He(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(C(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(s=>{if(n)return;const i=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(i))&&(n=i)}),!n&&this.options.supportedLngs&&e.forEach(s=>{if(n)return;const i=this.getScriptPartFromCode(s);if(this.isSupportedCode(i))return n=i;const r=this.getLanguagePartFromCode(s);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(o=>{if(o===r)return o;if(!(o.indexOf("-")<0&&r.indexOf("-")<0)&&(o.indexOf("-")>0&&r.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===r||o.indexOf(r)===0&&r.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),C(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let s=e[n];return s||(s=e[this.getScriptPartFromCode(n)]),s||(s=e[this.formatLanguageCode(n)]),s||(s=e[this.getLanguagePartFromCode(n)]),s||(s=e.default),s||[]}toResolveHierarchy(e,n){const s=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),i=[],r=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return C(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(e))):C(e)&&r(this.formatLanguageCode(e)),s.forEach(o=>{i.indexOf(o)<0&&r(this.formatLanguageCode(o))}),i}}const hn={zero:0,one:1,two:2,few:3,many:4,other:5},fn={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class na{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=ae.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const s=He(e==="dev"?"en":e),i=n.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:s,type:i});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let o;try{o=new Intl.PluralRules(s,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),fn;if(!e.match(/-|_/))return fn;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,n)}return this.pluralRulesCache[r]=o,o}needsPlural(e,n={}){let s=this.getRule(e,n);return s||(s=this.getRule("dev",n)),(s==null?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,n,s={}){return this.getSuffixes(e,s).map(i=>`${n}${i}`)}getSuffixes(e,n={}){let s=this.getRule(e,n);return s||(s=this.getRule("dev",n)),s?s.resolvedOptions().pluralCategories.sort((i,r)=>hn[i]-hn[r]).map(i=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,n,s={}){const i=this.getRule(e,s);return i?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${i.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,s))}}const pn=(t,e,n,s=".",i=!0)=>{let r=Ki(t,e,n);return!r&&i&&C(n)&&(r=Ot(t,n,s),r===void 0&&(r=Ot(e,n,s))),r},Et=t=>t.replace(/\$/g,"$$$$");class mn{constructor(e={}){var n;this.logger=ae.create("interpolator"),this.options=e,this.format=((n=e==null?void 0:e.interpolation)==null?void 0:n.format)||(s=>s),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:s,useRawValueToEscape:i,prefix:r,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:u,unescapeSuffix:h,unescapePrefix:d,nestingPrefix:g,nestingPrefixEscaped:f,nestingSuffix:m,nestingSuffixEscaped:x,nestingOptionsSeparator:v,maxReplaces:y,alwaysFormat:w}=e.interpolation;this.escape=n!==void 0?n:Xi,this.escapeValue=s!==void 0?s:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=r?Ne(r):o||"{{",this.suffix=l?Ne(l):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=h?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=g?Ne(g):f||Ne("$t("),this.nestingSuffix=m?Ne(m):x||Ne(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=y||1e3,this.alwaysFormat=w!==void 0?w:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,s)=>(n==null?void 0:n.source)===s?(n.lastIndex=0,n):new RegExp(s,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,s,i){var f;let r,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=m=>{if(m.indexOf(this.formatSeparator)<0){const w=pn(n,c,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(w,void 0,s,{...i,...n,interpolationkey:m}):w}const x=m.split(this.formatSeparator),v=x.shift().trim(),y=x.join(this.formatSeparator).trim();return this.format(pn(n,c,v,this.options.keySeparator,this.options.ignoreJSONStructure),y,s,{...i,...n,interpolationkey:v})};this.resetRegExp();const h=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((f=i==null?void 0:i.interpolation)==null?void 0:f.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Et(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Et(this.escape(m)):Et(m)}].forEach(m=>{for(l=0;r=m.regex.exec(e);){const x=r[1].trim();if(o=u(x),o===void 0)if(typeof h=="function"){const y=h(e,r,i);o=C(y)?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,x))o="";else if(d){o=r[0];continue}else this.logger.warn(`missed to pass in variable ${x} for interpolating ${e}`),o="";else!C(o)&&!this.useRawValueToEscape&&(o=an(o));const v=m.safeValue(o);if(e=e.replace(r[0],v),d?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=r[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n,s={}){let i,r,o;const l=(c,u)=>{const h=this.nestingOptionsSeparator;if(c.indexOf(h)<0)return c;const d=c.split(new RegExp(`${h}[ ]*{`));let g=`{${d[1]}`;c=d[0],g=this.interpolate(g,o);const f=g.match(/'/g),m=g.match(/"/g);(((f==null?void 0:f.length)??0)%2===0&&!m||m.length%2!==0)&&(g=g.replace(/'/g,'"'));try{o=JSON.parse(g),u&&(o={...u,...o})}catch(x){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,x),`${c}${h}${g}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;i=this.nestingRegexp.exec(e);){let c=[];o={...s},o=o.replace&&!C(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const u=/{.*}/.test(i[1])?i[1].lastIndexOf("}")+1:i[1].indexOf(this.formatSeparator);if(u!==-1&&(c=i[1].slice(u).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),i[1]=i[1].slice(0,u)),r=n(l.call(this,i[1].trim(),o),o),r&&i[0]===e&&!C(r))return r;C(r)||(r=an(r)),r||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),r=""),c.length&&(r=c.reduce((h,d)=>this.format(h,d,s.lng,{...s,interpolationkey:i[1].trim()}),r.trim())),e=e.replace(i[0],r),this.regexp.lastIndex=0}return e}}const sa=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const s=t.split("(");e=s[0].toLowerCase().trim();const i=s[1].substring(0,s[1].length-1);e==="currency"&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),h=l.trim();n[h]||(n[h]=u),u==="false"&&(n[h]=!1),u==="true"&&(n[h]=!0),isNaN(u)||(n[h]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},gn=t=>{const e={};return(n,s,i)=>{let r=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(r={...r,[i.interpolationkey]:void 0});const o=s+JSON.stringify(r);let l=e[o];return l||(l=t(He(s),i),e[o]=l),l(n)}},ia=t=>(e,n,s)=>t(He(n),s)(e);class aa{constructor(e={}){this.logger=ae.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const s=n.cacheInBuiltFormats?gn:ia;this.formats={number:s((i,r)=>{const o=new Intl.NumberFormat(i,{...r});return l=>o.format(l)}),currency:s((i,r)=>{const o=new Intl.NumberFormat(i,{...r,style:"currency"});return l=>o.format(l)}),datetime:s((i,r)=>{const o=new Intl.DateTimeFormat(i,{...r});return l=>o.format(l)}),relativetime:s((i,r)=>{const o=new Intl.RelativeTimeFormat(i,{...r});return l=>o.format(l,r.range||"day")}),list:s((i,r)=>{const o=new Intl.ListFormat(i,{...r});return l=>o.format(l)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=gn(n)}format(e,n,s,i={}){const r=n.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(l=>l.indexOf(")")>-1)){const l=r.findIndex(c=>c.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,l)].join(this.formatSeparator)}return r.reduce((l,c)=>{var d;const{formatName:u,formatOptions:h}=sa(c);if(this.formats[u]){let g=l;try{const f=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},m=f.locale||f.lng||i.locale||i.lng||s;g=this.formats[u](l,m,{...h,...i,...f})}catch(f){this.logger.warn(f)}return g}else this.logger.warn(`there was no format function for ${u}`);return l},e)}}const ra=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class oa extends bt{constructor(e,n,s,i={}){var r,o;super(),this.backend=e,this.store=n,this.services=s,this.languageUtils=s.languageUtils,this.options=i,this.logger=ae.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(r=this.backend)==null?void 0:r.init)==null||o.call(r,s,i.backend,i)}queueLoad(e,n,s,i){const r={},o={},l={},c={};return e.forEach(u=>{let h=!0;n.forEach(d=>{const g=`${u}|${d}`;!s.reload&&this.store.hasResourceBundle(u,d)?this.state[g]=2:this.state[g]<0||(this.state[g]===1?o[g]===void 0&&(o[g]=!0):(this.state[g]=1,h=!1,o[g]===void 0&&(o[g]=!0),r[g]===void 0&&(r[g]=!0),c[d]===void 0&&(c[d]=!0)))}),h||(l[u]=!0)}),(Object.keys(r).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(e,n,s){const i=e.split("|"),r=i[0],o=i[1];n&&this.emit("failedLoading",r,o,n),!n&&s&&this.store.addResourceBundle(r,o,s,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&s&&(this.state[e]=0);const l={};this.queue.forEach(c=>{Wi(c.loaded,[r],o),ra(c,e),n&&c.errors.push(n),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{l[u]||(l[u]={});const h=c.loaded[u];h.length&&h.forEach(d=>{l[u][d]===void 0&&(l[u][d]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(e,n,s,i=0,r=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:s,tried:i,wait:r,callback:o});return}this.readingCalls++;const l=(u,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&h&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,s,i+1,r*2,o)},r);return}o(u,h)},c=this.backend[s].bind(this.backend);if(c.length===2){try{const u=c(e,n);u&&typeof u.then=="function"?u.then(h=>l(null,h)).catch(l):l(null,u)}catch(u){l(u)}return}return c(e,n,l)}prepareLoading(e,n,s={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();C(e)&&(e=this.languageUtils.toResolveHierarchy(e)),C(n)&&(n=[n]);const r=this.queueLoad(e,n,s,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,s){this.prepareLoading(e,n,{},s)}reload(e,n,s){this.prepareLoading(e,n,{reload:!0},s)}loadOne(e,n=""){const s=e.split("|"),i=s[0],r=s[1];this.read(i,r,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${r} for language ${i} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${r} for language ${i}`,l),this.loaded(e,o,l)})}saveMissing(e,n,s,i,r,o={},l=()=>{}){var c,u,h,d,g;if((u=(c=this.services)==null?void 0:c.utils)!=null&&u.hasLoadedNamespace&&!((d=(h=this.services)==null?void 0:h.utils)!=null&&d.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${s}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if((g=this.backend)!=null&&g.create){const f={...o,isUpdate:r},m=this.backend.create.bind(this.backend);if(m.length<6)try{let x;m.length===5?x=m(e,n,s,i,f):x=m(e,n,s,i),x&&typeof x.then=="function"?x.then(v=>l(null,v)).catch(l):l(null,x)}catch(x){l(x)}else m(e,n,s,i,l,f)}!e||!e[0]||this.store.addResource(e[0],n,s,i)}}}const xn=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),C(t[1])&&(e.defaultValue=t[1]),C(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(s=>{e[s]=n[s]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),vn=t=>{var e,n;return C(t.ns)&&(t.ns=[t.ns]),C(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),C(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:n.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},Qe=()=>{},la=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Ae extends bt{constructor(e={},n){if(super(),this.options=vn(e),this.services={},this.logger=ae,this.modules={external:[]},la(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(C(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const s=xn();this.options={...s,...this.options,...vn(e)},this.options.interpolation={...s.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?ae.init(i(this.modules.logger),this.options):ae.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=aa;const h=new dn(this.options);this.store=new cn(this.options.resources,this.options);const d=this.services;d.logger=ae,d.resourceStore=this.store,d.languageUtils=h,d.pluralResolver=new na(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),u&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(d.formatter=i(u),d.formatter.init&&d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new mn(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new oa(i(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",(f,...m)=>{this.emit(f,...m)}),this.modules.languageDetector&&(d.languageDetector=i(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=i(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new pt(this.services,this.options),this.translator.on("*",(f,...m)=>{this.emit(f,...m)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Qe),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=(...h)=>this.store[u](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=(...h)=>(this.store[u](...h),this)});const l=Le(),c=()=>{const u=(h,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(d),n(h,d)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e,n=Qe){var r,o;let s=n;const i=C(e)?e:this.language;if(typeof e=="function"&&(s=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const l=[],c=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(d=>{d!=="cimode"&&l.indexOf(d)<0&&l.push(d)})};i?c(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(h=>c(h)),(o=(r=this.options.preload)==null?void 0:r.forEach)==null||o.call(r,u=>c(u)),this.services.backendConnector.load(l,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(u)})}else s(null)}reloadResources(e,n,s){const i=Le();return typeof e=="function"&&(s=e,e=void 0),typeof n=="function"&&(s=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),s||(s=Qe),this.services.backendConnector.reload(e,n,r=>{i.resolve(),s(r)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&vs.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const s=this.languages[n];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const s=Le();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},r=(l,c)=>{c?this.isLanguageChangingTo===e&&(i(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,s.resolve((...u)=>this.t(...u)),n&&n(l,(...u)=>this.t(...u))},o=l=>{var h,d;!e&&!l&&this.services.languageDetector&&(l=[]);const c=C(l)?l:l&&l[0],u=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(C(l)?[l]:l);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),(d=(h=this.services.languageDetector)==null?void 0:h.cacheUserLanguage)==null||d.call(h,u)),this.loadResources(u,g=>{r(g,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),s}getFixedT(e,n,s){const i=(r,o,...l)=>{let c;typeof o!="object"?c=this.options.overloadTranslationOptionHandler([r,o].concat(l)):c={...o},c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||s||i.keyPrefix);const u=this.options.keySeparator||".";let h;return c.keyPrefix&&Array.isArray(r)?h=r.map(d=>(typeof d=="function"&&(d=Mt(d,{...this.options,...o})),`${c.keyPrefix}${u}${d}`)):(typeof r=="function"&&(r=Mt(r,{...this.options,...o})),h=c.keyPrefix?`${c.keyPrefix}${u}${r}`:r),this.t(h,c)};return C(e)?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=s,i}t(...e){var n;return(n=this.translator)==null?void 0:n.translate(...e)}exists(...e){var n;return(n=this.translator)==null?void 0:n.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=n.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const u=this.services.backendConnector.state[`${l}|${c}`];return u===-1||u===0||u===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(s,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(s,e)&&(!i||o(r,e)))}loadNamespaces(e,n){const s=Le();return this.options.ns?(C(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{s.resolve(),n&&n(i)}),s):(n&&n(),Promise.resolve())}loadLanguages(e,n){const s=Le();C(e)&&(e=[e]);const i=this.options.preload||[],r=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return r.length?(this.options.preload=i.concat(r),this.loadResources(o=>{s.resolve(),n&&n(o)}),s):(n&&n(),Promise.resolve())}dir(e){var i,r;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const l=o.getTextInfo();if(l&&l.direction)return l.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=((r=this.services)==null?void 0:r.languageUtils)||new dn(xn());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(s.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const s=new Ae(e,n);return s.createInstance=Ae.createInstance,s}cloneInstance(e={},n=Qe){const s=e.forkResourceStore;s&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},r=new Ae(i);if((e.debug!==void 0||e.prefix!==void 0)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(l=>{r[l]=this[l]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},s){const l=Object.keys(this.store.data).reduce((c,u)=>(c[u]={...this.store.data[u]},c[u]=Object.keys(c[u]).reduce((h,d)=>(h[d]={...c[u][d]},h),c[u]),c),{});r.store=new cn(l,i),r.services.resourceStore=r.store}return e.interpolation&&(r.services.interpolator=new mn(i)),r.translator=new pt(r.services,i),r.translator.on("*",(l,...c)=>{r.emit(l,...c)}),r.init(i,n),r.translator.options=i,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const J=Ae.createInstance();J.createInstance;J.dir;J.init;J.loadResources;J.reloadResources;J.use;J.changeLanguage;J.getFixedT;J.t;J.exists;J.setDefaultNamespace;J.hasLoadedNamespace;J.loadNamespaces;J.loadLanguages;const ca=(t,e,n,s)=>{var r,o,l,c;const i=[n,{code:e,...s||{}}];if((o=(r=t==null?void 0:t.services)==null?void 0:r.logger)!=null&&o.forward)return t.services.logger.forward(i,"warn","react-i18next::",!0);Se(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),(c=(l=t==null?void 0:t.services)==null?void 0:l.logger)!=null&&c.warn?t.services.logger.warn(...i):console!=null&&console.warn&&console.warn(...i)},yn={},bs=(t,e,n,s)=>{Se(n)&&yn[n]||(Se(n)&&(yn[n]=new Date),ca(t,e,n,s))},ws=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},Lt=(t,e,n)=>{t.loadNamespaces(e,ws(t,n))},bn=(t,e,n,s)=>{if(Se(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return Lt(t,n,s);n.forEach(i=>{t.options.ns.indexOf(i)<0&&t.options.ns.push(i)}),t.loadLanguages(e,ws(t,s))},ua=(t,e,n={})=>!e.languages||!e.languages.length?(bs(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(s,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!i(s.isLanguageChangingTo,t))return!1}}),Se=t=>typeof t=="string",da=t=>typeof t=="object"&&t!==null,ha=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,fa={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},pa=t=>fa[t],ma=t=>t.replace(ha,pa);let It={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:ma};const ga=(t={})=>{It={...It,...t}},xa=()=>It;let Ss;const va=t=>{Ss=t},ya=()=>Ss,ba={type:"3rdParty",init(t){ga(t.options.react),va(t)}},wa=p.createContext();class Sa{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const ja=(t,e)=>Se(e)?e:da(e)&&Se(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,Ca={t:ja,ready:!1},_a=()=>()=>{},_e=(t,e={})=>{var z,T,A;const{i18n:n}=e,{i18n:s,defaultNS:i}=p.useContext(wa)||{},r=n||s||ya();r&&!r.reportNamespaces&&(r.reportNamespaces=new Sa),r||bs(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=p.useMemo(()=>{var j;return{...xa(),...(j=r==null?void 0:r.options)==null?void 0:j.react,...e}},[r,e]),{useSuspense:l,keyPrefix:c}=o,u=i||((z=r==null?void 0:r.options)==null?void 0:z.defaultNS),h=Se(u)?[u]:u||["translation"],d=p.useMemo(()=>h,h);(A=(T=r==null?void 0:r.reportNamespaces)==null?void 0:T.addUsedNamespaces)==null||A.call(T,d);const g=p.useRef(0),f=p.useCallback(j=>{if(!r)return _a;const{bindI18n:N,bindI18nStore:k}=o,I=()=>{g.current+=1,j()};return N&&r.on(N,I),k&&r.store.on(k,I),()=>{N&&N.split(" ").forEach(F=>r.off(F,I)),k&&k.split(" ").forEach(F=>r.store.off(F,I))}},[r,o]),m=p.useRef(),x=p.useCallback(()=>{if(!r)return Ca;const j=!!(r.isInitialized||r.initializedStoreOnce)&&d.every(b=>ua(b,r,o)),N=e.lng||r.language,k=g.current,I=m.current;if(I&&I.ready===j&&I.lng===N&&I.keyPrefix===c&&I.revision===k)return I;const G={t:r.getFixedT(N,o.nsMode==="fallback"?d:d[0],c),ready:j,lng:N,keyPrefix:c,revision:k};return m.current=G,G},[r,d,c,o,e.lng]),[v,y]=p.useState(0),{t:w,ready:S}=Hs.useSyncExternalStore(f,x,x);p.useEffect(()=>{if(r&&!S&&!l){const j=()=>y(N=>N+1);e.lng?bn(r,e.lng,d,j):Lt(r,d,j)}},[r,e.lng,d,S,l,v]);const _=r||{},L=p.useRef(null),H=p.useRef(),D=j=>{const N=Object.getOwnPropertyDescriptors(j);N.__original&&delete N.__original;const k=Object.create(Object.getPrototypeOf(j),N);if(!Object.prototype.hasOwnProperty.call(k,"__original"))try{Object.defineProperty(k,"__original",{value:j,writable:!1,enumerable:!1,configurable:!1})}catch{}return k},$=p.useMemo(()=>{const j=_,N=j==null?void 0:j.language;let k=j;j&&(L.current&&L.current.__original===j?H.current!==N?(k=D(j),L.current=k,H.current=N):k=L.current:(k=D(j),L.current=k,H.current=N));const I=[w,k,S];return I.t=w,I.i18n=k,I.ready=S,I},[w,_,S,_.resolvedLanguage,_.language,_.languages]);if(r&&l&&!S)throw new Promise(j=>{const N=()=>j();e.lng?bn(r,e.lng,d,N):Lt(r,d,N)});return $},Nt=[{code:"zh",name:"中文",dir:"ltr"},{code:"en",name:"English",dir:"ltr"}],wn=()=>{const{i18n:t}=_e(),[e,n]=te.useState(!1);p.useEffect(()=>{const i=Nt.find(r=>r.code===t.language)||Nt[0];document.body.dir=i.dir,document.documentElement.lang=i.code},[t.language]);const s=i=>{t.changeLanguage(i),n(!1)};return a.jsxs("div",{className:"relative z-50",children:[a.jsxs("button",{onClick:()=>n(!e),className:"flex items-center gap-2 text-gray-300 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:[a.jsx(ci,{className:"w-5 h-5"}),a.jsx("span",{className:"uppercase font-medium text-sm",children:t.language.split("-")[0]})]}),a.jsx(re,{children:e&&a.jsx(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute right-0 mt-2 w-40 bg-neutral-900 border border-white/10 rounded-lg shadow-xl overflow-hidden",children:Nt.map(i=>a.jsxs("button",{onClick:()=>s(i.code),className:`w-full text-left px-4 py-3 text-sm hover:bg-white/10 transition-colors flex items-center justify-between
                  ${t.language===i.code?"text-white bg-white/5 font-bold":"text-gray-400"}`,children:[i.name,t.language===i.code&&a.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})]},i.code))})})]})},$e=(t,e)=>{const n=p.useRef(!1),s=p.useRef(`modal-${Math.random().toString(36).substr(2,9)}`),i=p.useRef(e);return p.useEffect(()=>{i.current=e},[e]),p.useEffect(()=>{if(t){n.current=!1;const r=`#${s.current}`;window.location.hash!==r&&window.history.pushState({modalOpen:!0,id:s.current},"",r);const o=()=>{window.location.hash!==r&&(n.current=!0,i.current&&i.current())};return window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o),!n.current&&window.location.hash===r&&window.history.back()}}},[t]),{onNavigate:()=>{}}},js=({isOpen:t,onClose:e})=>{const{t:n}=_e();$e(t,e);const[s,i]=p.useState(!0),[r,o]=p.useState(""),[l,c]=p.useState(""),[u,h]=p.useState(!1),{login:d,register:g}=Ke(),f=async m=>{if(m.preventDefault(),!r||!l)return;h(!0);const x=s?await d(r,l):await g(r,l);h(!1),x&&(e(),o(""),c(""))};return t?Bt.createPortal(a.jsx(re,{children:a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(U.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md bg-[#1a1a1a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden p-8 z-10",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 opacity-50 pointer-events-none"}),a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20",children:a.jsx(de,{size:20})}),a.jsxs("div",{className:"text-center mb-8 relative z-10",children:[a.jsx("h2",{className:"text-3xl font-bold text-white mb-2 tracking-tight",children:n(s?"auth.welcome_back":"auth.join_lumos")}),a.jsx("p",{className:"text-gray-400 text-sm",children:n(s?"auth.signin_desc":"auth.signup_desc")})]}),a.jsxs("form",{onSubmit:f,className:"space-y-5 relative z-10",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-indigo-400 uppercase mb-2 tracking-wider",children:n("auth.username")}),a.jsxs("div",{className:"relative group",children:[a.jsx(qn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 group-focus-within:text-indigo-400 transition-colors",size:18}),a.jsx("input",{type:"text",value:r,onChange:m=>o(m.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/60",placeholder:n("auth.enter_username")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-indigo-400 uppercase mb-2 tracking-wider",children:n("auth.password")}),a.jsxs("div",{className:"relative group",children:[a.jsx(Xn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 group-focus-within:text-indigo-400 transition-colors",size:18}),a.jsx("input",{type:"password",value:l,onChange:m=>c(m.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/60",placeholder:n("auth.enter_password")})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3.5 rounded-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed mt-8 shadow-lg shadow-indigo-500/25 active:scale-[0.98]",children:u?a.jsx(Zn,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:[n(s?"auth.sign_in":"auth.create_account"),a.jsx(Jn,{size:18})]})})]}),a.jsxs("div",{className:"mt-8 text-center text-sm text-gray-400 relative z-10",children:[n(s?"auth.no_account":"auth.has_account"),a.jsx("button",{onClick:()=>i(!s),className:"text-white hover:text-indigo-400 font-bold ml-1 transition-colors underline decoration-indigo-500/50 hover:decoration-indigo-500",children:n(s?"auth.sign_up":"auth.log_in")})]})]})]})}),document.body):null},Ea=[{id:"space",labelKey:"themes.space.name",descKey:"themes.space.desc",icon:Yn,color:"text-purple-400",bg:"bg-purple-500/20"},{id:"grid",labelKey:"themes.grid.name",descKey:"themes.grid.desc",icon:Qn,color:"text-pink-400",bg:"bg-pink-500/20"},{id:"embers",labelKey:"themes.embers.name",descKey:"themes.embers.desc",icon:es,color:"text-orange-400",bg:"bg-orange-500/20"},{id:"crystal",labelKey:"themes.crystal.name",descKey:"themes.crystal.desc",icon:ts,color:"text-cyan-400",bg:"bg-cyan-500/20"},{id:"clouds",labelKey:"themes.clouds.name",descKey:"themes.clouds.desc",icon:ns,color:"text-sky-300",bg:"bg-sky-500/20"},{id:"cyber",labelKey:"themes.cyber.name",descKey:"themes.cyber.desc",icon:ss,color:"text-cyan-500",bg:"bg-cyan-500/20"},{id:"dna",labelKey:"themes.dna.name",descKey:"themes.dna.desc",icon:is,color:"text-green-500",bg:"bg-green-500/20"},{id:"binary",labelKey:"themes.binary.name",descKey:"themes.binary.desc",icon:as,color:"text-green-300",bg:"bg-green-500/20"},{id:"network",labelKey:"themes.network.name",descKey:"themes.network.desc",icon:rs,color:"text-blue-500",bg:"bg-blue-500/20"},{id:"wave",labelKey:"themes.wave.name",descKey:"themes.wave.desc",icon:os,color:"text-pink-500",bg:"bg-pink-500/20"},{id:"orbit",labelKey:"themes.orbit.name",descKey:"themes.orbit.desc",icon:ls,color:"text-rose-400",bg:"bg-rose-500/20"}],Sn=({value:t,onChange:e,options:n,placeholder:s="Select...",icon:i,className:r="",buttonClassName:o="",menuClassName:l=""})=>{const[c,u]=p.useState(!1),h=p.useRef(null);p.useEffect(()=>{const g=f=>{h.current&&!h.current.contains(f.target)&&u(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const d=n.find(g=>g.value===t);return a.jsxs("div",{className:`relative ${r}`,ref:h,style:{zIndex:c?50:1},children:[a.jsxs("button",{type:"button",onClick:()=>u(!c),className:`flex items-center justify-between gap-2 w-full bg-black/20 border border-white/10 rounded-xl px-4 py-2.5 text-white focus:outline-none focus:border-indigo-500/50 transition-all hover:bg-white/5 ${o}`,children:[a.jsxs("div",{className:"flex items-center gap-2 truncate",children:[i&&a.jsx(i,{size:16,className:"text-gray-400"}),a.jsx("span",{className:d?"text-white":"text-gray-400",children:d?d.label:s})]}),a.jsx(ui,{size:16,className:`text-gray-400 transition-transform duration-300 ${c?"rotate-180":""}`})]}),a.jsx(re,{children:c&&a.jsx(U.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:`absolute top-full right-0 mt-2 w-full min-w-[160px] bg-[#1a1a1a] border border-white/10 rounded-xl shadow-2xl overflow-hidden z-[100] ${l}`,children:a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-1",children:n.map(g=>a.jsxs("button",{type:"button",onClick:()=>{e(g.value),u(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 text-sm rounded-lg transition-colors mb-0.5 last:mb-0 ${t===g.value?"bg-indigo-600 text-white":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:[a.jsx("span",{className:"truncate",children:g.label}),t===g.value&&a.jsx(di,{size:14})]},g.value))})})})]})},Na=({itemId:t,itemType:e,initialFavorited:n=!1,favorited:s,className:i="",size:r=20,showCount:o=!1,count:l=0,onToggle:c})=>{const[u,h]=p.useState(n),[d,g]=p.useState(!1),[f,m]=p.useState(typeof l=="number"?l:0),{user:x}=Ke();p.useEffect(()=>{s!==void 0&&h(s)},[s]),p.useEffect(()=>{m(typeof l=="number"?l:0)},[l]),p.useEffect(()=>{let y=!0;return x?(async()=>{if(!(!x||!t||!e))try{const S=await B.get(`/favorites/check?itemId=${t}&itemType=${e}`);y&&h(S.data.favorited)}catch(S){console.error("Failed to check favorite status",S)}})():h(!1),()=>{y=!1}},[t,e,x]);const v=async y=>{if(y.preventDefault(),y.stopPropagation(),!x){W.error("请先登录以收藏");return}if(d)return;const w=u,S=f;h(!w),m(w?Math.max(0,S-1):S+1),g(!0);try{const _=await B.post("/favorites/toggle",{itemId:t,itemType:e});h(_.data.favorited),typeof _.data.likes=="number"&&m(_.data.likes),_.data.favorited,c&&c(_.data.favorited,_.data.likes)}catch(_){h(w),m(S),W.error("操作失败，请重试"),console.error(_)}finally{g(!1)}};return a.jsxs(U.button,{whileTap:{scale:.8},onClick:v,className:`relative flex items-center justify-center transition-colors ${i} ${u?"text-red-500":"text-gray-400 hover:text-red-400"}`,disabled:d,children:[a.jsx(re,{mode:"wait",children:u?a.jsx(U.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{type:"spring",stiffness:300,damping:20},children:a.jsx(ot,{size:r,fill:"currentColor"})},"filled"):a.jsx(U.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:a.jsx(ot,{size:r})},"outline")}),o&&f>0&&a.jsx("span",{className:"ml-1 text-[10px]",children:f})]})},Ta=({isOpen:t,onClose:e})=>{var Wt;const{t:n}=_e(),{user:s,logout:i,updateProfile:r}=Ke(),{settings:o}=yt(),[l,c]=p.useState("profile"),[u,h]=p.useState(!1);$e(t,e);const[d,g]=p.useState([]),[f,m]=p.useState([]),[x,v]=p.useState(!1),[y,w]=p.useState(!1),[S,_]=p.useState("photos"),[L,H]=p.useState("photo"),[D,$]=p.useState({organization:"",inviteCode:""}),[z,T]=p.useState(!1),[A,j]=p.useState(!1),[N,k]=p.useState(""),[I,F]=p.useState(""),[G,b]=p.useState(""),[K,V]=p.useState(!1);p.useEffect(()=>{t&&s&&($({organization:s.organization||"",inviteCode:""}),j(!!s.organization)),t&&l==="uploads"&&s&&O(),t&&l==="favorites"&&s&&Q()},[t,l,S,L,s]);const O=async()=>{v(!0);try{const E=await B.get(`/${S}?uploader_id=${s.id}&status=all&limit=50`);g(E.data.data||[])}catch(E){console.error(E),W.error(n("common.error_fetching_data"))}finally{v(!1)}},Q=async()=>{w(!0);try{const E=await B.get(`/favorites?type=${L}`);m(E.data||[])}catch{}finally{w(!1)}},le=()=>{i(),e(),W.success(n("user_profile.logout"))},ge=te.useRef(!1),Ee=async E=>{var xe,ve;if(E.preventDefault(),!ge.current){ge.current=!0,T(!0);try{const ye={organization_cr:D.organization,invitation_code:D.inviteCode};await B.put("/auth/profile",ye),W.success(n("user_profile.profile_updated")),await refreshUser()}catch(ye){W.error(((ve=(xe=ye.response)==null?void 0:xe.data)==null?void 0:ve.error)||n("admin.toast.update_fail"))}finally{T(!1),ge.current=!1}}},ee=()=>{if(!D.inviteCode){W.error(n("user_profile.invite_code_required"));return}D.inviteCode===o.invite_code?(j(!0),W.success(n("user_profile.invite_code_verified"))):(W.error(n("user_profile.invite_code_invalid")),j(!1))},qe=async E=>{var xe,ve;if(E.preventDefault(),I!==G){W.error(n("user_profile.security.password_mismatch"));return}V(!0);try{await B.put("/auth/password",{currentPassword:N,newPassword:I}),W.success(n("user_profile.security.update_success")),k(""),F(""),b("")}catch(ye){W.error(((ve=(xe=ye.response)==null?void 0:xe.data)==null?void 0:ve.message)||n("user_profile.security.update_fail"))}finally{V(!1)}};if(!t||!s)return null;const Xe=[{value:"photos",label:n("nav.gallery"),icon:lt},{value:"music",label:n("nav.music"),icon:Be},{value:"videos",label:n("nav.videos"),icon:ct},{value:"articles",label:n("nav.articles"),icon:ut},{value:"events",label:n("nav.events"),icon:dt}],ie=[{value:"photo",label:n("nav.gallery"),icon:lt},{value:"music",label:n("nav.music"),icon:Be},{value:"video",label:n("nav.videos"),icon:ct},{value:"article",label:n("nav.articles"),icon:ut},{value:"event",label:n("nav.events"),icon:dt}];return Bt.createPortal(a.jsx(re,{children:a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(U.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-4xl bg-[#1a1a1a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col md:flex-row h-[85vh] md:h-[600px] z-10",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-purple-500/5 opacity-50 pointer-events-none"}),a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20 md:hidden",children:a.jsx(de,{size:20})}),a.jsxs("div",{className:"w-full md:w-64 bg-black/20 border-b md:border-b-0 md:border-r border-white/10 p-4 md:p-6 flex flex-col relative z-10 shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4 md:mb-8",children:[a.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg md:text-xl shrink-0",children:(Wt=s==null?void 0:s.username)==null?void 0:Wt.charAt(0).toUpperCase()}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("h3",{className:"text-white font-bold truncate text-sm md:text-base",children:s==null?void 0:s.username}),a.jsx("p",{className:"text-xs text-gray-400 truncate",children:s==null?void 0:s.email})]})]}),a.jsxs("nav",{className:"grid grid-cols-2 gap-2 md:flex md:flex-col md:space-y-2 flex-1 mb-4 md:mb-0",children:[a.jsxs("button",{onClick:()=>c("profile"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${l==="profile"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(qn,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",n("user_profile.tabs.profile")]}),a.jsxs("button",{onClick:()=>c("uploads"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${l==="uploads"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(Yt,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",n("user_profile.tabs.uploads")]}),a.jsxs("button",{onClick:()=>c("favorites"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${l==="favorites"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(ot,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",n("user_profile.tabs.favorites")]}),a.jsxs("button",{onClick:()=>c("security"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${l==="security"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(Xn,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",n("user_profile.tabs.security")]})]}),a.jsxs("button",{onClick:le,className:"mt-auto w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 text-red-400 hover:bg-red-500/10 transition-colors text-sm md:text-base",children:[a.jsx(cs,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",n("user_profile.logout")]})]}),a.jsx("div",{className:"flex-1 p-6 md:p-8 overflow-y-auto custom-scrollbar relative z-10 bg-[#1a1a1a]",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[l==="profile"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:n("user_profile.tabs.profile")}),a.jsxs("form",{onSubmit:Ee,className:"space-y-4",children:[a.jsxs("div",{className:"pt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:n("user_profile.fields.organization")}),!A&&a.jsxs("div",{className:"mb-4 space-y-2",children:[a.jsx("label",{className:"text-xs text-gray-500",children:n("user_profile.fields.invite_code_label")}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:D.inviteCode,onChange:E=>$({...D,inviteCode:E.target.value}),placeholder:n("user_profile.fields.invite_code_hint"),className:"flex-1 bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"}),a.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-bold transition-colors",children:n("common.verify")})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",value:D.organization,onChange:E=>$({...D,organization:E.target.value}),placeholder:n("user_profile.fields.org_placeholder"),disabled:!A,className:`w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500 ${A?"":"opacity-50 cursor-not-allowed"}`}),a.jsx("p",{className:"text-xs text-gray-500",children:n("user_profile.fields.org_help")})]})]}),A&&a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:z,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold transition-colors disabled:opacity-50",children:n(z?"common.saving":"common.save")})})]}),a.jsx("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/10 mt-8",children:a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:n("user_profile.profile.username")}),a.jsx("p",{className:"font-bold text-white text-lg",children:s==null?void 0:s.username})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:n("user_profile.profile.role")}),a.jsx("p",{className:"font-bold text-white text-lg uppercase",children:n(`user_profile.roles.${s==null?void 0:s.role}`)||(s==null?void 0:s.role)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:n("user_profile.profile.joined")}),a.jsx("p",{className:"font-bold text-white",children:new Date((s==null?void 0:s.created_at)||Date.now()).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:n("user_profile.profile.id")}),a.jsxs("p",{className:"font-bold text-white font-mono",children:["#",s==null?void 0:s.id]})]})]})})]}),l==="uploads"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:n("user_profile.uploads.title")}),a.jsx("div",{className:"w-40",children:a.jsx(Sn,{value:S,onChange:_,options:Xe,buttonClassName:"bg-black/40 border-white/10 w-full"})})]}),x?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):d.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500 bg-black/20 rounded-xl border border-white/5 border-dashed",children:[a.jsx(Yt,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:n("user_profile.uploads.no_uploads")})]}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:d.map(E=>a.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-black/50 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:E.cover||E.thumbnail||E.url||E.image,alt:E.title,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-white truncate",children:E.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:new Date(E.created_at||Date.now()).toLocaleDateString()})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${E.status==="approved"?"bg-green-500/20 text-green-400":E.status==="rejected"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:n(`user_profile.uploads.status.${E.status}`)||E.status})})]},E.id))})]}),l==="favorites"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:n("user_profile.favorites.title")}),a.jsx("div",{className:"w-40",children:a.jsx(Sn,{value:L,onChange:H,options:ie,buttonClassName:"bg-black/40 border-white/10 w-full"})})]}),y?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):f.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500 bg-black/20 rounded-xl border border-white/5 border-dashed",children:[a.jsx(ot,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:n("user_profile.favorites.no_favorites")})]}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:f.map(E=>a.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-black/50 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:E.cover||E.thumbnail||E.url||E.image,alt:E.title,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-white truncate",children:E.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:E.artist||E.category})]}),a.jsx(Na,{itemId:E.id,itemType:L,initialFavorited:!0,size:18,showCount:!1,className:"p-2 hover:bg-white/10 rounded-full transition-colors",onToggle:xe=>{xe||m(ve=>ve.filter(ye=>ye.id!==E.id))}})]},E.id))})]}),l==="security"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:n("user_profile.security.title")}),a.jsxs("form",{onSubmit:qe,className:"bg-white/5 rounded-2xl p-6 border border-white/10 space-y-4",children:[a.jsx("h4",{className:"text-lg font-bold text-white mb-4",children:n("user_profile.security.change_password")}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:n("user_profile.security.current_password")}),a.jsx("input",{type:"password",value:N,onChange:E=>k(E.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:n("user_profile.security.new_password")}),a.jsx("input",{type:"password",value:I,onChange:E=>F(E.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:n("user_profile.security.confirm_password")}),a.jsx("input",{type:"password",value:G,onChange:E=>b(E.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:K,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50",children:n(K?"user_profile.security.updating":"user_profile.security.update_btn")})]})]})]})})]})]})}),document.body)},jn=[{id:"bj",name:"北京",name_en:"Beijing",lat:39.9042,lon:116.4074,country:"China",admin1:"Beijing"},{id:"sh",name:"上海",name_en:"Shanghai",lat:31.2304,lon:121.4737,country:"China",admin1:"Shanghai"},{id:"tj",name:"天津",name_en:"Tianjin",lat:39.0842,lon:117.2008,country:"China",admin1:"Tianjin"},{id:"cq",name:"重庆",name_en:"Chongqing",lat:29.563,lon:106.5516,country:"China",admin1:"Chongqing"},{id:"hz",name:"杭州",name_en:"Hangzhou",lat:30.2741,lon:120.1551,country:"China",admin1:"Zhejiang"},{id:"nb",name:"宁波",name_en:"Ningbo",lat:29.8683,lon:121.544,country:"China",admin1:"Zhejiang"},{id:"wz",name:"温州",name_en:"Wenzhou",lat:27.9943,lon:120.6994,country:"China",admin1:"Zhejiang"},{id:"jx",name:"嘉兴",name_en:"Jiaxing",lat:30.7539,lon:120.7525,country:"China",admin1:"Zhejiang"},{id:"huz",name:"湖州",name_en:"Huzhou",lat:30.8943,lon:120.0868,country:"China",admin1:"Zhejiang"},{id:"sx",name:"绍兴",name_en:"Shaoxing",lat:30.0016,lon:120.5753,country:"China",admin1:"Zhejiang"},{id:"jh",name:"金华",name_en:"Jinhua",lat:29.1054,lon:119.6495,country:"China",admin1:"Zhejiang"},{id:"qz",name:"衢州",name_en:"Quzhou",lat:28.9355,lon:118.8758,country:"China",admin1:"Zhejiang"},{id:"zs",name:"舟山",name_en:"Zhoushan",lat:29.9855,lon:122.2066,country:"China",admin1:"Zhejiang"},{id:"tz_zj",name:"台州",name_en:"Taizhou",lat:28.6564,lon:121.4208,country:"China",admin1:"Zhejiang"},{id:"ls",name:"丽水",name_en:"Lishui",lat:28.4677,lon:119.9218,country:"China",admin1:"Zhejiang"},{id:"nj",name:"南京",name_en:"Nanjing",lat:32.0603,lon:118.7969,country:"China",admin1:"Jiangsu"},{id:"wx",name:"无锡",name_en:"Wuxi",lat:31.4912,lon:120.3119,country:"China",admin1:"Jiangsu"},{id:"xz",name:"徐州",name_en:"Xuzhou",lat:34.2044,lon:117.2837,country:"China",admin1:"Jiangsu"},{id:"cz",name:"常州",name_en:"Changzhou",lat:31.8127,lon:119.9741,country:"China",admin1:"Jiangsu"},{id:"su",name:"苏州",name_en:"Suzhou",lat:31.2989,lon:120.5853,country:"China",admin1:"Jiangsu"},{id:"nt",name:"南通",name_en:"Nantong",lat:31.9802,lon:120.8943,country:"China",admin1:"Jiangsu"},{id:"lyg",name:"连云港",name_en:"Lianyungang",lat:34.5967,lon:119.2216,country:"China",admin1:"Jiangsu"},{id:"ha",name:"淮安",name_en:"Huai'an",lat:33.589,lon:119.1438,country:"China",admin1:"Jiangsu"},{id:"yc",name:"盐城",name_en:"Yancheng",lat:33.3473,lon:120.1636,country:"China",admin1:"Jiangsu"},{id:"yz",name:"扬州",name_en:"Yangzhou",lat:32.3942,lon:119.4129,country:"China",admin1:"Jiangsu"},{id:"zj",name:"镇江",name_en:"Zhenjiang",lat:32.2109,lon:119.4613,country:"China",admin1:"Jiangsu"},{id:"tz_js",name:"泰州",name_en:"Taizhou",lat:32.4555,lon:119.9229,country:"China",admin1:"Jiangsu"},{id:"sq",name:"宿迁",name_en:"Suqian",lat:33.963,lon:118.2753,country:"China",admin1:"Jiangsu"},{id:"gz",name:"广州",name_en:"Guangzhou",lat:23.1291,lon:113.2644,country:"China",admin1:"Guangdong"},{id:"sz",name:"深圳",name_en:"Shenzhen",lat:22.5431,lon:114.0579,country:"China",admin1:"Guangdong"},{id:"zh",name:"珠海",name_en:"Zhuhai",lat:22.2707,lon:113.5767,country:"China",admin1:"Guangdong"},{id:"st",name:"汕头",name_en:"Shantou",lat:23.3517,lon:116.6636,country:"China",admin1:"Guangdong"},{id:"fs",name:"佛山",name_en:"Foshan",lat:23.0215,lon:113.1214,country:"China",admin1:"Guangdong"},{id:"sg",name:"韶关",name_en:"Shaoguan",lat:24.8104,lon:113.5975,country:"China",admin1:"Guangdong"},{id:"zj_gd",name:"湛江",name_en:"Zhanjiang",lat:21.1968,lon:110.4032,country:"China",admin1:"Guangdong"},{id:"zq",name:"肇庆",name_en:"Zhaoqing",lat:23.0511,lon:112.4674,country:"China",admin1:"Guangdong"},{id:"jm",name:"江门",name_en:"Jiangmen",lat:22.5787,lon:113.0816,country:"China",admin1:"Guangdong"},{id:"mm",name:"茂名",name_en:"Maoming",lat:21.662,lon:110.9254,country:"China",admin1:"Guangdong"},{id:"hz_gd",name:"惠州",name_en:"Huizhou",lat:23.1118,lon:114.4156,country:"China",admin1:"Guangdong"},{id:"mz",name:"梅州",name_en:"Meizhou",lat:24.2886,lon:116.1225,country:"China",admin1:"Guangdong"},{id:"sw",name:"汕尾",name_en:"Shanwei",lat:22.7876,lon:115.3752,country:"China",admin1:"Guangdong"},{id:"hy",name:"河源",name_en:"Heyuan",lat:23.7431,lon:114.7006,country:"China",admin1:"Guangdong"},{id:"yj",name:"阳江",name_en:"Yangjiang",lat:21.8572,lon:111.9822,country:"China",admin1:"Guangdong"},{id:"qy",name:"清远",name_en:"Qingyuan",lat:23.682,lon:113.0561,country:"China",admin1:"Guangdong"},{id:"dg",name:"东莞",name_en:"Dongguan",lat:23.0208,lon:113.7518,country:"China",admin1:"Guangdong"},{id:"zs_gd",name:"中山",name_en:"Zhongshan",lat:22.5167,lon:113.3928,country:"China",admin1:"Guangdong"},{id:"cz_gd",name:"潮州",name_en:"Chaozhou",lat:23.6669,lon:116.629,country:"China",admin1:"Guangdong"},{id:"jy",name:"揭阳",name_en:"Jieyang",lat:23.5417,lon:116.3668,country:"China",admin1:"Guangdong"},{id:"yf",name:"云浮",name_en:"Yunfu",lat:22.915,lon:112.0445,country:"China",admin1:"Guangdong"},{id:"cd",name:"成都",name_en:"Chengdu",lat:30.5728,lon:104.0668,country:"China",admin1:"Sichuan"},{id:"zg",name:"自贡",name_en:"Zigong",lat:29.3527,lon:104.7784,country:"China",admin1:"Sichuan"},{id:"pzh",name:"攀枝花",name_en:"Panzhihua",lat:26.5823,lon:101.7186,country:"China",admin1:"Sichuan"},{id:"lz_sc",name:"泸州",name_en:"Luzhou",lat:28.8724,lon:105.4405,country:"China",admin1:"Sichuan"},{id:"dy",name:"德阳",name_en:"Deyang",lat:31.1271,lon:104.3978,country:"China",admin1:"Sichuan"},{id:"my",name:"绵阳",name_en:"Mianyang",lat:31.4674,lon:104.6791,country:"China",admin1:"Sichuan"},{id:"gy",name:"广元",name_en:"Guangyuan",lat:32.4412,lon:105.8434,country:"China",admin1:"Sichuan"},{id:"sn",name:"遂宁",name_en:"Suining",lat:30.5328,lon:105.5929,country:"China",admin1:"Sichuan"},{id:"nj_sc",name:"内江",name_en:"Neijiang",lat:29.587,lon:105.0584,country:"China",admin1:"Sichuan"},{id:"ls_sc",name:"乐山",name_en:"Leshan",lat:29.5605,lon:103.7657,country:"China",admin1:"Sichuan"},{id:"nc_sc",name:"南充",name_en:"Nanchong",lat:30.7991,lon:106.0823,country:"China",admin1:"Sichuan"},{id:"ms",name:"眉山",name_en:"Meishan",lat:30.0483,lon:103.8318,country:"China",admin1:"Sichuan"},{id:"yb",name:"宜宾",name_en:"Yibin",lat:28.7518,lon:104.6419,country:"China",admin1:"Sichuan"},{id:"ga",name:"广安",name_en:"Guang'an",lat:30.4561,lon:106.6334,country:"China",admin1:"Sichuan"},{id:"dz",name:"达州",name_en:"Dazhou",lat:31.2096,lon:107.5023,country:"China",admin1:"Sichuan"},{id:"ya",name:"雅安",name_en:"Ya'an",lat:29.9803,lon:103.001,country:"China",admin1:"Sichuan"},{id:"bz",name:"巴中",name_en:"Bazhong",lat:31.8588,lon:106.7537,country:"China",admin1:"Sichuan"},{id:"zy",name:"资阳",name_en:"Ziyang",lat:30.1289,lon:104.6276,country:"China",admin1:"Sichuan"},{id:"fz",name:"福州",name_en:"Fuzhou",lat:26.0745,lon:119.2965,country:"China",admin1:"Fujian"},{id:"xm",name:"厦门",name_en:"Xiamen",lat:24.4798,lon:118.0894,country:"China",admin1:"Fujian"},{id:"pt",name:"莆田",name_en:"Putian",lat:25.431,lon:119.0076,country:"China",admin1:"Fujian"},{id:"sm",name:"三明",name_en:"Sanming",lat:26.2634,lon:117.6386,country:"China",admin1:"Fujian"},{id:"qz_fj",name:"泉州",name_en:"Quanzhou",lat:24.9147,lon:118.5868,country:"China",admin1:"Fujian"},{id:"zz_fj",name:"漳州",name_en:"Zhangzhou",lat:24.5126,lon:117.6475,country:"China",admin1:"Fujian"},{id:"np",name:"南平",name_en:"Nanping",lat:26.6436,lon:118.1784,country:"China",admin1:"Fujian"},{id:"ly",name:"龙岩",name_en:"Longyan",lat:25.0787,lon:117.0173,country:"China",admin1:"Fujian"},{id:"nd",name:"宁德",name_en:"Ningde",lat:26.6656,lon:119.527,country:"China",admin1:"Fujian"},{id:"jn",name:"济南",name_en:"Jinan",lat:36.6512,lon:117.1201,country:"China",admin1:"Shandong"},{id:"qd",name:"青岛",name_en:"Qingdao",lat:36.0671,lon:120.3826,country:"China",admin1:"Shandong"},{id:"zb",name:"淄博",name_en:"Zibo",lat:36.8133,lon:118.055,country:"China",admin1:"Shandong"},{id:"zz_sd",name:"枣庄",name_en:"Zaozhuang",lat:34.8693,lon:117.5537,country:"China",admin1:"Shandong"},{id:"dy_sd",name:"东营",name_en:"Dongying",lat:37.4348,lon:118.6741,country:"China",admin1:"Shandong"},{id:"yt",name:"烟台",name_en:"Yantai",lat:37.5398,lon:121.3914,country:"China",admin1:"Shandong"},{id:"wf",name:"潍坊",name_en:"Weifang",lat:36.7072,lon:119.1617,country:"China",admin1:"Shandong"},{id:"jn_sd",name:"济宁",name_en:"Jining",lat:35.415,lon:116.5872,country:"China",admin1:"Shandong"},{id:"ta",name:"泰安",name_en:"Tai'an",lat:36.2001,lon:117.0877,country:"China",admin1:"Shandong"},{id:"wh_sd",name:"威海",name_en:"Weihai",lat:37.513,lon:122.1204,country:"China",admin1:"Shandong"},{id:"rz",name:"日照",name_en:"Rizhao",lat:35.4164,lon:119.527,country:"China",admin1:"Shandong"},{id:"lw",name:"莱芜",name_en:"Laiwu",lat:36.2136,lon:117.6767,country:"China",admin1:"Shandong"},{id:"ly_sd",name:"临沂",name_en:"Linyi",lat:35.0606,lon:118.3523,country:"China",admin1:"Shandong"},{id:"dz_sd",name:"德州",name_en:"Dezhou",lat:37.4354,lon:116.3574,country:"China",admin1:"Shandong"},{id:"lc",name:"聊城",name_en:"Liaocheng",lat:36.456,lon:115.9855,country:"China",admin1:"Shandong"},{id:"bz_sd",name:"滨州",name_en:"Binzhou",lat:37.382,lon:117.9701,country:"China",admin1:"Shandong"},{id:"hz_sd",name:"菏泽",name_en:"Heze",lat:35.2437,lon:115.4806,country:"China",admin1:"Shandong"},{id:"wh",name:"武汉",name_en:"Wuhan",lat:30.5928,lon:114.3055,country:"China",admin1:"Hubei"},{id:"hs",name:"黄石",name_en:"Huangshi",lat:30.2261,lon:115.0413,country:"China",admin1:"Hubei"},{id:"sy_hb",name:"十堰",name_en:"Shiyan",lat:32.6475,lon:110.7993,country:"China",admin1:"Hubei"},{id:"yc_hb",name:"宜昌",name_en:"Yichang",lat:30.692,lon:111.2865,country:"China",admin1:"Hubei"},{id:"xy",name:"襄阳",name_en:"Xiangyang",lat:32.0082,lon:112.1224,country:"China",admin1:"Hubei"},{id:"ez",name:"鄂州",name_en:"Ezhou",lat:30.3939,lon:114.8906,country:"China",admin1:"Hubei"},{id:"jm_hb",name:"荆门",name_en:"Jingmen",lat:31.0354,lon:112.1999,country:"China",admin1:"Hubei"},{id:"xg",name:"孝感",name_en:"Xiaogan",lat:30.9168,lon:113.9556,country:"China",admin1:"Hubei"},{id:"jz",name:"荆州",name_en:"Jingzhou",lat:30.3342,lon:112.2393,country:"China",admin1:"Hubei"},{id:"hg",name:"黄冈",name_en:"Huanggang",lat:30.4539,lon:114.8726,country:"China",admin1:"Hubei"},{id:"xn",name:"咸宁",name_en:"Xianning",lat:29.8414,lon:114.3225,country:"China",admin1:"Hubei"},{id:"sz_hb",name:"随州",name_en:"Suizhou",lat:31.7175,lon:113.3826,country:"China",admin1:"Hubei"},{id:"es",name:"恩施",name_en:"Enshi",lat:30.295,lon:109.4792,country:"China",admin1:"Hubei"},{id:"cs",name:"长沙",name_en:"Changsha",lat:28.2282,lon:112.9388,country:"China",admin1:"Hunan"},{id:"zz_hn",name:"株洲",name_en:"Zhuzhou",lat:27.8307,lon:113.1348,country:"China",admin1:"Hunan"},{id:"xt",name:"湘潭",name_en:"Xiangtan",lat:27.8297,lon:112.944,country:"China",admin1:"Hunan"},{id:"hy_hn",name:"衡阳",name_en:"Hengyang",lat:26.8968,lon:112.5721,country:"China",admin1:"Hunan"},{id:"sy_hn",name:"邵阳",name_en:"Shaoyang",lat:27.2389,lon:111.4693,country:"China",admin1:"Hunan"},{id:"yy",name:"岳阳",name_en:"Yueyang",lat:29.3567,lon:113.129,country:"China",admin1:"Hunan"},{id:"cd_hn",name:"常德",name_en:"Changde",lat:29.0317,lon:111.6985,country:"China",admin1:"Hunan"},{id:"zjj",name:"张家界",name_en:"Zhangjiajie",lat:29.117,lon:110.4792,country:"China",admin1:"Hunan"},{id:"iy",name:"益阳",name_en:"Yiyang",lat:28.588,lon:112.355,country:"China",admin1:"Hunan"},{id:"cz_hn",name:"郴州",name_en:"Chenzhou",lat:25.7705,lon:113.0145,country:"China",admin1:"Hunan"},{id:"yz_hn",name:"永州",name_en:"Yongzhou",lat:26.4204,lon:111.6134,country:"China",admin1:"Hunan"},{id:"hh",name:"怀化",name_en:"Huaihua",lat:27.5496,lon:109.9985,country:"China",admin1:"Hunan"},{id:"ld",name:"娄底",name_en:"Loudi",lat:27.7017,lon:111.9962,country:"China",admin1:"Hunan"},{id:"xx",name:"湘西",name_en:"Xiangxi",lat:28.3125,lon:109.7397,country:"China",admin1:"Hunan"},{id:"hf",name:"合肥",name_en:"Hefei",lat:31.8206,lon:117.2272,country:"China",admin1:"Anhui"},{id:"wh_ah",name:"芜湖",name_en:"Wuhu",lat:31.3528,lon:118.4331,country:"China",admin1:"Anhui"},{id:"bb",name:"蚌埠",name_en:"Bengbu",lat:32.9163,lon:117.3897,country:"China",admin1:"Anhui"},{id:"hn",name:"淮南",name_en:"Huainan",lat:32.6255,lon:116.9969,country:"China",admin1:"Anhui"},{id:"mas",name:"马鞍山",name_en:"Ma'anshan",lat:31.67,lon:118.506,country:"China",admin1:"Anhui"},{id:"hb",name:"淮北",name_en:"Huaibei",lat:33.9558,lon:116.7983,country:"China",admin1:"Anhui"},{id:"tl",name:"铜陵",name_en:"Tongling",lat:30.9455,lon:117.8115,country:"China",admin1:"Anhui"},{id:"aq",name:"安庆",name_en:"Anqing",lat:30.5354,lon:117.116,country:"China",admin1:"Anhui"},{id:"hs_ah",name:"黄山",name_en:"Huangshan",lat:29.7147,lon:118.3375,country:"China",admin1:"Anhui"},{id:"cz_ah",name:"滁州",name_en:"Chuzhou",lat:32.3017,lon:118.3163,country:"China",admin1:"Anhui"},{id:"fy",name:"阜阳",name_en:"Fuyang",lat:32.8901,lon:115.8142,country:"China",admin1:"Anhui"},{id:"sz_ah",name:"宿州",name_en:"Suzhou",lat:33.6393,lon:116.9773,country:"China",admin1:"Anhui"},{id:"la",name:"六安",name_en:"Lu'an",lat:31.7444,lon:116.5077,country:"China",admin1:"Anhui"},{id:"bz_ah",name:"亳州",name_en:"Bozhou",lat:33.8446,lon:115.7741,country:"China",admin1:"Anhui"},{id:"cz_ah2",name:"池州",name_en:"Chizhou",lat:30.6648,lon:117.4916,country:"China",admin1:"Anhui"},{id:"xc",name:"宣城",name_en:"Xuancheng",lat:30.9407,lon:118.7588,country:"China",admin1:"Anhui"},{id:"sjz",name:"石家庄",name_en:"Shijiazhuang",lat:38.0428,lon:114.5149,country:"China",admin1:"Hebei"},{id:"ty",name:"太原",name_en:"Taiyuan",lat:37.8706,lon:112.5489,country:"China",admin1:"Shanxi"},{id:"hu",name:"呼和浩特",name_en:"Hohhot",lat:40.8415,lon:111.7492,country:"China",admin1:"Inner Mongolia"},{id:"sy",name:"沈阳",name_en:"Shenyang",lat:41.8057,lon:123.4315,country:"China",admin1:"Liaoning"},{id:"cc",name:"长春",name_en:"Changchun",lat:43.8171,lon:125.3235,country:"China",admin1:"Jilin"},{id:"hrb",name:"哈尔滨",name_en:"Harbin",lat:45.8038,lon:126.5349,country:"China",admin1:"Heilongjiang"},{id:"nc",name:"南昌",name_en:"Nanchang",lat:28.683,lon:115.8579,country:"China",admin1:"Jiangxi"},{id:"zz",name:"郑州",name_en:"Zhengzhou",lat:34.7466,lon:113.6253,country:"China",admin1:"Henan"},{id:"nn",name:"南宁",name_en:"Nanning",lat:22.817,lon:108.3665,country:"China",admin1:"Guangxi"},{id:"hk",name:"海口",name_en:"Haikou",lat:20.044,lon:110.1999,country:"China",admin1:"Hainan"},{id:"gy_gz",name:"贵阳",name_en:"Guiyang",lat:26.647,lon:106.6302,country:"China",admin1:"Guizhou"},{id:"km",name:"昆明",name_en:"Kunming",lat:24.8801,lon:102.8329,country:"China",admin1:"Yunnan"},{id:"ls_xz",name:"拉萨",name_en:"Lhasa",lat:29.65,lon:91.1,country:"China",admin1:"Tibet"},{id:"xa",name:"西安",name_en:"Xi'an",lat:34.3416,lon:108.9398,country:"China",admin1:"Shaanxi"},{id:"lz",name:"兰州",name_en:"Lanzhou",lat:36.0611,lon:103.8343,country:"China",admin1:"Gansu"},{id:"xn_qh",name:"西宁",name_en:"Xining",lat:36.6171,lon:101.7782,country:"China",admin1:"Qinghai"},{id:"yc_nx",name:"银川",name_en:"Yinchuan",lat:38.4872,lon:106.2309,country:"China",admin1:"Ningxia"},{id:"wlmq",name:"乌鲁木齐",name_en:"Urumqi",lat:43.8256,lon:87.6168,country:"China",admin1:"Xinjiang"},{id:"hk_sar",name:"香港",name_en:"Hong Kong",lat:22.3193,lon:114.1694,country:"China",admin1:"Hong Kong"},{id:"mo_sar",name:"澳门",name_en:"Macau",lat:22.1987,lon:113.5439,country:"China",admin1:"Macau"},{id:"tw",name:"台北",name_en:"Taipei",lat:25.033,lon:121.5654,country:"China",admin1:"Taiwan"}],Cn=({children:t})=>Bt.createPortal(t,document.body),ka=()=>{const[t,e]=p.useState(!1),[n,s]=p.useState(!1),[i,r]=p.useState(!1);xt();const{t:o}=_e(),{settings:l,cursorEnabled:c,toggleCursor:u,backgroundScene:h,changeBackgroundScene:d}=yt(),{user:g,logout:f}=Ke(),[m,x]=p.useState(new Date),[v,y]=p.useState(null),[w,S]=p.useState(!1),[_,L]=p.useState(localStorage.getItem("weather_city")||"Hangzhou"),[H,D]=p.useState(JSON.parse(localStorage.getItem("weather_coords"))||{lat:30.27,lon:120.15}),[$,z]=p.useState(""),[T,A]=p.useState(!1),[j,N]=p.useState([]);p.useEffect(()=>{const b=setInterval(()=>x(new Date),6e4);return()=>clearInterval(b)},[]),p.useEffect(()=>{H&&tt.get(`https://api.open-meteo.com/v1/forecast?latitude=${H.lat}&longitude=${H.lon}&current_weather=true`).then(b=>{y(b.data.current_weather)}).catch(b=>console.error("Weather fetch failed",b))},[H]);const k=async b=>{if(b.preventDefault(),!$.trim())return;A(!0),N([]);const K=$.toLowerCase().trim(),V=jn.filter(O=>O.name.includes(K)||O.name_en.toLowerCase().includes(K)||O.admin1&&O.admin1.toLowerCase().includes(K)).map(O=>({id:`local-${O.id}`,name:O.name,country:O.country,admin1:O.admin1,latitude:O.lat,longitude:O.lon,isLocal:!0}));try{const O=await tt.get(`https://geocoding-api.open-meteo.com/v1/search?name=${$}&count=10&language=zh&format=json`);let Q=[];if(O.data.results&&O.data.results.length>0)Q=O.data.results;else{const ee=await tt.get(`https://geocoding-api.open-meteo.com/v1/search?name=${$}&count=10&format=json`);ee.data.results&&ee.data.results.length>0&&(Q=ee.data.results)}const le=Q.filter(ee=>!(V.some(ie=>ie.name===ee.name)||jn.some(ie=>ie.name===ee.name&&ie.admin1!==ee.admin1&&ie.country===ee.country))),Ee=[...V,...le].filter((ee,qe,Xe)=>Xe.findIndex(ie=>Math.abs(ie.latitude-ee.latitude)<.1&&Math.abs(ie.longitude-ee.longitude)<.1)===qe);N(Ee)}catch(O){console.error("Geocoding failed",O),N(V)}finally{A(!1)}},I=b=>{const K={lat:b.latitude,lon:b.longitude},V=b.name;D(K),L(V),localStorage.setItem("weather_city",V),localStorage.setItem("weather_coords",JSON.stringify(K)),S(!1),z(""),N([])},F=b=>b===0||b===1?a.jsx(mi,{size:14,className:"text-yellow-400"}):b===2||b===3?a.jsx(St,{size:14,className:"text-gray-400"}):b>=45&&b<=48?a.jsx(gi,{size:14,className:"text-gray-400"}):b>=51&&b<=67?a.jsx(en,{size:14,className:"text-blue-400"}):b>=71&&b<=77?a.jsx(xi,{size:14,className:"text-white"}):b>=80&&b<=82?a.jsx(en,{size:14,className:"text-blue-500"}):b>=95&&b<=99?a.jsx(vi,{size:14,className:"text-yellow-500"}):a.jsx(St,{size:14}),G=[{key:"home",path:"/"},{key:"events",path:"/events"},{key:"gallery",path:"/gallery"},{key:"music",path:"/music"},{key:"videos",path:"/videos"},{key:"articles",path:"/articles"},{key:"about",path:"/about"},{key:"admin",path:"/admin"}];return p.useEffect(()=>{const b=()=>r(!0);return window.addEventListener("open-profile-modal",b),()=>window.removeEventListener("open-profile-modal",b)},[]),a.jsxs(U.nav,{initial:{y:-100},animate:{y:0},transition:{duration:.8},className:"fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 backdrop-blur-md bg-black/30 border-b border-white/10",children:[a.jsxs(st,{to:"/",className:"flex items-center gap-3 text-white group z-50",children:[a.jsx("img",{src:"/newlogo.png",alt:"拓途浙享",className:"h-10 w-auto object-contain"}),a.jsxs("div",{className:"flex flex-col items-start leading-none",children:[a.jsx("span",{className:"text-xl font-bold tracking-[0.2em] text-white",children:"拓途浙享"}),a.jsx("span",{className:"text-[10px] tracking-[0.3em] text-gray-400 mt-1",children:"TUOTU ZHEXIANG"})]})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[G.map(b=>a.jsxs(st,{to:b.path,className:"text-sm font-medium text-gray-300 hover:text-white transition-colors relative group",children:[o(`nav.${b.key}`),a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"})]},b.key)),a.jsx("div",{className:"w-px h-6 bg-white/20 mx-2"}),a.jsx("button",{onClick:()=>window.dispatchEvent(new Event("open-search-palette")),className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-full transition-all",title:o("nav.search_title"),children:a.jsx(Ue,{size:18})}),a.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-3 text-xs text-gray-400 border border-white/10 px-3 py-1.5 rounded-full bg-black/20 hover:bg-white/10 hover:text-white transition-all cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(hi,{size:12}),a.jsx("span",{children:m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("div",{className:"w-px h-3 bg-white/20"}),a.jsxs("div",{className:"flex items-center gap-1",children:[v?F(v.weathercode):a.jsx(St,{size:12}),a.jsx("span",{children:v?`${Math.round(v.temperature)}°C`:"..."})]}),a.jsx("div",{className:"w-px h-3 bg-white/20"}),a.jsx("span",{className:"truncate max-w-[60px]",children:_})]}),a.jsx("button",{onClick:u,className:`p-2 rounded-full transition-all ${c?"bg-white/10 text-white":"text-gray-400 hover:text-white"}`,title:o(c?"nav.cursor_disable":"nav.cursor_enable"),children:a.jsx(fi,{size:18})}),a.jsx("button",{onClick:()=>s(!0),className:`p-2 rounded-full transition-all ${n?"bg-white/10 text-white":"text-gray-400 hover:text-white"}`,title:o("nav.theme_settings"),children:a.jsx(Qt,{size:18})}),a.jsx(wn,{}),g?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 text-sm font-bold text-white px-4 py-2 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 transition-all",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-600 flex items-center justify-center text-[10px] text-white",children:g.username.charAt(0).toUpperCase()}),a.jsx("span",{children:g.username})]}),a.jsx("button",{onClick:f,className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-full transition-all",title:o("auth.log_out"),children:a.jsx(cs,{size:18})})]}):a.jsx("button",{onClick:()=>e(!0),className:"text-sm font-bold bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-full transition-all",children:o("auth.log_in")})]}),a.jsxs("div",{className:"md:hidden flex items-center gap-3 z-50",children:[a.jsx("button",{onClick:()=>window.dispatchEvent(new Event("open-search-palette")),className:"p-2 text-gray-300 hover:text-white",children:a.jsx(Ue,{size:20})}),a.jsx(wn,{}),g?a.jsx("button",{onClick:()=>r(!0),className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-[10px] text-white font-bold border border-white/20",children:g.username.charAt(0).toUpperCase()}):a.jsx("button",{onClick:()=>e(!0),className:"text-xs font-bold bg-purple-600 hover:bg-purple-700 text-white px-3 py-1.5 rounded-full transition-all",children:o("auth.log_in")})]}),a.jsxs(re,{children:[w&&a.jsx(Cn,{children:a.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>S(!1),children:a.jsxs(U.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-[#1a1a1a] border border-white/10 rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl p-6 relative z-10",onClick:b=>b.stopPropagation(),children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-purple-500/5 opacity-50 pointer-events-none"}),a.jsxs("div",{className:"flex justify-between items-center mb-6 relative z-10",children:[a.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[a.jsx(pi,{size:24,className:"text-indigo-400"})," ",o("weather.location")]}),a.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(de,{size:24})})]}),a.jsxs("form",{onSubmit:k,className:"space-y-4 relative z-10",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:o("weather.city_label")}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:$,onChange:b=>z(b.target.value),placeholder:o("weather.placeholder"),className:"w-full bg-black/20 border border-white/10 rounded-xl pl-10 pr-4 py-3 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/40",autoFocus:!0}),a.jsx(Ue,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:o("weather.search_help")})]}),a.jsx("button",{type:"submit",disabled:T,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-indigo-500/25",children:o(T?"weather.searching":"weather.search_btn")})]}),j.length>0&&a.jsxs("div",{className:"mt-4 max-h-48 overflow-y-auto custom-scrollbar space-y-2 border-t border-white/10 pt-4 relative z-10",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:o("weather.select")}),j.map(b=>a.jsxs("button",{onClick:()=>I(b),className:`w-full text-left p-3 rounded-lg hover:bg-white/10 transition-colors flex flex-col group ${b.isLocal?"bg-indigo-900/20 border border-indigo-500/30":"bg-black/20"}`,children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:`font-bold transition-colors ${b.isLocal?"text-indigo-400":"text-white group-hover:text-indigo-400"}`,children:b.name}),b.country_code?a.jsx("img",{src:`https://flagcdn.com/16x12/${b.country_code.toLowerCase()}.png`,alt:b.country,className:"opacity-50 group-hover:opacity-100 transition-opacity"}):a.jsx("span",{className:"text-[10px] bg-white/10 px-1.5 rounded text-gray-400",children:b.country})]}),a.jsx("span",{className:"text-xs text-gray-400 group-hover:text-gray-300",children:[b.admin1,b.country].filter(Boolean).join(", ")})]},b.id))]})]})})}),n&&a.jsx(Cn,{children:a.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>s(!1),children:a.jsxs(U.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-[#0f172a]/90 backdrop-blur-xl border border-white/10 p-4 rounded-2xl shadow-2xl w-full max-w-sm max-h-[80vh] overflow-y-auto custom-scrollbar relative z-10",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-4 text-white/80 sticky top-0 bg-[#0f172a]/95 p-2 rounded-lg z-10 backdrop-blur-md",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qt,{size:16}),a.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest",children:o("nav.theme_settings")})]}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-white",children:a.jsx(de,{size:20})})]}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:Ea.map(b=>{const K=b.icon,V=h===b.id;return a.jsx("button",{onClick:()=>d(b.id),className:`w-full text-left p-3 rounded-xl transition-all duration-300 border group relative overflow-hidden
                          ${V?`${b.bg} border-${b.color.split("-")[1]}-500/50`:"bg-white/5 border-transparent hover:bg-white/10"}`,children:a.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${V?"bg-black/20":"bg-black/40"} ${b.color}`,children:a.jsx(K,{size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:`font-bold text-sm ${V?"text-white":"text-gray-300"}`,children:o(b.labelKey)}),a.jsx("div",{className:"text-[10px] text-white/50 font-mono uppercase tracking-wider",children:o(b.descKey)})]}),V&&a.jsx("div",{className:"ml-auto",children:a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${b.color.replace("text","bg")}`}),a.jsx("span",{className:`relative inline-flex rounded-full h-2 w-2 ${b.color.replace("text","bg")}`})]})})]})},b.id)})})]})})})]}),a.jsx(js,{isOpen:t,onClose:()=>e(!1)}),a.jsx(Ta,{isOpen:i,onClose:()=>r(!1)})]})};/**
 * postprocessing v6.38.0 build Sat Nov 08 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var Tt=1/1e3,Ra=1e3,Pa=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*Tt}get fixedDelta(){return this._fixedDelta*Tt}set fixedDelta(t){this._fixedDelta=t*Ra}get elapsed(){return this._elapsed*Tt}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},za=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new Ht;return n.setAttribute("position",new qt(t,3)),n.setAttribute("uv",new qt(e,2)),n})(),Y=class Ut{static get fullscreenGeometry(){return za}constructor(e="Pass",n=new Kt,s=new Xs){this.name=e,this.renderer=null,this.scene=n,this.camera=s,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new Zs(Ut.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new Kt),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=ze){}render(e,n,s,i,r){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,s){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof oe||n instanceof Hn||n instanceof $n||n instanceof Ut)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Oa=class extends Y{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,s,i){const r=t.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},Ma=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,Cs="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",_s=class extends me{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new P(null),depthBuffer:new P(null),channelWeights:new P(null),opacity:new P(1)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ma,vertexShader:Cs}),this.depthFunc=Qs}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(t){const e=t!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){const e=t!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(t){t!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=t):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},La=class extends Y{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new _s,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new oe(1,1,{minFilter:it,magFilter:it,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,s,i){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==we?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===q&&(this.renderTarget.texture.colorSpace=q))}},_n=new An,Es=class extends Y{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,s,i){const r=this.overrideClearColor,o=this.overrideClearAlpha,l=t.getClearAlpha(),c=r!==null,u=o>=0;c?(t.getClearColor(_n),t.setClearColor(r,u?o:l)):u&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),c?t.setClearColor(_n,l):u&&t.setClearAlpha(l)}},Ia=class extends Y{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new Es(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,s,i){const r=t.getContext(),o=t.state.buffers,l=this.scene,c=this.camera,u=this.clearPass,h=this.inverted?0:1,d=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.stencil.setFunc(r.ALWAYS,h,4294967295),o.stencil.setClear(d),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(t,null):(u.render(t,e),u.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(l,c)):(t.setRenderTarget(e),t.render(l,c),t.setRenderTarget(n),t.render(l,c)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(r.EQUAL,1,4294967295),o.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.stencil.setLocked(!0)}},Ua=class{constructor(e=null,{depthBuffer:n=!0,stencilBuffer:s=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(n,s,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new La,this.depthTexture=null,this.passes=[],this.timer=new Pa,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const n=this.inputBuffer,s=this.multisampling;s>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):s!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(n.depthBuffer,n.stencilBuffer,n.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const n=e.getSize(new Z),s=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===we&&e.outputColorSpace===q&&(this.inputBuffer.texture.colorSpace=q,this.outputBuffer.texture.colorSpace=q,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(n.width,n.height);for(const r of this.passes)r.initialize(e,s,i)}}replaceRenderer(e,n=!0){const s=this.renderer,i=s.domElement.parentNode;return this.setRenderer(e),n&&i!==null&&(i.removeChild(s.domElement),i.appendChild(e.domElement)),s}createDepthTexture(){const e=this.depthTexture=new $s;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Gs,e.type=Vs):e.type=Ws,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,n,s,i){const r=this.renderer,o=r===null?new Z:r.getDrawingBufferSize(new Z),l={minFilter:it,magFilter:it,stencilBuffer:n,depthBuffer:e,type:s},c=new oe(o.width,o.height,l);return i>0&&(c.samples=i),s===we&&r!==null&&r.outputColorSpace===q&&(c.texture.colorSpace=q),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(e){for(const n of this.passes)n.mainScene=e}setMainCamera(e){for(const n of this.passes)n.mainCamera=e}addPass(e,n){const s=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new Z),o=i.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(r.width,r.height),e.initialize(i,o,l),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),n!==void 0?s.splice(n,0,e):s.push(e),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(e of s)e.setDepthTexture(c)}else e.setDepthTexture(this.depthTexture)}removePass(e){const n=this.passes,s=n.indexOf(e);if(s!==-1&&n.splice(s,1).length>0){if(this.depthTexture!==null){const o=(c,u)=>c||u.needsDepthTexture;n.reduce(o,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&s===n.length&&(e.renderToScreen=!1,n.length>0&&(n[n.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const n=this.renderer,s=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,o=!1,l,c,u;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(n,i,r,e,o),h.needsSwap&&(o&&(s.renderToScreen=h.renderToScreen,l=n.getContext(),c=n.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),s.render(n,i,r,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,i=r,r=u),h instanceof Ia?o=!0:h instanceof Oa&&(o=!1))}setSize(e,n,s){const i=this.renderer,r=i.getSize(new Z);(e===void 0||n===void 0)&&(e=r.width,n=r.height),(r.width!==e||r.height!==n)&&i.setSize(e,n,s);const o=i.getDrawingBufferSize(new Z);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const l of this.passes)l.setSize(o.width,o.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Y.fullscreenGeometry.dispose()}},ue={NONE:0,DEPTH:1,CONVOLUTION:2},M={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Da=class{constructor(){this.shaderParts=new Map([[M.FRAGMENT_HEAD,null],[M.FRAGMENT_MAIN_UV,null],[M.FRAGMENT_MAIN_IMAGE,null],[M.VERTEX_HEAD,null],[M.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=ue.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Bn}},kt=!1,En=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case Je:n=this.materialsFlatShadedDoubleSide;break;case Ze:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case Je:n=this.materialsDoubleSide;break;case Ze:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof me))return t.clone();const e=t.uniforms,n=new Map;for(const i in e){const r=e[i].value;r.isRenderTargetTexture&&(e[i].value=null,n.set(i,r))}const s=t.clone();for(const i of n)e[i[0]].value=i[1],s.uniforms[i[0]].value=i[1];return s}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=Js;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.side=Ze,s}),this.materialsDoubleSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.side=Je,s}),this.materialsFlatShaded=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s}),this.materialsFlatShadedBackSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s.side=Ze,s}),this.materialsFlatShadedDoubleSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s.side=Je,s})}}render(t,e,n){const s=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,kt){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const r of i)r[0].material=r[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=i}t.shadowMap.enabled=s}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return kt}static set workaroundEnabled(t){kt=t}},fe=-1,X=class extends Ft{constructor(t,e=fe,n=fe,s=1){super(),this.resizable=t,this.baseSize=new Z(1,1),this.preferredSize=new Z(e,n),this.target=this.preferredSize,this.s=s,this.effectiveSize=new Z,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,n=this.effectiveSize,s=this.scale;e.width!==fe?n.width=e.width:e.height!==fe?n.width=Math.round(e.height*(t.width/Math.max(t.height,1))):n.width=Math.round(t.width*s),e.height!==fe?n.height=e.height:e.width!==fe?n.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n.height=Math.round(t.height*s)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(fe),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return fe}},R={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Aa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",Ba="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",Fa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Ha="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",$a="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Ga="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",Va="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",Wa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",Ka="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",qa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Xa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",Za="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",Ja="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",Ya="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",Qa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",er="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",tr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",nr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",sr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",ir="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",ar="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",rr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",or="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",lr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",cr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",ur="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",dr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",hr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",fr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",pr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",mr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",gr=new Map([[R.ADD,Aa],[R.AVERAGE,Ba],[R.COLOR,Fa],[R.COLOR_BURN,Ha],[R.COLOR_DODGE,$a],[R.DARKEN,Ga],[R.DIFFERENCE,Va],[R.DIVIDE,Wa],[R.DST,null],[R.EXCLUSION,Ka],[R.HARD_LIGHT,qa],[R.HARD_MIX,Xa],[R.HUE,Za],[R.INVERT,Ja],[R.INVERT_RGB,Ya],[R.LIGHTEN,Qa],[R.LINEAR_BURN,er],[R.LINEAR_DODGE,tr],[R.LINEAR_LIGHT,nr],[R.LUMINOSITY,sr],[R.MULTIPLY,ir],[R.NEGATION,ar],[R.NORMAL,rr],[R.OVERLAY,or],[R.PIN_LIGHT,lr],[R.REFLECT,cr],[R.SATURATION,ur],[R.SCREEN,dr],[R.SOFT_LIGHT,hr],[R.SRC,fr],[R.SUBTRACT,pr],[R.VIVID_LIGHT,mr]]),xr=class extends Ft{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new P(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return gr.get(this.blendFunction)}},Ge=class extends Ft{constructor(t,e,{attributes:n=ue.NONE,blendFunction:s=R.NORMAL,defines:i=new Map,uniforms:r=new Map,extensions:o=null,vertexShader:l=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=l,this.defines=i,this.uniforms=r,this.extensions=o,this.blendMode=new xr(s),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=Bn,this._outputColorSpace=Fn}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=ze){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof oe||e instanceof Hn||e instanceof $n||e instanceof Y)&&this[t].dispose()}}},Gt={MEDIUM:2,LARGE:3},vr=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,yr="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",br=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],wr=class extends me{constructor(t=new Xt){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new P(null),texelSize:new P(new Xt),scale:new P(1),kernel:new P(0)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vr,vertexShader:yr}),this.setTexelSize(t.x,t.y),this.kernelSize=Gt.MEDIUM}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get kernelSequence(){return br[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e,t*.5,e*.5)}setSize(t,e){const n=1/t,s=1/e;this.uniforms.texelSize.value.set(n,s,n*.5,s*.5)}},Sr=class extends Y{constructor({kernelSize:t=Gt.MEDIUM,resolutionScale:e=.5,width:n=X.AUTO_SIZE,height:s=X.AUTO_SIZE,resolutionX:i=n,resolutionY:r=s}={}){super("KawaseBlurPass"),this.renderTargetA=new oe(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new X(this,i,r,e);o.addEventListener("change",l=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new wr,this._blurMaterial.kernelSize=t,this.copyMaterial=new _s}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(t){this._blurMaterial=t}get dithering(){return this.copyMaterial.dithering}set dithering(t){this.copyMaterial.dithering=t}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(t){this.blurMaterial.kernelSize=t}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,s,i){const r=this.scene,o=this.camera,l=this.renderTargetA,c=this.renderTargetB,u=this.blurMaterial,h=u.kernelSequence;let d=e;this.fullscreenMaterial=u;for(let g=0,f=h.length;g<f;++g){const m=g&1?c:l;u.kernel=h[g],u.inputBuffer=d.texture,t.setRenderTarget(m),t.render(r,o),d=m}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=d.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(r,o)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e);const s=n.width,i=n.height;this.renderTargetA.setSize(s,i),this.renderTargetB.setSize(s,i),this.blurMaterial.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==we?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t!==null&&t.outputColorSpace===q&&(this.renderTargetA.texture.colorSpace=q,this.renderTargetB.texture.colorSpace=q))}static get AUTO_SIZE(){return X.AUTO_SIZE}},jr=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Cr=class extends me{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Gn.replace(/\D+/g,"")},uniforms:{inputBuffer:new P(null),threshold:new P(0),smoothing:new P(1),range:new P(null)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:jr,vertexShader:Cs}),this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},_r=class extends Y{constructor({renderTarget:t,luminanceRange:e,colorOutput:n,resolutionScale:s=1,width:i=X.AUTO_SIZE,height:r=X.AUTO_SIZE,resolutionX:o=i,resolutionY:l=r}={}){super("LuminancePass"),this.fullscreenMaterial=new Cr(n,e),this.needsSwap=!1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new oe(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new X(this,o,l,s);c.addEventListener("change",u=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,n,s,i){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){n!==void 0&&n!==we&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Er=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Nr="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",Tr=class extends me{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new P(null),texelSize:new P(new Z)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Er,vertexShader:Nr})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},kr=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Rr="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Pr=class extends me{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new P(null),supportBuffer:new P(null),texelSize:new P(new Z),radius:new P(.85)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:kr,vertexShader:Rr})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}set supportBuffer(t){this.uniforms.supportBuffer.value=t}get radius(){return this.uniforms.radius.value}set radius(t){this.uniforms.radius.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},zr=class extends Y{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new oe(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Tr,this.upsamplingMaterial=new Pr,this.resolution=new Z}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(t){if(this.levels!==t){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<t;++n){const s=e.clone();s.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(s)}this.upsamplingMipmaps.push(e);for(let n=1,s=t-1;n<s;++n){const i=e.clone();i.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(t){this.upsamplingMaterial.radius=t}render(t,e,n,s,i){const{scene:r,camera:o}=this,{downsamplingMaterial:l,upsamplingMaterial:c}=this,{downsamplingMipmaps:u,upsamplingMipmaps:h}=this;let d=e;this.fullscreenMaterial=l;for(let g=0,f=u.length;g<f;++g){const m=u[g];l.setSize(d.width,d.height),l.inputBuffer=d.texture,t.setRenderTarget(m),t.render(r,o),d=m}this.fullscreenMaterial=c;for(let g=h.length-1;g>=0;--g){const f=h[g];c.setSize(d.width,d.height),c.inputBuffer=d.texture,c.supportBuffer=u[g].texture,t.setRenderTarget(f),t.render(r,o),d=f}}setSize(t,e){const n=this.resolution;n.set(t,e);let s=n.width,i=n.height;for(let r=0,o=this.downsamplingMipmaps.length;r<o;++r)s=Math.round(s*.5),i=Math.round(i*.5),this.downsamplingMipmaps[r].setSize(s,i),r<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[r].setSize(s,i)}initialize(t,e,n){if(n!==void 0){const s=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of s)i.texture.type=n;if(n!==we)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(t!==null&&t.outputColorSpace===q)for(const i of s)i.texture.colorSpace=q}}dispose(){super.dispose();for(const t of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))t.dispose()}},Or=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,Mr=class extends Ge{constructor({blendFunction:t=R.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:n=.03,mipmapBlur:s=!0,intensity:i=1,radius:r=.85,levels:o=8,kernelSize:l=Gt.LARGE,resolutionScale:c=.5,width:u=X.AUTO_SIZE,height:h=X.AUTO_SIZE,resolutionX:d=u,resolutionY:g=h}={}){super("BloomEffect",Or,{blendFunction:t,uniforms:new Map([["map",new P(null)],["intensity",new P(i)]])}),this.renderTarget=new oe(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Sr({kernelSize:l}),this.luminancePass=new _r({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new zr,this.mipmapBlurPass.enabled=s,this.mipmapBlurPass.radius=r,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=s?this.mipmapBlurPass.texture:this.renderTarget.texture;const f=this.resolution=new X(this,d,g,c);f.addEventListener("change",m=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){const s=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(t,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,i.renderTarget):this.blurPass.render(t,i.renderTarget,s)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,e):this.blurPass.render(t,e,s)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(t,e),this.mipmapBlurPass.setSize(t,e)}initialize(t,e,n){this.blurPass.initialize(t,e,n),this.luminancePass.initialize(t,e,n),this.mipmapBlurPass.initialize(t,e,n),n!==void 0&&(this.renderTarget.texture.type=n,t!==null&&t.outputColorSpace===q&&(this.renderTarget.texture.colorSpace=q))}},Ns=class extends Y{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new Es,this.overrideMaterialManager=n===null?null:new En(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new En(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,s,i){const r=this.scene,o=this.camera,l=this.selection,c=o.layers.mask,u=r.background,h=t.shadowMap.autoUpdate,d=this.renderToScreen?null:e;l!==null&&o.layers.set(l.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,r,o):t.render(r,o),o.layers.mask=c,r.background=u,t.shadowMap.autoUpdate=h}},Ie={DEFAULT:0,ESKIL:1},Lr=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Ir=class extends Ge{constructor({blendFunction:t=R.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",Lr,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},Ur=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,Dr="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",Ar=class extends me{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new P(null),normalBuffer:new P(null),texelSize:new P(new Z)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ur,vertexShader:Dr})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=ze){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},Br=class extends Y{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:n=X.AUTO_SIZE,height:s=X.AUTO_SIZE,resolutionX:i=n,resolutionY:r=s}={}){super("DepthDownsamplingPass");const o=new Ar;o.normalBuffer=t,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new oe(1,1,{minFilter:at,magFilter:at,depthBuffer:!1,type:qs}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const l=this.resolution=new X(this,i,r,e);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=ze){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,n,s,i){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,n){const s=t.getContext();if(!(s.getExtension("EXT_color_buffer_float")||s.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},Fr=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,Hr=class extends Ge{constructor({blendFunction:t,eskil:e=!1,technique:n=e?Ie.ESKIL:Ie.DEFAULT,offset:s=.5,darkness:i=.5}={}){super("VignetteEffect",Fr,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",n.toFixed(0)]]),uniforms:new Map([["offset",new P(s)],["darkness",new P(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===Ie.ESKIL}set eskil(t){this.technique=t?Ie.ESKIL:Ie.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},$r=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Gr="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Vr=class extends me{constructor(t,e,n,s,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Gn.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new P(null),depthBuffer:new P(null),resolution:new P(new Z),texelSize:new P(new Z),cameraNear:new P(.3),cameraFar:new P(1e3),aspect:new P(1),time:new P(0)},blending:Ce,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(s)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=ze){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=$r.replace(M.FRAGMENT_HEAD,t.get(M.FRAGMENT_HEAD)||"").replace(M.FRAGMENT_MAIN_UV,t.get(M.FRAGMENT_MAIN_UV)||"").replace(M.FRAGMENT_MAIN_IMAGE,t.get(M.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Gr.replace(M.VERTEX_HEAD,t.get(M.VERTEX_HEAD)||"").replace(M.VERTEX_MAIN_SUPPORT,t.get(M.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Ys?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return M}};function Nn(t,e,n){for(const s of e){const i="$1"+t+s.charAt(0).toUpperCase()+s.slice(1),r=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(r,i))}}function Wr(t,e,n){let s=e.getFragmentShader(),i=e.getVertexShader();const r=s!==void 0&&/mainImage/.test(s),o=s!==void 0&&/mainUv/.test(s);if(n.attributes|=e.getAttributes(),s===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&n.attributes&ue.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=n.shaderParts;let u=c.get(M.FRAGMENT_HEAD)||"",h=c.get(M.FRAGMENT_MAIN_UV)||"",d=c.get(M.FRAGMENT_MAIN_IMAGE)||"",g=c.get(M.VERTEX_HEAD)||"",f=c.get(M.VERTEX_MAIN_SUPPORT)||"";const m=new Set,x=new Set;if(o&&(h+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const w=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);f+=`	${t}MainSupport(`,f+=w?`vUv);
`:`);
`;for(const S of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const _ of S[1].split(/\s*,\s*/))n.varyings.add(_),m.add(_),x.add(_);for(const S of i.matchAll(l))x.add(S[1])}for(const w of s.matchAll(l))x.add(w[1]);for(const w of e.defines.keys())x.add(w.replace(/\([\w\s,]*\)/g,""));for(const w of e.uniforms.keys())x.add(w);x.delete("while"),x.delete("for"),x.delete("if"),e.uniforms.forEach((w,S)=>n.uniforms.set(t+S.charAt(0).toUpperCase()+S.slice(1),w)),e.defines.forEach((w,S)=>n.defines.set(t+S.charAt(0).toUpperCase()+S.slice(1),w));const v=new Map([["fragment",s],["vertex",i]]);Nn(t,x,n.defines),Nn(t,x,v),s=v.get("fragment"),i=v.get("vertex");const y=e.blendMode;if(n.blendModes.set(y.blendFunction,y),r){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(d+=e.inputColorSpace===q?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Fn?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const w=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${t}MainImage(color0, UV, `,n.attributes&ue.DEPTH&&w.test(s)&&(d+="depth, ",n.readDepth=!0),d+=`color1);
	`;const S=t+"BlendOpacity";n.uniforms.set(S,y.opacity),d+=`color0 = blend${y.blendFunction}(color0, color1, ${S});

	`,u+=`uniform float ${S};

`}if(u+=s+`
`,i!==null&&(g+=i+`
`),c.set(M.FRAGMENT_HEAD,u),c.set(M.FRAGMENT_MAIN_UV,h),c.set(M.FRAGMENT_MAIN_IMAGE,d),c.set(M.VERTEX_HEAD,g),c.set(M.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const w of e.extensions)n.extensions.add(w)}}var Kr=class extends Y{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new Vr(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new Da;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===R.DST)t.attributes|=o.getAttributes()&ue.DEPTH;else{if(t.attributes&o.getAttributes()&ue.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);Wr("e"+e++,o,t)}let n=t.shaderParts.get(M.FRAGMENT_HEAD),s=t.shaderParts.get(M.FRAGMENT_MAIN_IMAGE),i=t.shaderParts.get(M.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const o of t.blendModes.values())n+=o.getShaderCode().replace(r,`blend${o.blendFunction}`)+`
`;t.attributes&ue.DEPTH?(t.readDepth&&(s=`float depth = readDepth(UV);

	`+s),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===q&&(s+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(M.FRAGMENT_HEAD,n),t.shaderParts.set(M.FRAGMENT_MAIN_IMAGE,s),t.shaderParts.set(M.FRAGMENT_MAIN_UV,i);for(const[o,l]of t.shaderParts)l!==null&&t.shaderParts.set(o,l.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=ze){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,s,i){for(const r of this.effects)r.update(t,e,s);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=s*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const s of this.effects)s.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==we&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},qr=class extends Y{constructor(t,e,{renderTarget:n,resolutionScale:s=1,width:i=X.AUTO_SIZE,height:r=X.AUTO_SIZE,resolutionX:o=i,resolutionY:l=r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new Ns(t,e,new Ks);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const u=c.getClearPass();u.overrideClearColor=new An(7829503),u.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new oe(1,1,{minFilter:at,magFilter:at}),this.renderTarget.texture.name="NormalPass.Target");const h=this.resolution=new X(this,o,l,s);h.addEventListener("change",d=>this.setSize(h.baseWidth,h.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,s,i){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,r,r)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}};const Xr=p.createContext(null),Tn=t=>(t.getAttributes()&ue.CONVOLUTION)===ue.CONVOLUTION,Zr=te.memo(p.forwardRef(({children:t,camera:e,scene:n,resolutionScale:s,enabled:i=!0,renderPriority:r=1,autoClear:o=!0,depthBuffer:l,enableNormalPass:c,stencilBuffer:u,multisampling:h=8,frameBufferType:d=ti},g)=>{const{gl:f,scene:m,camera:x,size:v}=Vn(),y=n||m,w=e||x,[S,_,L]=p.useMemo(()=>{const z=ei(),T=new Ua(f,{depthBuffer:l,stencilBuffer:u,multisampling:h>0&&z?h:0,frameBufferType:d});T.addPass(new Ns(y,w));let A=null,j=null;return c&&(j=new qr(y,w),j.enabled=!1,T.addPass(j),s!==void 0&&z&&(A=new Br({normalBuffer:j.texture,resolutionScale:s}),A.enabled=!1,T.addPass(A))),[T,j,A]},[w,f,l,u,h,d,y,c,s]);p.useEffect(()=>S==null?void 0:S.setSize(v.width,v.height),[S,v]),Oe((z,T)=>{if(i){const A=f.autoClear;f.autoClear=o,u&&!o&&f.clearStencil(),S.render(T),f.autoClear=A}},i?r:0);const H=p.useRef(null),D=ni(H);p.useLayoutEffect(()=>{const z=[];if(H.current&&D.current&&S){const T=D.current.objects;for(let A=0;A<T.length;A++){const j=T[A];if(j instanceof Ge){const N=[j];if(!Tn(j)){let I=null;for(;(I=T[A+1])instanceof Ge&&!Tn(I);)N.push(I),A++}const k=new Kr(w,...N);z.push(k)}else j instanceof Y&&z.push(j)}for(const A of z)S==null||S.addPass(A);_&&(_.enabled=!0),L&&(L.enabled=!0)}return()=>{for(const T of z)S==null||S.removePass(T);_&&(_.enabled=!1),L&&(L.enabled=!1)}},[S,t,w,_,L,D]),p.useEffect(()=>{const z=f.toneMapping;return f.toneMapping=si,()=>{f.toneMapping=z}},[]);const $=p.useMemo(()=>({composer:S,normalPass:_,downSamplingPass:L,resolutionScale:s,camera:w,scene:y}),[S,_,L,s,w,y]);return p.useImperativeHandle(g,()=>S,[S]),a.jsx(Xr.Provider,{value:$,children:a.jsx("group",{ref:H,children:t})})}));let Jr=0;const kn=new WeakMap,Vt=(t,e)=>te.forwardRef(function({blendFunction:s=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r},o){let l=kn.get(t);if(!l){const h=`@react-three/postprocessing/${t.name}-${Jr++}`;ii({[h]:t}),kn.set(t,l=h)}const c=Vn(h=>h.camera),u=te.useMemo(()=>{var h,d;return[...(h=e==null?void 0:e.args)!=null?h:[],...(d=r.args)!=null?d:[{...e,...r}]]},[JSON.stringify(r)]);return a.jsx(l,{camera:c,"blendMode-blendFunction":s,"blendMode-opacity-value":i,...r,ref:o,args:u})}),Yr=Vt(Mr,{blendFunction:R.ADD}),Qr=Vt(Ir,{blendFunction:R.COLOR_DODGE}),eo=Vt(Hr),mt="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9ImciIGN4PSI1MCUiIGN5PSI1MCUiIHI9IjUwJSIgZng9IjUwJSIgZnk9IjUwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0id2hpdGUiIHN0b3Atb3BhY2l0eT0iMSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0id2hpdGUiIHN0b3Atb3BhY2l0eT0iMCIvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxjaXJjbGUgY3g9IjY0IiBjeT0iNjQiIHI9IjY0IiBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+",to=()=>a.jsxs("group",{children:[a.jsx(Me,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:.5}),a.jsxs(We,{speed:1,rotationIntensity:.2,floatIntensity:.2,children:[a.jsx(rt,{texture:mt,opacity:.3,speed:.2,width:10,depth:1.5,segments:20,position:[0,0,-20],color:"#4c1d95"}),a.jsx(rt,{texture:mt,opacity:.3,speed:.2,width:10,depth:1.5,segments:20,position:[10,5,-25],color:"#1e40af"})]})]}),no=()=>{const t=p.useRef();return Oe(e=>{t.current&&(t.current.position.z=e.clock.elapsedTime*5%10)}),a.jsxs("group",{rotation:[Math.PI/2.5,0,0],position:[0,-2,-10],children:[a.jsx("gridHelper",{ref:t,args:[100,50,16711935,2228292]}),a.jsx("fog",{attach:"fog",args:["#000",5,40]}),a.jsx(Me,{radius:50,count:1e3,factor:4,fade:!0,speed:1})]})},so=()=>a.jsxs("group",{children:[a.jsx(vt,{count:500,scale:[20,10,10],size:6,speed:.4,opacity:.8,color:"#ffaa00",position:[0,-5,0]}),a.jsx("pointLight",{position:[0,-5,0],intensity:2,color:"#ff4400",distance:15}),a.jsx("fog",{attach:"fog",args:["#1a0500",5,20]})]}),io=()=>a.jsxs("group",{children:[a.jsxs(We,{speed:2,rotationIntensity:1,floatIntensity:2,children:[a.jsx(et,{args:[2,0],position:[0,0,-5],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#00ffff",emissive:"#004444",wireframe:!0})}),a.jsx(et,{args:[1.5,0],position:[4,2,-8],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#ff00ff",emissive:"#440044",wireframe:!0})}),a.jsx(et,{args:[1,0],position:[-4,-2,-6],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#ffff00",emissive:"#444400",wireframe:!0})})]}),a.jsx(vt,{count:100,scale:15,size:3,speed:.5,opacity:.5,color:"white"})]}),ao=()=>a.jsxs("group",{children:[a.jsx("color",{attach:"background",args:["#88ccff"]}),a.jsxs(We,{speed:.5,rotationIntensity:.1,floatIntensity:.5,children:[a.jsx(rt,{texture:mt,opacity:.5,speed:.1,width:20,depth:2,segments:20,position:[0,0,-15],color:"white"}),a.jsx(rt,{texture:mt,opacity:.3,speed:.1,width:10,depth:1,segments:10,position:[-5,2,-10],color:"#ffdddd"})]}),a.jsx("ambientLight",{intensity:1})]}),ro=()=>{const t=p.useRef();return Oe(e=>{t.current&&(t.current.position.z=e.clock.elapsedTime*2%5,t.current.position.x=Math.sin(e.clock.elapsedTime*.5)*2)}),a.jsxs("group",{rotation:[Math.PI/3,0,0],position:[0,-2,-10],children:[a.jsx("gridHelper",{ref:t,args:[60,30,65535,13107]}),a.jsx("fog",{attach:"fog",args:["#000",2,25]}),a.jsx(Me,{radius:40,count:500,factor:3,fade:!0,speed:.5,color:"#00ffff"})]})},oo=()=>{const t=p.useRef();Oe(n=>{t.current&&(t.current.rotation.y=n.clock.elapsedTime*.5)});const e=p.useMemo(()=>{const n=[];for(let s=0;s<100;s++){const i=s*.2;n.push(new Pt(Math.sin(i),s*.1-5,Math.cos(i))),n.push(new Pt(Math.sin(i+Math.PI),s*.1-5,Math.cos(i+Math.PI)))}return n},[]);return a.jsxs("group",{ref:t,rotation:[0,0,Math.PI/4],children:[a.jsxs(Wn,{limit:1e3,range:1e3,children:[a.jsx("primitive",{object:new Ht().setFromPoints(e)}),a.jsx(Kn,{transparent:!0,vertexColors:!0,size:.15,sizeAttenuation:!0,depthWrite:!1,color:"#00ff88"})]}),a.jsx(Me,{radius:50,count:1e3,factor:2,fade:!0,speed:.2})]})},lo=()=>a.jsxs("group",{children:[a.jsx(vt,{count:300,scale:[20,10,0],size:4,speed:2,opacity:.5,color:"#00ff00",noise:1}),a.jsxs(We,{speed:5,rotationIntensity:0,floatIntensity:0,children:[a.jsx(Zt,{args:[.1,20,.1],position:[-5,0,-5],children:a.jsx("meshBasicMaterial",{color:"#003300",transparent:!0,opacity:.5})}),a.jsx(Zt,{args:[.1,20,.1],position:[5,0,-5],children:a.jsx("meshBasicMaterial",{color:"#003300",transparent:!0,opacity:.5})})]})]}),co=()=>a.jsxs("group",{children:[a.jsx(Me,{radius:30,count:200,factor:6,fade:!0,speed:.5,color:"#4488ff"}),a.jsxs("group",{position:[0,0,-5],children:[[...Array(5)].map((t,e)=>a.jsx(We,{speed:1,rotationIntensity:1,floatIntensity:2,position:[Math.random()*10-5,Math.random()*6-3,Math.random()*5-5],children:a.jsx(et,{args:[.2,0],children:a.jsx("meshBasicMaterial",{color:"#4488ff",wireframe:!0})})},e)),a.jsx(vt,{count:50,scale:15,size:2,speed:.2,opacity:.3,color:"#4488ff"})]})]}),uo=()=>{const t=p.useMemo(()=>{const n=[];for(let s=0;s<50;s++)for(let i=0;i<50;i++)n.push(new Pt((s-25)*.5,0,(i-25)*.5));return n},[]),e=p.useRef();return Oe(n=>{if(!e.current)return;const s=e.current.geometry.attributes.position.array,i=n.clock.elapsedTime;for(let r=0;r<s.length;r+=3){const o=s[r],l=s[r+2];s[r+1]=Math.sin(o*.5+i)*Math.cos(l*.5+i)*1.5}e.current.geometry.attributes.position.needsUpdate=!0}),a.jsx("group",{rotation:[Math.PI/6,0,0],position:[0,-2,-5],children:a.jsxs(Wn,{ref:e,limit:2500,range:2500,children:[a.jsx("primitive",{object:new Ht().setFromPoints(t)}),a.jsx(Kn,{transparent:!0,size:.1,color:"#ff00aa"})]})})},ho=()=>{const t=p.useRef(),e=p.useRef(),n=p.useRef();return Oe(s=>{const i=s.clock.elapsedTime;t.current&&t.current.rotation.set(i*.2,i*.3,0),e.current&&e.current.rotation.set(i*.3,0,i*.2),n.current&&n.current.rotation.set(0,i*.2,i*.4)}),a.jsxs("group",{children:[a.jsx(oi,{args:[.5,32,32],children:a.jsx("meshStandardMaterial",{color:"#ff3366",emissive:"#aa0033",emissiveIntensity:2})}),a.jsx("group",{ref:t,children:a.jsx(wt,{args:[3,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx("group",{ref:e,children:a.jsx(wt,{args:[4,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx("group",{ref:n,children:a.jsx(wt,{args:[5,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx(Me,{radius:50,count:500,factor:2,fade:!0})]})},fo=({forcedTheme:t=null})=>{const{t:e}=_e(),{backgroundScene:n}=yt(),s=p.useMemo(()=>({space:{name:e("themes.space.name"),icon:Yn,component:to,desc:e("themes.space.desc"),color:"text-purple-400",bg:"bg-purple-500/20"},grid:{name:e("themes.grid.name"),icon:Qn,component:no,desc:e("themes.grid.desc"),color:"text-pink-400",bg:"bg-pink-500/20"},embers:{name:e("themes.embers.name"),icon:es,component:so,desc:e("themes.embers.desc"),color:"text-orange-400",bg:"bg-orange-500/20"},crystal:{name:e("themes.crystal.name"),icon:ts,component:io,desc:e("themes.crystal.desc"),color:"text-cyan-400",bg:"bg-cyan-500/20"},clouds:{name:e("themes.clouds.name"),icon:ns,component:ao,desc:e("themes.clouds.desc"),color:"text-sky-300",bg:"bg-sky-500/20"},cyber:{name:e("themes.cyber.name"),icon:ss,component:ro,desc:e("themes.cyber.desc"),color:"text-cyan-500",bg:"bg-cyan-500/20"},dna:{name:e("themes.dna.name"),icon:is,component:oo,desc:e("themes.dna.desc"),color:"text-green-500",bg:"bg-green-500/20"},binary:{name:e("themes.binary.name"),icon:as,component:lo,desc:e("themes.binary.desc"),color:"text-green-300",bg:"bg-green-500/20"},network:{name:e("themes.network.name"),icon:rs,component:co,desc:e("themes.network.desc"),color:"text-blue-500",bg:"bg-blue-500/20"},wave:{name:e("themes.wave.name"),icon:os,component:uo,desc:e("themes.wave.desc"),color:"text-pink-500",bg:"bg-pink-500/20"},orbit:{name:e("themes.orbit.name"),icon:ls,component:ho,desc:e("themes.orbit.desc"),color:"text-rose-400",bg:"bg-rose-500/20"}}),[e]),r=(s[t||n]||s.space).component,[o,l]=p.useState(1.5),[c,u]=p.useState(!0);return a.jsx(a.Fragment,{children:a.jsx("div",{className:"fixed inset-0 -z-10 bg-black",children:a.jsxs(ai,{dpr:o,camera:{position:[0,0,10],fov:60},gl:{antialias:!1,powerPreference:"high-performance"},children:[a.jsx(ri,{onDecline:()=>{l(1),u(!1)},onIncline:()=>{l(1.5),u(!0)}}),a.jsxs(p.Suspense,{fallback:null,children:[a.jsx(r,{}),c&&a.jsxs(Zr,{disableNormalPass:!0,children:[a.jsx(Yr,{luminanceThreshold:.5,mipmapBlur:!0,intensity:.8,radius:.4}),a.jsx(Qr,{opacity:.02}),a.jsx(eo,{offset:.5,darkness:.5})]})]})]})})})},po=({isPlaying:t})=>a.jsx("div",{className:"flex items-end justify-center gap-1 h-8 w-full mb-2 opacity-50",children:[...Array(20)].map((e,n)=>a.jsx(U.div,{className:"w-1 bg-gradient-to-t from-cyan-500 to-blue-600 rounded-t-full",animate:{height:t?[4,Math.random()*24+4,4]:4},transition:{duration:.4,repeat:1/0,repeatType:"reverse",delay:n*.05,ease:"easeInOut"}},n))}),mo=()=>{const{currentTrack:t,isPlaying:e,togglePlay:n,nextTrack:s,prevTrack:i,audioRef:r,isMiniPlayerVisible:o,setIsMiniPlayerVisible:l}=Ni(),[c,u]=p.useState(0),[h,d]=p.useState(0),g=xt();p.useEffect(()=>{const y=r.current,w=()=>{u(y.currentTime),d(y.duration||0)};return y.addEventListener("timeupdate",w),y.addEventListener("loadedmetadata",w),()=>{y.removeEventListener("timeupdate",w),y.removeEventListener("loadedmetadata",w)}},[r]);const f=y=>{if(!y)return"0:00";const w=Math.floor(y/60),S=Math.floor(y%60);return`${w}:${S<10?"0":""}${S}`},m=y=>{const w=parseFloat(y.target.value);r.current.currentTime=w,u(w)},[x,v]=p.useState(!1);return p.useEffect(()=>{const y=()=>v(window.innerWidth<768);return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[]),!t||!o||!x&&g.pathname==="/music"?null:x?a.jsx(U.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-[calc(5rem+env(safe-area-inset-bottom))] left-4 right-4 z-[90] pointer-events-none",children:a.jsxs("div",{className:"bg-[#1a1a1a]/90 backdrop-blur-xl border border-white/10 rounded-2xl p-3 flex items-center justify-between shadow-2xl pointer-events-auto",children:[a.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[a.jsxs("div",{className:"relative w-10 h-10 rounded-full border border-white/10 overflow-hidden shrink-0 animate-[spin_4s_linear_infinite]",style:{animationPlayState:e?"running":"paused"},children:[a.jsx("img",{src:t.cover,alt:t.title,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-1.5 h-1.5 bg-black rounded-full border border-white/20"})})]}),a.jsxs("div",{className:"flex flex-col overflow-hidden",children:[a.jsx("span",{className:"text-white font-bold text-sm truncate",children:t.title}),a.jsx("span",{className:"text-cyan-400 text-xs truncate",children:t.artist})]})]}),a.jsxs("div",{className:"flex items-center gap-3 shrink-0 pl-2",children:[a.jsx("button",{onClick:y=>{y.stopPropagation(),n()},className:"p-2 bg-white text-black rounded-full hover:scale-105 transition-transform",children:e?a.jsx(tn,{size:16,fill:"currentColor"}):a.jsx(nn,{size:16,fill:"currentColor",className:"ml-0.5"})}),a.jsx("button",{onClick:y=>{y.stopPropagation(),s()},className:"p-2 text-white/70 hover:text-white transition-colors",children:a.jsx(sn,{size:20})}),a.jsx("button",{onClick:y=>{y.stopPropagation(),l(!1)},className:"p-2 text-white/70 hover:text-white transition-colors",children:a.jsx(de,{size:20})})]})]})}):a.jsx(U.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},drag:!0,dragMomentum:!1,whileDrag:{scale:1.05,cursor:"grabbing"},className:"fixed bottom-4 right-4 z-[80] w-auto max-w-md cursor-grab active:cursor-grabbing",children:a.jsxs("div",{className:"bg-[#0a0a0a]/90 backdrop-blur-3xl border border-white/10 rounded-3xl p-4 shadow-2xl flex flex-col relative overflow-hidden ring-1 ring-white/5",children:[a.jsx("div",{className:"absolute bottom-0 left-0 w-full h-32 opacity-10 pointer-events-none z-0 mask-image-gradient-to-t",children:a.jsx(po,{isPlaying:e})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[a.jsx("div",{className:"w-1 h-8 bg-white/10 rounded-full cursor-grab active:cursor-grabbing hover:bg-white/20 transition-colors"}),a.jsxs("div",{className:"w-12 h-12 rounded-xl overflow-hidden flex-shrink-0 relative group shadow-lg",children:[a.jsx("img",{src:t.cover,alt:t.title,className:`w-full h-full object-cover ${e?"animate-[spin_4s_linear_infinite]":""}`}),a.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(Be,{size:16,className:"text-white"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"truncate pr-2",children:[a.jsx("h4",{className:"font-bold text-white text-sm truncate leading-tight",children:t.title}),a.jsx("p",{className:"text-[10px] text-gray-400 truncate uppercase tracking-wider",children:t.artist})]}),a.jsx("button",{onClick:()=>l(!1),className:"p-1.5 -mr-1 text-gray-400 hover:text-white hover:bg-white/10 rounded-full active:scale-95 transition-all",children:a.jsx(de,{size:16})})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-[9px] text-gray-500 font-mono w-6 text-right",children:f(c)}),a.jsx("input",{type:"range",min:"0",max:h||100,value:c,onChange:m,className:"flex-1 h-0.5 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-2 [&::-webkit-slider-thumb]:h-2 [&::-webkit-slider-thumb]:bg-cyan-500 [&::-webkit-slider-thumb]:rounded-full hover:[&::-webkit-slider-thumb]:scale-125 transition-all"}),a.jsx("span",{className:"text-[9px] text-gray-500 font-mono w-6",children:f(h)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-full text-white transition-colors",children:a.jsx(yi,{size:18})}),a.jsx("button",{onClick:n,className:"p-3 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-400 hover:to-blue-400 text-white rounded-full transition-all hover:scale-105 shadow-[0_0_15px_rgba(6,182,212,0.5)]",children:e?a.jsx(tn,{size:20,fill:"currentColor"}):a.jsx(nn,{size:20,fill:"currentColor",className:"ml-0.5"})}),a.jsx("button",{onClick:s,className:"p-2 hover:bg-white/10 rounded-full text-white transition-colors",children:a.jsx(sn,{size:18})})]})]})]})})},go=()=>{const[t,e]=p.useState(!1);p.useEffect(()=>{const s=()=>{window.pageYOffset>300?e(!0):e(!1)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]);const n=()=>{window.scrollTo({top:0,behavior:"smooth"})};return a.jsx(re,{children:t&&a.jsx(U.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed bottom-40 right-6 z-40 md:bottom-12 md:right-8",children:a.jsx("button",{onClick:n,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg transition-colors border border-white/20 backdrop-blur-md",title:"Scroll to Top",children:a.jsx(bi,{size:24})})})})},xo=()=>{const[t,e]=p.useState({x:0,y:0}),[n,s]=p.useState(!1);return p.useEffect(()=>{const i=u=>{e({x:u.clientX,y:u.clientY})},r=()=>s(!0),o=()=>s(!1);window.addEventListener("mousemove",i);const l=document.querySelectorAll("a, button, input, textarea, .cursor-pointer");l.forEach(u=>{u.addEventListener("mouseenter",r),u.addEventListener("mouseleave",o)});const c=new MutationObserver(()=>{document.querySelectorAll("a, button, input, textarea, .cursor-pointer").forEach(h=>{h.removeEventListener("mouseenter",r),h.removeEventListener("mouseleave",o),h.addEventListener("mouseenter",r),h.addEventListener("mouseleave",o)})});return c.observe(document.body,{childList:!0,subtree:!0}),document.body.style.cursor="none",()=>{window.removeEventListener("mousemove",i),l.forEach(u=>{u.removeEventListener("mouseenter",r),u.removeEventListener("mouseleave",o)}),c.disconnect(),document.body.style.cursor="auto"}},[]),a.jsxs(a.Fragment,{children:[a.jsx(U.div,{className:"fixed top-0 left-0 w-3 h-3 bg-white rounded-full pointer-events-none z-[9999] mix-blend-difference",animate:{x:t.x-6,y:t.y-6,scale:n?0:1,opacity:n?0:1},transition:{type:"spring",stiffness:1e3,damping:50,mass:.1}}),a.jsx(U.div,{className:"fixed top-0 left-0 w-8 h-8 border border-white rounded-full pointer-events-none z-[9998] mix-blend-difference",animate:{x:t.x-16,y:t.y-16,scale:n?2.5:1,backgroundColor:n?"rgba(255, 255, 255, 1)":"rgba(255, 255, 255, 0)",borderWidth:n?"0px":"1px",mixBlendMode:"difference"},transition:{type:"spring",stiffness:300,damping:25,mass:.5}})]})},vo=()=>{const{scrollYProgress:t}=Ds();return a.jsx(U.div,{className:"fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 origin-left z-[100]",style:{scaleX:t}})},yo=()=>{const[t,e]=p.useState(null),[n,s]=p.useState(!1);p.useEffect(()=>{const r=o=>{o.preventDefault(),e(o),s(!0)};return window.addEventListener("beforeinstallprompt",r),()=>{window.removeEventListener("beforeinstallprompt",r)}},[]);const i=async()=>{if(!t)return;t.prompt();const{outcome:r}=await t.userChoice;e(null),s(!1)};return a.jsx(re,{children:n&&a.jsxs(U.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-6 right-6 z-[100] flex items-center gap-4 bg-[#111] border border-white/10 p-4 rounded-2xl shadow-2xl max-w-sm",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 p-3 rounded-xl",children:a.jsx(wi,{size:24,className:"text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-bold text-white text-sm",children:"Install App"}),a.jsx("p",{className:"text-xs text-gray-400",children:"Install our app for a better experience"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>s(!1),className:"p-2 text-gray-400 hover:text-white transition-colors",children:a.jsx(de,{size:18})}),a.jsx("button",{onClick:i,className:"px-4 py-2 bg-white text-black text-xs font-bold rounded-lg hover:bg-gray-200 transition-colors",children:"Install"})]})]})})},bo=()=>{const{t}=_e(),[e,n]=p.useState(!1);$e(e,()=>n(!1));const[s,i]=p.useState(""),[r,o]=p.useState([]),[l,c]=p.useState(0),[u,h]=p.useState(!1),d=p.useRef(null),g=As();p.useEffect(()=>{const v=w=>{(w.metaKey||w.ctrlKey)&&w.key==="k"&&(w.preventDefault(),n(S=>!S)),w.key==="Escape"&&n(!1)},y=()=>n(!0);return window.addEventListener("keydown",v),window.addEventListener("open-search-palette",y),()=>{window.removeEventListener("keydown",v),window.removeEventListener("open-search-palette",y)}},[]),p.useEffect(()=>{e?setTimeout(()=>{var v;return(v=d.current)==null?void 0:v.focus()},100):(i(""),o([]))},[e]),p.useEffect(()=>{const v=setTimeout(()=>{s.length>=2?(h(!0),B.get(`/search?q=${s}`).then(y=>{o(y.data),c(0),h(!1)}).catch(y=>{console.error(y),h(!1)})):o([])},300);return()=>clearTimeout(v)},[s]);const f=v=>{v.key==="ArrowDown"?(v.preventDefault(),c(y=>(y+1)%r.length)):v.key==="ArrowUp"?(v.preventDefault(),c(y=>(y-1+r.length)%r.length)):v.key==="Enter"&&(v.preventDefault(),r[l]&&m(r[l]))},m=v=>{g(`${v.link}?id=${v.id}`),n(!1)},x=v=>{switch(v){case"photo":return a.jsx(lt,{size:16,className:"text-purple-400"});case"music":return a.jsx(Be,{size:16,className:"text-pink-400"});case"video":return a.jsx(ct,{size:16,className:"text-blue-400"});case"article":return a.jsx(ut,{size:16,className:"text-yellow-400"});case"event":return a.jsx(dt,{size:16,className:"text-green-400"});default:return a.jsx(Ue,{size:16})}};return a.jsx(re,{children:e&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center md:pt-[20vh] md:px-4",children:[a.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>n(!1),className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(U.div,{initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{duration:.2},className:"relative w-full h-[100dvh] md:h-auto md:max-w-2xl bg-[#1a1a1a] border-0 md:border md:border-white/10 rounded-none md:rounded-xl shadow-2xl overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-white/10 shrink-0 mt-[env(safe-area-inset-top)] md:mt-0",children:[a.jsx(Ue,{className:"text-gray-400",size:20}),a.jsx("input",{ref:d,type:"text",value:s,onChange:v=>i(v.target.value),onKeyDown:f,placeholder:t("search.placeholder"),className:"flex-1 bg-transparent text-white placeholder-gray-500 focus:outline-none text-lg"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("kbd",{className:"hidden md:inline-flex items-center gap-1 px-2 py-1 bg-white/5 rounded text-xs text-gray-400 font-mono",children:a.jsx("span",{className:"text-xs",children:"ESC"})}),a.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-white p-2",children:a.jsx(de,{size:20})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 pb-[env(safe-area-inset-bottom)]",children:u?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Searching..."}):r.length>0?a.jsx("div",{className:"space-y-1",children:r.map((v,y)=>a.jsxs(U.button,{layout:!0,onClick:()=>m(v),onMouseEnter:()=>c(y),className:`w-full flex items-center gap-4 px-4 py-3 rounded-lg transition-colors ${y===l?"bg-white/10":"hover:bg-white/5"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded bg-black/50 overflow-hidden flex-shrink-0 border border-white/10",children:v.image?a.jsx("img",{src:v.image,alt:"",className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:x(v.type)})}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("h4",{className:`text-sm font-medium ${y===l?"text-white":"text-gray-300"}`,children:v.title}),a.jsx("span",{className:"text-xs text-gray-500 capitalize",children:v.type})]}),y===l&&a.jsx(Jn,{size:16,className:"text-gray-400"})]},`${v.type}-${v.id}`))}):s.length>=2?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:['No results found for "',s,'"']}):a.jsxs("div",{className:"p-12 text-center text-gray-500",children:[a.jsx(Si,{className:"mx-auto mb-4 opacity-20",size:48}),a.jsx("p",{children:"Type to search photos, music, videos, and more..."})]})}),a.jsxs("div",{className:"bg-black/20 px-4 py-2 border-t border-white/5 text-xs text-gray-500 flex justify-between",children:[a.jsx("span",{children:"Pro tip: Use arrow keys to navigate"}),a.jsx("span",{children:"Lumos Search"})]})]})]})})},wo=()=>{const{t}=_e(),e=xt(),{user:n}=Ke(),[s,i]=p.useState(!1),[r,o]=p.useState(!1);$e(s,()=>i(!1)),$e(r,()=>o(!1));const l=[{key:"home",path:"/",icon:ji},{key:"events",path:"/events",icon:dt},{key:"menu",action:"menu",icon:Ci},{key:"about",path:"/about",icon:_i}],c=[{key:"gallery",path:"/gallery",icon:lt},{key:"music",path:"/music",icon:Be},{key:"videos",path:"/videos",icon:ct},{key:"articles",path:"/articles",icon:ut}],u=d=>{navigator.vibrate&&navigator.vibrate(10),d==="menu"?i(!0):d==="login"?o(!0):d==="profile"&&window.dispatchEvent(new Event("open-profile-modal"))},h=()=>{navigator.vibrate&&navigator.vibrate(10),i(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-[90] bg-black/90 backdrop-blur-xl border-t border-white/10 pb-[env(safe-area-inset-bottom)] md:hidden app-select-none",children:a.jsx("div",{className:"flex justify-around items-center h-16 px-2",children:l.map(d=>{const g=e.pathname===d.path,f=d.icon;return d.action?a.jsx("button",{onClick:()=>u(d.action),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${s&&d.action==="menu"?"text-indigo-400":"text-gray-400 hover:text-white"}`,children:a.jsxs(U.div,{whileTap:{scale:.9},className:"flex flex-col items-center gap-1",children:[a.jsx(f,{size:20}),a.jsx("span",{className:"text-[10px] font-medium",children:d.key==="menu"?"社区":d.key==="about"?"关于":t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))})]})},d.key):a.jsx(st,{to:d.path,onClick:h,className:`flex flex-col items-center justify-center w-full h-full transition-colors ${g&&!s?"text-indigo-400":"text-gray-400 hover:text-white"}`,children:a.jsxs(U.div,{whileTap:{scale:.9},className:"flex flex-col items-center gap-1",children:[a.jsx(f,{size:20,strokeWidth:g&&!s?2.5:2}),a.jsx("span",{className:"text-[10px] font-medium",children:t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))}),g&&!s&&a.jsx(U.div,{layoutId:"activeTab",className:"absolute bottom-1 w-1 h-1 bg-indigo-400 rounded-full"})]})},d.key)})})}),a.jsx(re,{children:s&&a.jsxs(U.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},drag:"y",dragConstraints:{top:0},dragElastic:.1,onDragEnd:(d,g)=>{g.offset.y>100&&i(!1)},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[100] bg-[#0a0a0a] md:hidden flex flex-col touch-none",children:[a.jsx("div",{className:"w-full flex justify-center pt-3 pb-1",onClick:()=>i(!1),children:a.jsx("div",{className:"w-12 h-1.5 bg-white/20 rounded-full"})}),a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10 bg-black/50 backdrop-blur-md",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:t("nav.more","Menu")}),a.jsx("button",{onClick:()=>i(!1),className:"p-2 bg-white/10 rounded-full text-white hover:bg-white/20",children:a.jsx(de,{size:24})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.map(d=>d.action?a.jsxs("button",{onClick:()=>{i(!1),u(d.action)},className:"flex flex-col items-center justify-center gap-2 p-4 bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition-colors h-24 active:scale-95 touch-manipulation",children:[a.jsx(d.icon,{size:24,className:"text-indigo-400"}),a.jsx("span",{className:"font-medium text-white text-xs",children:d.key==="login"?t("auth.log_in"):d.key==="profile"?t("user_profile.title"):t(`nav.${d.key}`,d.key)})]},d.key):a.jsxs(st,{to:d.path,replace:!0,onClick:h,className:"flex flex-col items-center justify-center gap-2 p-4 bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition-colors h-24 active:scale-95 touch-manipulation",children:[a.jsx(d.icon,{size:24,className:"text-indigo-400"}),a.jsx("span",{className:"font-medium text-white text-xs",children:t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))})]},d.key))})})]})}),a.jsx(js,{isOpen:r,onClose:()=>o(!1)})]})},So=p.lazy(()=>se(()=>import("./Hero-CDI0wvTv.js"),__vite__mapDeps([0,1,2,3,4]))),jo=p.lazy(()=>se(()=>import("./Gallery-CmGTIS8R.js"),__vite__mapDeps([5,1,2,6,7,8,3,4]))),Co=p.lazy(()=>se(()=>import("./Music-BhfX1ECh.js"),__vite__mapDeps([9,1,7,2,6,3,4]))),_o=p.lazy(()=>se(()=>import("./Videos-BIt8DV1d.js"),__vite__mapDeps([10,1,7,2,6,3,4]))),Eo=p.lazy(()=>se(()=>import("./Articles-BskP2nIc.js"),__vite__mapDeps([11,1,6,2,7,8,3,4]))),No=p.lazy(()=>se(()=>import("./Events-CB0wXrOA.js"),__vite__mapDeps([12,1,7,2,6,3,4]))),To=p.lazy(()=>se(()=>import("./HomeCategories-5YaRZN-V.js"),__vite__mapDeps([13,1,2,3,4]))),Ts=p.lazy(()=>se(()=>import("./About-B4hrRpC1.js"),__vite__mapDeps([14,1,2,3,4]))),ko=p.lazy(()=>se(()=>import("./AdminDashboard-CJ_w9TJE.js"),__vite__mapDeps([15,1,2,7,3,4]))),Ro=p.lazy(()=>se(()=>import("./NotFound-BxedmCRO.js"),__vite__mapDeps([16,1,2,3,4]))),Po=()=>a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black text-white",children:a.jsx(Zn,{className:"animate-spin",size:48})}),zo=()=>a.jsxs(a.Fragment,{children:[a.jsx(So,{}),a.jsx(To,{}),a.jsx(Ts,{})]}),Oo=()=>{const e=xt().pathname.startsWith("/admin"),{cursorEnabled:n,settings:s}=yt();return te.useEffect(()=>{s!=null&&s.site_title&&(document.title=s.site_title)},[s==null?void 0:s.site_title]),a.jsxs(a.Fragment,{children:[!e&&a.jsx(Re,{variant:"inline",silent:!0,children:a.jsx(ka,{})}),!e&&a.jsx(Re,{variant:"inline",silent:!0,children:a.jsx(fo,{})}),!e&&n&&a.jsx("div",{className:"hidden md:block",children:a.jsx(xo,{})}),!e&&a.jsx(vo,{}),a.jsx(Re,{variant:"inline",silent:!0,children:a.jsx(bo,{})}),a.jsx("main",{className:"pb-[calc(4rem+env(safe-area-inset-bottom))] md:pb-0",children:a.jsx(p.Suspense,{fallback:a.jsx(Po,{}),children:a.jsxs(Fs,{children:[a.jsx(ce,{path:"/",element:a.jsx(zo,{})}),a.jsx(ce,{path:"/gallery",element:a.jsx(jo,{})}),a.jsx(ce,{path:"/music",element:a.jsx(Co,{})}),a.jsx(ce,{path:"/videos",element:a.jsx(_o,{})}),a.jsx(ce,{path:"/articles",element:a.jsx(Eo,{})}),a.jsx(ce,{path:"/events",element:a.jsx(No,{})}),a.jsx(ce,{path:"/about",element:a.jsx(Ts,{})}),a.jsx(ce,{path:"/admin",element:a.jsx(ko,{})}),a.jsx(ce,{path:"*",element:a.jsx(Ro,{})})]})})}),!e&&a.jsx(Re,{variant:"inline",silent:!0,children:a.jsx(mo,{})}),!e&&a.jsx(wo,{}),a.jsx(go,{}),a.jsx(yo,{})]})},Mo=()=>a.jsx($i,{children:a.jsx(Re,{children:a.jsx(Ri,{children:a.jsx(ki,{children:a.jsx(Ti,{children:a.jsxs(Bs,{children:[a.jsx(Oo,{}),a.jsx(Ei,{position:"bottom-right",toastOptions:{style:{background:"#333",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}}})]})})})})})}),{slice:Lo,forEach:Io}=[];function Uo(t){return Io.call(Lo.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function Do(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const Rn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Ao=function(t,e){const s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(e);let r=`${t}=${i}`;if(s.maxAge>0){const o=s.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(o)}`}if(s.domain){if(!Rn.test(s.domain))throw new TypeError("option domain is invalid");r+=`; Domain=${s.domain}`}if(s.path){if(!Rn.test(s.path))throw new TypeError("option path is invalid");r+=`; Path=${s.path}`}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");r+=`; Expires=${s.expires.toUTCString()}`}if(s.httpOnly&&(r+="; HttpOnly"),s.secure&&(r+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s.partitioned&&(r+="; Partitioned"),r},Pn={create(t,e,n,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+n*60*1e3)),s&&(i.domain=s),document.cookie=Ao(t,e,i)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let s=0;s<n.length;s++){let i=n[s];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return i.substring(e.length,i.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var Bo={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return Pn.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:s,cookieDomain:i,cookieOptions:r}=e;n&&typeof document<"u"&&Pn.create(n,t,s,i,r)}},Fo={name:"querystring",lookup(t){var s;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&((s=window.location.hash)==null?void 0:s.indexOf("?"))>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const o=i.substring(1).split("&");for(let l=0;l<o.length;l++){const c=o[l].indexOf("=");c>0&&o[l].substring(0,c)===e&&(n=o[l].substring(c+1))}}return n}},Ho={name:"hash",lookup(t){var i;let{lookupHash:e,lookupFromHashIndex:n}=t,s;if(typeof window<"u"){const{hash:r}=window.location;if(r&&r.length>2){const o=r.substring(1);if(e){const l=o.split("&");for(let c=0;c<l.length;c++){const u=l[c].indexOf("=");u>0&&l[c].substring(0,u)===e&&(s=l[c].substring(u+1))}}if(s)return s;if(!s&&n>-1){const l=r.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(i=l[typeof n=="number"?n:0])==null?void 0:i.replace("/",""):void 0}}}return s}};let Te=null;const zn=()=>{if(Te!==null)return Te;try{if(Te=typeof window<"u"&&window.localStorage!==null,!Te)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Te=!1}return Te};var $o={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&zn())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&zn()&&window.localStorage.setItem(n,t)}};let ke=null;const On=()=>{if(ke!==null)return ke;try{if(ke=typeof window<"u"&&window.sessionStorage!==null,!ke)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{ke=!1}return ke};var Go={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&On())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&On()&&window.sessionStorage.setItem(n,t)}},Vo={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:s,language:i}=navigator;if(n)for(let r=0;r<n.length;r++)e.push(n[r]);s&&e.push(s),i&&e.push(i)}return e.length>0?e:void 0}},Wo={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const s=e||(typeof document<"u"?document.documentElement:null);return s&&typeof s.getAttribute=="function"&&(n=s.getAttribute("lang")),n}},Ko={name:"path",lookup(t){var i;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(i=n[typeof e=="number"?e:0])==null?void 0:i.replace("/",""):void 0}},qo={name:"subdomain",lookup(t){var i,r;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,s=typeof window<"u"&&((r=(i=window.location)==null?void 0:i.hostname)==null?void 0:r.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(s)return s[n]}};let ks=!1;try{document.cookie,ks=!0}catch{}const Rs=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];ks||Rs.splice(1,1);const Xo=()=>({order:Rs,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class Ps{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=Uo(n,this.options||{},Xo()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(Bo),this.addDetector(Fo),this.addDetector($o),this.addDetector(Go),this.addDetector(Vo),this.addDetector(Wo),this.addDetector(Ko),this.addDetector(qo),this.addDetector(Ho)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(s=>{if(this.detectors[s]){let i=this.detectors[s].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(n=n.concat(i))}}),n=n.filter(s=>s!=null&&!Do(s)).map(s=>this.options.convertDetectedLanguage(s)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(s=>{this.detectors[s]&&this.detectors[s].cacheUserLanguage(e,this.options)}))}}Ps.type="languageDetector";function Dt(t){"@babel/helpers - typeof";return Dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dt(t)}function zs(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":Dt(XMLHttpRequest))==="object"}function Zo(t){return!!t&&typeof t.then=="function"}function Jo(t){return Zo(t)?t:Promise.resolve(t)}function Mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function Ln(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Mn(Object(n),!0).forEach(function(s){Yo(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Yo(t,e,n){return(e=Qo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qo(t){var e=el(t,"string");return je(e)=="symbol"?e:e+""}function el(t,e){if(je(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(je(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function je(t){"@babel/helpers - typeof";return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(t)}var pe=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?pe=global.fetch:typeof window<"u"&&window.fetch&&(pe=window.fetch);var Ve;zs()&&(typeof global<"u"&&global.XMLHttpRequest?Ve=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Ve=window.XMLHttpRequest));var gt;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?gt=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(gt=window.ActiveXObject));typeof pe!="function"&&(pe=void 0);if(!pe&&!Ve&&!gt)try{se(()=>import("./browser-ponyfill-DUDQbm29.js").then(t=>t.b),__vite__mapDeps([17,1])).then(function(t){pe=t.default}).catch(function(){})}catch{}var At=function(e,n){if(n&&je(n)==="object"){var s="";for(var i in n)s+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n[i]);if(!s)return e;e=e+(e.indexOf("?")!==-1?"&":"?")+s.slice(1)}return e},In=function(e,n,s,i){var r=function(c){if(!c.ok)return s(c.statusText||"Error",{status:c.status});c.text().then(function(u){s(null,{status:c.status,data:u})}).catch(s)};if(i){var o=i(e,n);if(o instanceof Promise){o.then(r).catch(s);return}}typeof fetch=="function"?fetch(e,n).then(r).catch(s):pe(e,n).then(r).catch(s)},Un=!1,tl=function(e,n,s,i){e.queryStringParams&&(n=At(n,e.queryStringParams));var r=Ln({},typeof e.customHeaders=="function"?e.customHeaders():e.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(r["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),s&&(r["Content-Type"]="application/json");var o=typeof e.requestOptions=="function"?e.requestOptions(s):e.requestOptions,l=Ln({method:s?"POST":"GET",body:s?e.stringify(s):void 0,headers:r},Un?{}:o),c=typeof e.alternateFetch=="function"&&e.alternateFetch.length>=1?e.alternateFetch:void 0;try{In(n,l,i,c)}catch(u){if(!o||Object.keys(o).length===0||!u.message||u.message.indexOf("not implemented")<0)return i(u);try{Object.keys(o).forEach(function(h){delete l[h]}),In(n,l,i,c),Un=!0}catch(h){i(h)}}},nl=function(e,n,s,i){s&&je(s)==="object"&&(s=At("",s).slice(1)),e.queryStringParams&&(n=At(n,e.queryStringParams));try{var r=Ve?new Ve:new gt("MSXML2.XMLHTTP.3.0");r.open(s?"POST":"GET",n,1),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!e.withCredentials,s&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var o=e.customHeaders;if(o=typeof o=="function"?o():o,o)for(var l in o)r.setRequestHeader(l,o[l]);r.onreadystatechange=function(){r.readyState>3&&i(r.status>=400?r.statusText:null,{status:r.status,data:r.responseText})},r.send(s)}catch(c){console&&console.log(c)}},sl=function(e,n,s,i){if(typeof s=="function"&&(i=s,s=void 0),i=i||function(){},pe&&n.indexOf("file:")!==0)return tl(e,n,s,i);if(zs()||typeof ActiveXObject=="function")return nl(e,n,s,i);i(new Error("No fetch and no xhr implementation found!"))};function Pe(t){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(t)}function Dn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Dn(Object(n),!0).forEach(function(s){Os(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function il(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function al(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,Ms(s.key),s)}}function rl(t,e,n){return e&&al(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Os(t,e,n){return(e=Ms(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ms(t){var e=ol(t,"string");return Pe(e)=="symbol"?e:e+""}function ol(t,e){if(Pe(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Pe(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ll=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(n){return JSON.parse(n)},stringify:JSON.stringify,parsePayload:function(n,s,i){return Os({},s,i||"")},parseLoadPayload:function(n,s){},request:sl,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Ls=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};il(this,t),this.services=e,this.options=n,this.allOptions=s,this.type="backend",this.init(e,n,s)}return rl(t,[{key:"init",value:function(n){var s=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=n,this.options=Rt(Rt(Rt({},ll()),this.options||{}),i),this.allOptions=r,this.services&&this.options.reloadInterval){var o=setInterval(function(){return s.reload()},this.options.reloadInterval);Pe(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(n,s,i){this._readAny(n,n,s,s,i)}},{key:"read",value:function(n,s,i){this._readAny([n],n,[s],s,i)}},{key:"_readAny",value:function(n,s,i,r,o){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(n,i)),c=Jo(c),c.then(function(u){if(!u)return o(null,{});var h=l.services.interpolator.interpolate(u,{lng:n.join("+"),ns:i.join("+")});l.loadUrl(h,o,s,r)})}},{key:"loadUrl",value:function(n,s,i,r){var o=this,l=typeof i=="string"?[i]:i,c=typeof r=="string"?[r]:r,u=this.options.parseLoadPayload(l,c);this.options.request(this.options,n,u,function(h,d){if(d&&(d.status>=500&&d.status<600||!d.status))return s("failed loading "+n+"; status code: "+d.status,!0);if(d&&d.status>=400&&d.status<500)return s("failed loading "+n+"; status code: "+d.status,!1);if(!d&&h&&h.message){var g=h.message.toLowerCase(),f=["failed","fetch","network","load"].find(function(v){return g.indexOf(v)>-1});if(f)return s("failed loading "+n+": "+h.message,!0)}if(h)return s(h,!1);var m,x;try{typeof d.data=="string"?m=o.options.parse(d.data,i,r):m=d.data}catch{x="failed parsing "+n+" to json"}if(x)return s(x,!1);s(null,m)})}},{key:"create",value:function(n,s,i,r,o){var l=this;if(this.options.addPath){typeof n=="string"&&(n=[n]);var c=this.options.parsePayload(s,i,r),u=0,h=[],d=[];n.forEach(function(g){var f=l.options.addPath;typeof l.options.addPath=="function"&&(f=l.options.addPath(g,s));var m=l.services.interpolator.interpolate(f,{lng:g,ns:s});l.options.request(l.options,m,c,function(x,v){u+=1,h.push(x),d.push(v),u===n.length&&typeof o=="function"&&o(h,d)})})}}},{key:"reload",value:function(){var n=this,s=this.services,i=s.backendConnector,r=s.languageUtils,o=s.logger,l=i.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],u=function(d){var g=r.toResolveHierarchy(d);g.forEach(function(f){c.indexOf(f)<0&&c.push(f)})};u(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(h){return u(h)}),c.forEach(function(h){n.allOptions.ns.forEach(function(d){i.read(h,d,"read",null,null,function(g,f){g&&o.warn("loading namespace ".concat(d," for language ").concat(h," failed"),g),!g&&f&&o.log("loaded namespace ".concat(d," for language ").concat(h),f),i.loaded("".concat(h,"|").concat(d),g,f)})})})}}}])}();Ls.type="backend";J.use(Ls).use(Ps).use(ba).init({fallbackLng:"zh",lng:"zh",debug:!1,interpolation:{escapeValue:!1},backend:{loadPath:"/locales/{{lng}}/translation.json"},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});function cl(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=t;let l,c;const u=async(d=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(l=await se(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{o==null||o(d)}),!l)return;l.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),l.addEventListener("installed",d=>{d.isUpdate||s==null||s()}),l.register({immediate:e}).then(d=>{r?r("/sw.js",d):i==null||i(d)}).catch(d=>{o==null||o(d)})}}return c=h(),u}function ul(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=t,[l,c]=p.useState(!1),[u,h]=p.useState(!1),[d]=p.useState(()=>cl({immediate:e,onOfflineReady(){h(!0),s==null||s()},onNeedRefresh(){c(!0),n==null||n()},onRegistered:i,onRegisteredSW:r,onRegisterError:o}));return{needRefresh:[l,c],offlineReady:[u,h],updateServiceWorker:d}}const dl=()=>(ul({onRegisteredSW(){},onNeedRefresh(){},onOfflineReady(){}}),null);li.createRoot(document.getElementById("root")).render(a.jsx(te.StrictMode,{children:a.jsx(Re,{children:a.jsx(te.Suspense,{fallback:a.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center text-white",children:"加载中..."}),children:a.jsxs(a.Fragment,{children:[a.jsx(Mo,{}),a.jsx(dl,{})]})})})}));export{Sn as D,Na as F,yt as a,Ke as b,$e as c,B as d,Ni as e,xl as f,_e as u};
