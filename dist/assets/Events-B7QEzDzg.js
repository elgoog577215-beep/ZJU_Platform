import{a as l,j as e,i as re,m as S,A as ce}from"./react-vendor-CXoD4tGQ.js";import{S as de,P as me,U as xe}from"./SortSelector-D76W0eRq.js";import{u as K,a as ge,c as he,d as h,D as ue,F as M}from"./index-D24czYHj.js";import{e as pe,S as be,aj as fe,ah as we,h as V,l as I,G as ve,A as F,d as R,X as je,c as Ne,ak as G,al as ye,a0 as ke,a9 as Se,am as C}from"./ui-vendor-ChojsKpE.js";import{S as B}from"./SmartImage-NGZcafy_.js";import"./TagInput-gN0k0_Qy.js";import"./three-vendor-CkDWRuyZ.js";import"./utils-Cv9gmu_1.js";const Ce=({targetDate:i})=>{const{t:f}=K(),[x,w]=l.useState(u());function u(){const n=+new Date(i)-+new Date;let p={};return n>0&&(p={days:Math.floor(n/(1e3*60*60*24)),hours:Math.floor(n/(1e3*60*60)%24),minutes:Math.floor(n/1e3/60%60),seconds:Math.floor(n/1e3%60)}),p}return l.useEffect(()=>{const n=setInterval(()=>{w(u())},1e3);return()=>clearInterval(n)},[i]),Object.keys(x).length===0?null:e.jsx("div",{className:"flex gap-4 mb-6",children:Object.keys(x).map(n=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/5 border border-white/10 rounded-xl flex items-center justify-center text-2xl font-bold text-white shadow-lg backdrop-blur-md",children:x[n]}),e.jsx("span",{className:"text-xs text-gray-500 uppercase mt-2 font-bold tracking-wider",children:f(`events.countdown.${n}`)})]},n))})},Ue=()=>{const{t:i}=K(),{settings:f}=ge(),{user:x}=he(),[w]=re(),[u,n]=l.useState([]),[p,E]=l.useState(!0),[Q,Ee]=l.useState(!1),[ze,Y]=l.useState(0),[v,q]=l.useState(1),[H,L]=l.useState(1),[s,g]=l.useState(null),[X,P]=l.useState(!1),[z,Z]=l.useState("newest"),[$,J]=l.useState(""),[j,W]=l.useState("all");l.useEffect(()=>{const t=w.get("id");t&&h.get(`/events/${t}`).then(a=>{a.data&&g(a.data)}).catch(a=>console.error("Failed to fetch deep linked event",a))},[w]);const[T,A]=l.useState(!1),[U,O]=l.useState(!1);l.useEffect(()=>{E(!0);const t=f.pagination_enabled==="true"?6:1e3,a={page:v,limit:t,sort:z,search:$,lifecycle:j==="all"?void 0:j};h.get("/events",{params:a}).then(o=>{o.data&&Array.isArray(o.data.data)?(n(o.data.data),L(o.data.pagination?o.data.pagination.totalPages:1)):n([]),E(!1)}).catch(o=>{console.error("Failed to fetch events:",o),n([]),E(!1)})},[v,z,$,j,f.pagination_enabled]),l.useEffect(()=>{s&&x?h.get(`/events/${s.id}/registration`).then(t=>A(t.data.registered)).catch(t=>console.error(t)):A(!1)},[s,x]);const ee=async()=>{if(!x){C.error(i("events.login_to_register"));return}O(!0);try{const t=await h.post(`/events/${s.id}/register`);A(t.data.registered),C.success(t.data.message)}catch{C.error("Registration failed")}finally{O(!1)}},te=(t,a)=>{a.stopPropagation();const o=`${window.location.origin}/events?id=${t.id}`;navigator.clipboard.writeText(o).then(()=>{C.success(i("common.link_copied")||"Link copied to clipboard!")})},se=()=>{if(!s)return;const t=encodeURIComponent(s.title),a=encodeURIComponent(s.description+`

`+s.content),o=encodeURIComponent(s.location),r=s.date.replace(/-/g,""),c=`${r}/${r}`,d=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${t}&details=${a}&location=${o}&dates=${c}`;window.open(d,"_blank")},ae=()=>{if(!s)return;const t=s.title,a=s.description,o=s.location,r=s.date.replace(/-/g,""),c=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//777//Events//EN
BEGIN:VEVENT
UID:${s.id}@777.com
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,"").split(".")[0]}Z
DTSTART;VALUE=DATE:${r}
DTEND;VALUE=DATE:${r}
SUMMARY:${t}
DESCRIPTION:${a}
LOCATION:${o}
END:VEVENT
END:VCALENDAR`,d=new Blob([c],{type:"text/calendar;charset=utf-8"}),D=window.URL.createObjectURL(d),m=document.createElement("a");m.href=D,m.setAttribute("download",`${t}.ics`),document.body.appendChild(m),m.click(),document.body.removeChild(m)},ie=t=>{h.post("/events",t).then(()=>{const o={page:v,limit:6};return h.get("/events",{params:o})}).then(a=>{n(a.data.data),L(a.data.pagination.totalPages)}).catch(a=>console.error("Failed to save event",a))},oe=t=>{ie(t)},ne=t=>{q(t),window.scrollTo({top:0,behavior:"smooth"})},b=t=>{if(!t)return i("events.status.unknown");try{const a=new Date,o=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),d=`${o}-${r}-${c}`;return t>d?i("events.status.upcoming"):i(t===d?"events.status.ongoing":"events.status.past")}catch{return i("events.status.unknown")}},_=t=>{switch(t){case i("events.status.upcoming"):return"bg-emerald-500 text-white";case i("events.status.ongoing"):return"bg-blue-500 text-white animate-pulse";case i("events.status.past"):return"bg-gray-500 text-gray-200";default:return"bg-gray-500 text-white"}},le=[{value:"all",label:i("common.all")||"All Events"},{value:"upcoming",label:i("events.status.upcoming")||"Upcoming"},{value:"ongoing",label:i("events.status.ongoing")||"Ongoing"},{value:"past",label:i("events.status.past")||"Past"}];return e.jsxs("section",{className:"pt-36 pb-32 md:py-20 px-4 md:px-8 min-h-screen",children:[e.jsxs(S.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mb-8 md:mb-12 relative z-40 md:pt-0 text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-bold font-serif mb-3 md:mb-4",children:i("events.title")}),e.jsx("p",{className:"text-gray-400 max-w-xl mx-auto text-sm md:text-base",children:i("events.subtitle")})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto justify-center md:absolute md:right-0 md:top-0",children:[e.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-4 py-2 md:px-6 md:py-3 rounded-full backdrop-blur-md border border-white/10 transition-all font-bold text-sm md:text-base shrink-0",children:[e.jsx(pe,{size:18,className:"md:w-5 md:h-5"})," ",i("common.create_event")]}),e.jsxs("div",{className:"relative flex-1 md:w-64 group max-w-xs md:max-w-none",children:[e.jsx("div",{className:"absolute inset-0 bg-white/5 rounded-full blur-sm group-focus-within:bg-indigo-500/20 transition-all duration-300 -z-10"}),e.jsx(be,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-indigo-400 transition-colors",size:16}),e.jsx("input",{type:"text",placeholder:i("common.search")||"Search...",value:$,onChange:t=>J(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded-full pl-10 pr-4 py-2.5 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-gray-500/70 shadow-inner"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 p-4 bg-white/5 rounded-2xl border border-white/10 backdrop-blur-sm",children:[e.jsx("div",{className:"w-full md:w-48",children:e.jsx(ue,{value:j,onChange:W,options:le,icon:fe,buttonClassName:"bg-black/20 border-white/10 hover:bg-black/30 w-full"})}),e.jsx("div",{className:"h-8 w-px bg-white/10 hidden md:block"}),e.jsx("div",{className:"w-full md:w-48",children:e.jsx(de,{sort:z,onSortChange:Z})})]})]}),Q?e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(we,{size:48,className:"text-red-400 mb-4 opacity-50 mx-auto"}),e.jsx("p",{className:"text-gray-300 mb-6",children:i("common.error_fetching_data")||"Failed to load events"}),e.jsx("button",{onClick:()=>Y(t=>t+1),className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all border border-white/10",children:"Retry"})]}):p?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8 max-w-7xl mx-auto",children:[1,2,3].map(t=>e.jsx("div",{className:"bg-white/5 rounded-3xl h-64 md:h-96 animate-pulse"},t))}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8 max-w-7xl mx-auto",children:u.map((t,a)=>{const o=b(t.date),r=o===i("events.status.upcoming"),c=new Date(t.date),d=c.getDate(),D=c.toLocaleString("default",{month:"short"}).toUpperCase();return e.jsxs(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1},className:"group relative bg-[#111] border border-white/10 rounded-3xl overflow-hidden hover:shadow-2xl hover:shadow-indigo-500/20 transition-all duration-500 hover:-translate-y-2 cursor-pointer",onClick:()=>g(t),children:[e.jsxs("div",{className:"h-64 overflow-hidden relative",children:[e.jsx(B,{src:t.image,alt:t.title,loading:"lazy",className:"w-full h-full",imageClassName:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#111] via-transparent to-transparent opacity-80"}),e.jsxs("div",{className:"absolute top-4 left-4 bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-3 flex flex-col items-center justify-center min-w-[60px] shadow-lg group-hover:bg-indigo-600 group-hover:border-indigo-500 transition-colors duration-300",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-gray-300 group-hover:text-white/80",children:D}),e.jsx("span",{className:"text-2xl font-black text-white",children:d})]}),e.jsxs("div",{className:`absolute top-4 right-4 px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider shadow-lg backdrop-blur-md flex items-center gap-1.5 ${_(o)}`,children:[o===i("events.status.upcoming")&&e.jsx(V,{size:12}),o===i("events.status.ongoing")&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-white animate-pulse"}),o]}),e.jsx("div",{className:"absolute bottom-4 right-4 flex gap-2",children:e.jsx(M,{itemId:t.id,itemType:"event",size:18,showCount:!1,favorited:t.favorited,className:"p-2 bg-black/40 hover:bg-indigo-600 rounded-full text-white backdrop-blur-md transition-all",onToggle:(m,N)=>{n(y=>y.map(k=>k.id===t.id?{...k,likes:N!==void 0?N:k.likes,favorited:m}:k)),s&&s.id===t.id&&g(y=>({...y,likes:N!==void 0?N:y.likes,favorited:m}))}})}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-300 backdrop-blur-sm",children:e.jsx("div",{className:"transform scale-75",children:e.jsx(Ce,{targetDate:t.date})})})]}),e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(I,{size:14,className:"text-indigo-400"}),e.jsx("span",{className:"truncate max-w-[150px]",children:t.location||"Online"})]}),t.link&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-indigo-400 bg-indigo-500/10 px-2 py-0.5 rounded-full border border-indigo-500/20",children:[e.jsx(ve,{size:10})," External"]})]}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-3 line-clamp-2 group-hover:text-indigo-400 transition-colors leading-tight",children:t.title}),e.jsx("p",{className:"text-gray-400 text-sm line-clamp-2 mb-6 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex items-center text-indigo-400 font-bold text-sm group-hover:translate-x-2 transition-transform",children:[i("common.view_details")," ",e.jsx(F,{size:16,className:"ml-2"})]})]})]},t.id)})}),!p&&u.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"bg-white/5 rounded-full p-6 inline-block mb-4",children:e.jsx(R,{size:48,className:"text-gray-600"})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No events found matching your criteria."})]}),e.jsx(me,{currentPage:v,totalPages:H,onPageChange:ne}),e.jsx(ce,{children:s&&e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>g(null),children:e.jsxs(S.div,{initial:{scale:.9,y:50,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.9,y:50,opacity:0},transition:{type:"spring",duration:.5},className:"bg-[#111] w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-3xl border border-white/10 shadow-2xl custom-scrollbar relative",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"h-72 sm:h-96 relative",children:[e.jsx(B,{src:s.image,alt:s.title,type:"event",className:"w-full h-full",imageClassName:"w-full h-full object-cover",iconSize:64}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#111] to-transparent"}),e.jsx("button",{onClick:()=>g(null),className:"absolute top-6 right-6 p-2 bg-black/40 hover:bg-black/60 text-white rounded-full backdrop-blur-md border border-white/10 transition-all z-20",children:e.jsx(je,{size:24})}),e.jsxs("div",{className:"absolute bottom-0 left-0 p-8 w-full",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${_(b(s.date))}`,children:b(s.date)}),s.tags&&s.tags.split(",").map((t,a)=>e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider bg-white/10 text-gray-300 border border-white/5",children:t.trim()},a))]}),e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsx("h2",{className:"text-3xl sm:text-5xl font-bold text-white mb-2 leading-tight",children:s.title}),e.jsx(M,{itemId:s.id,itemType:"event",size:24,showCount:!0,count:s.likes||0,favorited:s.favorited,className:"p-3 bg-white/10 hover:bg-white/20 rounded-full backdrop-blur-md transition-colors mt-1",onToggle:(t,a)=>{g(o=>({...o,likes:a!==void 0?a:o.likes,favorited:t})),n(o=>o.map(r=>r.id===s.id?{...r,likes:a!==void 0?a:r.likes,favorited:t}:r))}})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-300 text-sm sm:text-base font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:18,className:"text-indigo-400"}),s.date]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:18,className:"text-indigo-400"}),s.location||"Online"]})]})]})]}),e.jsx("div",{className:"p-8 sm:p-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12",children:[e.jsxs("div",{className:"flex-1 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ne,{size:20,className:"text-indigo-400"}),i("common.description")]}),e.jsx("div",{className:"prose prose-invert prose-lg max-w-none text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:s.content||`<p>${s.description}</p>`}})]}),s.location&&e.jsxs("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/5",children:[e.jsxs("h4",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(I,{size:18,className:"text-indigo-400"})," Location"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:s.location}),e.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.location)}`,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:text-indigo-300 text-sm font-bold flex items-center gap-1",children:["View on Google Maps ",e.jsx(G,{size:12})]})]})]}),e.jsx("div",{className:"w-full lg:w-80 space-y-6",children:e.jsxs("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/5 sticky top-8",children:[e.jsx("h4",{className:"font-bold text-white mb-6",children:"Action Center"}),e.jsxs("div",{className:"space-y-4",children:[s.link?e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-xl shadow-indigo-500/20 flex items-center justify-center gap-2 group",children:[e.jsx(G,{size:20,className:"group-hover:rotate-45 transition-transform"}),"Visit Event Link"]}):(b(s.date)===i("events.status.upcoming")||b(s.date)===i("events.status.ongoing"))&&e.jsxs("button",{onClick:ee,disabled:U,className:`w-full py-4 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${T?"bg-green-500/20 text-green-400 border border-green-500/20":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-xl shadow-indigo-500/20"}`,children:[U?e.jsx(V,{className:"animate-spin",size:20}):T?e.jsx(ye,{size:20}):e.jsx(F,{size:20}),i(T?"events.registered":"events.register")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-white/10",children:[e.jsxs("button",{onClick:se,className:"flex flex-col items-center justify-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl text-gray-400 hover:text-white transition-colors text-xs font-medium",children:[e.jsx(R,{size:20}),"Google Cal"]}),e.jsxs("button",{onClick:ae,className:"flex-col items-center justify-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl text-gray-400 hover:text-white transition-colors text-xs font-medium flex",children:[e.jsx(ke,{size:20}),"Save .ICS"]})]}),e.jsxs("button",{onClick:t=>te(s,t),className:"w-full flex items-center justify-center gap-2 p-3 bg-white/5 hover:bg-white/10 rounded-xl text-gray-400 hover:text-white transition-colors text-sm font-medium",children:[e.jsx(Se,{size:18}),"Share Event"]})]})]})})]})})]})})}),e.jsx(xe,{isOpen:X,onClose:()=>P(!1),onUpload:oe,type:"event"})]})};export{Ue as default};
