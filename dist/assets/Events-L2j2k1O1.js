import{a as n,j as e,i as ee,m as k,A as te}from"./react-vendor-CXoD4tGQ.js";import{U as se}from"./UploadModal-DNZchTTZ.js";import{u as B,a as ae,b as le,c as D,d as x,D as ie,F as I}from"./index-BobQeNdV.js";import{S as re,a as M,P as ne}from"./SortSelector-B0HGnSS6.js";import{j as oe,a8 as de,a4 as ce,m as me,q as F,A as xe,i as U,X as he,h as ge,a9 as ue,aa as L}from"./ui-vendor-a_EBNgrH.js";import"./three-vendor-BxbFXkJv.js";import"./utils-fLfdUYuo.js";const pe=({targetDate:l})=>{const{t:g}=B(),[d,u]=n.useState(m());function m(){const r=+new Date(l)-+new Date;let h={};return r>0&&(h={days:Math.floor(r/(1e3*60*60*24)),hours:Math.floor(r/(1e3*60*60)%24),minutes:Math.floor(r/1e3/60%60),seconds:Math.floor(r/1e3%60)}),h}return n.useEffect(()=>{const r=setInterval(()=>{u(m())},1e3);return()=>clearInterval(r)},[l]),Object.keys(d).length===0?null:e.jsx("div",{className:"flex gap-4 mb-6",children:Object.keys(d).map(r=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/5 border border-white/10 rounded-xl flex items-center justify-center text-2xl font-bold text-white shadow-lg backdrop-blur-md",children:d[r]}),e.jsx("span",{className:"text-xs text-gray-500 uppercase mt-2 font-bold tracking-wider",children:g(`events.countdown.${r}`)})]},r))})},ze=()=>{const{t:l}=B(),{settings:g}=ae(),{user:d}=le(),[u]=ee(),[m,r]=n.useState([]),[h,S]=n.useState(!0),[K,be]=n.useState(!1),[fe,ve]=n.useState(0),[p,Y]=n.useState(1),[q,T]=n.useState(1),[s,c]=n.useState(null),[$,C]=n.useState(!1),[z,H]=n.useState("newest"),[b,V]=n.useState("all");D(s!==null,()=>c(null)),D($,()=>C(!1)),n.useEffect(()=>{const t=u.get("id");t&&x.get(`/events/${t}`).then(a=>{a.data&&c(a.data)}).catch(a=>console.error("Failed to fetch deep linked event",a))},[u]);const[f,P]=n.useState(!1),[O,R]=n.useState(!1);n.useEffect(()=>{S(!0);const t=g.pagination_enabled==="true"?6:1e3,a={page:p,limit:t,sort:z,status:"all",lifecycle:b==="all"?void 0:b};x.get("/events",{params:a}).then(i=>{i.data&&Array.isArray(i.data.data)?(r(i.data.data),T(i.data.pagination?i.data.pagination.totalPages:1)):r([]),S(!1)}).catch(i=>{console.error("Failed to fetch events:",i),r([]),S(!1)})},[p,z,b,g.pagination_enabled]),n.useEffect(()=>{s&&d?x.get(`/events/${s.id}/registration`).then(t=>P(t.data.registered)).catch(t=>console.error(t)):P(!1)},[s,d]);const X=async()=>{if(!d){L.error(l("events.login_to_register"));return}R(!0);try{const t=await x.post(`/events/${s.id}/register`);P(t.data.registered),L.success(t.data.message)}catch{L.error("Registration failed")}finally{R(!1)}},G=t=>{x.post("/events",t).then(()=>{const i={page:p,limit:6};return x.get("/events",{params:i})}).then(a=>{r(a.data.data),T(a.data.pagination.totalPages)}).catch(a=>console.error("Failed to save event",a))},J=t=>{G(t)},Q=t=>{Y(t),window.scrollTo({top:0,behavior:"smooth"})},E=t=>{if(!t)return l("events.status.unknown");try{const a=new Date,i=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),v=String(a.getDate()).padStart(2,"0"),w=`${i}-${o}-${v}`;return t>w?l("events.status.upcoming"):l(t===w?"events.status.ongoing":"events.status.past")}catch{return l("events.status.unknown")}},_=t=>{switch(t){case l("events.status.upcoming"):return"bg-emerald-500 text-white";case l("events.status.ongoing"):return"bg-blue-500 text-white animate-pulse";case l("events.status.past"):return"bg-gray-500 text-gray-200";default:return"bg-gray-500 text-white"}},W=[{value:"all",label:l("common.all")||"All Events"},{value:"upcoming",label:l("events.status.upcoming")||"Upcoming"},{value:"ongoing",label:l("events.status.ongoing")||"Ongoing"},{value:"past",label:l("events.status.past")||"Past"}];return e.jsxs("section",{className:"pt-24 pb-40 md:py-20 px-4 md:px-8 min-h-screen",children:[e.jsxs(k.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mb-8 md:mb-12 relative z-40 md:pt-0 text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-bold font-serif mb-3 md:mb-8",children:l("events.title")}),e.jsx("p",{className:"text-gray-400 max-w-xl mx-auto text-sm md:text-base",children:l("events.subtitle")})]}),e.jsx("div",{className:"flex items-center gap-2 w-full md:w-auto justify-center md:absolute md:right-0 md:top-0 mb-4 md:mb-0",children:e.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-4 py-2 md:px-6 md:py-3 rounded-full backdrop-blur-md border border-white/10 transition-all font-bold text-sm md:text-base shrink-0",children:[e.jsx(oe,{size:18,className:"md:w-5 md:h-5"})," ",l("common.create_event")]})}),e.jsx("div",{className:"flex flex-col gap-4 p-4 bg-white/5 rounded-2xl border border-white/10 backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"w-full",children:e.jsx(ie,{value:b,onChange:V,options:W,icon:de,buttonClassName:"bg-black/20 border-white/10 hover:bg-black/30 w-full py-3 rounded-xl"})}),e.jsx("div",{className:"w-full",children:e.jsx(re,{sort:z,onSortChange:H,className:"w-full",buttonClassName:"bg-black/20 border-white/10 hover:bg-black/30 w-full py-3 rounded-xl"})})]})})]}),K?e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(ce,{size:48,className:"text-red-400 mb-4 opacity-50 mx-auto"}),e.jsx("p",{className:"text-gray-300 mb-6",children:l("common.error_fetching_data")||"Failed to load events"}),e.jsx("button",{onClick:refresh,className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all border border-white/10",children:"Retry"})]}):h&&m.length===0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8 max-w-7xl mx-auto",children:[1,2,3].map(t=>e.jsx("div",{className:"bg-white/5 rounded-3xl h-64 md:h-96 animate-pulse"},t))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8 max-w-7xl mx-auto",children:m.map((t,a)=>{const i=E(t.date),o=i===l("events.status.upcoming"),v=new Date(t.date),w=v.getDate(),Z=v.toLocaleString("default",{month:"short"}).toUpperCase();return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1},className:"group relative bg-[#111] border border-white/10 rounded-3xl overflow-hidden hover:shadow-2xl hover:shadow-indigo-500/20 transition-all duration-500 hover:-translate-y-2 cursor-pointer flex flex-row md:flex-col h-32 md:h-auto",onClick:()=>c(t),children:[e.jsxs("div",{className:"w-1/3 md:w-full h-full md:h-64 overflow-hidden relative shrink-0",children:[e.jsx(M,{src:t.image,alt:t.title,loading:"lazy",className:"w-full h-full",imageClassName:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#111] via-transparent to-transparent opacity-80"}),e.jsxs("div",{className:"hidden md:flex absolute top-4 left-4 bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-3 flex-col items-center justify-center min-w-[60px] shadow-lg group-hover:bg-indigo-600 group-hover:border-indigo-500 transition-colors duration-300",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-gray-300 group-hover:text-white/80",children:Z}),e.jsx("span",{className:"text-2xl font-black text-white",children:w})]}),e.jsxs("div",{className:`absolute top-2 right-2 md:top-4 md:right-4 px-2 py-1 md:px-3 md:py-1.5 rounded-full text-[10px] md:text-xs font-bold uppercase tracking-wider shadow-lg backdrop-blur-md flex items-center gap-1.5 ${_(i)}`,children:[i===l("events.status.upcoming")&&e.jsx(me,{size:10,className:"md:w-3 md:h-3"}),i===l("events.status.ongoing")&&e.jsx("span",{className:"w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-white animate-pulse"}),i]}),e.jsx("div",{className:"hidden md:flex absolute bottom-4 right-4 gap-2",children:e.jsx(I,{itemId:t.id,itemType:"event",size:18,showCount:!1,favorited:t.favorited,initialFavorited:t.favorited,className:"p-2 bg-black/40 hover:bg-indigo-600 rounded-full text-white backdrop-blur-md transition-all",onToggle:(A,j)=>{r(y=>y.map(N=>N.id===t.id?{...N,likes:j!==void 0?j:N.likes,favorited:A}:N)),s&&s.id===t.id&&c(y=>({...y,likes:j!==void 0?j:y.likes,favorited:A}))}})}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-300 backdrop-blur-sm",children:e.jsx("div",{className:"transform scale-75 hidden md:block",children:e.jsx(pe,{targetDate:t.date})})})]}),e.jsxs("div",{className:"p-3 md:p-6 relative flex-1 flex flex-col justify-center",children:[e.jsx("div",{className:"flex items-center gap-4 mb-1 md:mb-4",children:e.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm text-gray-400",children:[e.jsx(F,{size:12,className:"md:w-3.5 md:h-3.5 text-indigo-400"}),e.jsx("span",{className:"truncate max-w-[100px] md:max-w-[150px]",children:t.location||"Online"})]})}),e.jsx("h3",{className:"text-base md:text-2xl font-bold text-white mb-1 md:mb-3 line-clamp-2 group-hover:text-indigo-400 transition-colors leading-tight",children:t.title}),e.jsx("p",{className:"text-gray-400 text-xs md:text-sm line-clamp-2 mb-2 md:mb-6 leading-relaxed hidden md:block",children:t.description}),e.jsx("p",{className:"text-gray-500 text-xs md:hidden mb-1",children:t.date}),e.jsxs("div",{className:"flex items-center text-indigo-400 font-bold text-xs md:text-sm group-hover:translate-x-2 transition-transform mt-auto md:mt-0",children:[l("common.view_details")," ",e.jsx(xe,{size:14,className:"ml-1 md:ml-2 md:w-4 md:h-4"})]})]})]},t.id)})}),!h&&m.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"bg-white/5 rounded-full p-6 inline-block mb-4",children:e.jsx(U,{size:48,className:"text-gray-600"})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No events found matching your criteria."})]}),e.jsx(ne,{currentPage:p,totalPages:q,onPageChange:Q}),e.jsx(te,{children:s&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>c(null),children:e.jsxs(k.div,{initial:{scale:.9,y:50,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.9,y:50,opacity:0},transition:{type:"spring",duration:.5},className:"bg-[#111] w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-3xl border border-white/10 shadow-2xl custom-scrollbar relative",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"h-72 sm:h-96 relative",children:[e.jsx(M,{src:s.image,alt:s.title,type:"event",className:"w-full h-full",imageClassName:"w-full h-full object-cover",iconSize:64}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#111] to-transparent"}),e.jsx("button",{onClick:()=>c(null),className:"absolute top-6 right-6 p-2 bg-black/40 hover:bg-black/60 text-white rounded-full backdrop-blur-md border border-white/10 transition-all z-20",children:e.jsx(he,{size:24})}),e.jsxs("div",{className:"absolute bottom-0 left-0 p-8 w-full",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${_(E(s.date))}`,children:E(s.date)}),s.tags&&s.tags.split(",").map((t,a)=>e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider bg-white/10 text-gray-300 border border-white/5",children:t.trim()},a))]}),e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsx("h2",{className:"text-3xl sm:text-5xl font-bold text-white mb-2 leading-tight",children:s.title}),e.jsx(I,{itemId:s.id,itemType:"event",size:24,showCount:!0,count:s.likes||0,favorited:s.favorited,className:"p-3 bg-white/10 hover:bg-white/20 rounded-full backdrop-blur-md transition-colors mt-1",onToggle:(t,a)=>{c(i=>({...i,likes:a!==void 0?a:i.likes,favorited:t})),r(i=>i.map(o=>o.id===s.id?{...o,likes:a!==void 0?a:o.likes,favorited:t}:o))}})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-gray-300 text-sm sm:text-base font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{size:18,className:"text-indigo-400"}),s.date]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:18,className:"text-indigo-400"}),s.location||"Online"]})]})]})]}),e.jsx("div",{className:"p-8 sm:p-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12",children:[e.jsxs("div",{className:"flex-1 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ge,{size:20,className:"text-indigo-400"}),l("common.description")]}),e.jsx("div",{className:"prose prose-invert prose-lg max-w-none text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:s.content||`<p>${s.description}</p>`}})]}),e.jsxs("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/5 space-y-4",children:[s.location&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{size:20,className:"text-indigo-400 shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm uppercase tracking-wider mb-1",children:"Location"}),e.jsx("p",{className:"text-gray-300",children:s.location})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{size:20,className:"text-indigo-400 shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm uppercase tracking-wider mb-1",children:"Date"}),e.jsx("p",{className:"text-gray-300",children:s.date})]})]})]})]}),e.jsx("div",{className:"lg:w-1/3 space-y-6",children:e.jsxs("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/5 sticky top-8",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:"Registration"}),e.jsx("button",{onClick:X,disabled:O,className:`w-full py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2 ${f?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/50":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg shadow-indigo-500/20"}`,children:O?e.jsx("span",{className:"animate-pulse",children:"Processing..."}):f?e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:20}),"Signed Up"]}):e.jsx(e.Fragment,{children:"Sign Up Now"})}),f&&e.jsx("p",{className:"text-emerald-400/80 text-sm text-center mt-4",children:"You are successfully registered for this event."}),!f&&e.jsx("p",{className:"text-gray-500 text-sm text-center mt-4",children:"Limited spots available."})]})})]})})]})})}),e.jsx(se,{isOpen:$,onClose:()=>C(!1),onUpload:J,type:"event"})]})};export{ze as default};
