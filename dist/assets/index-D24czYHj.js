const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Hero-DspoqsMo.js","assets/react-vendor-CXoD4tGQ.js","assets/ui-vendor-ChojsKpE.js","assets/three-vendor-CkDWRuyZ.js","assets/utils-Cv9gmu_1.js","assets/HomeFeed-BVo34rP5.js","assets/Image3DViewer-CJZlIX7C.js","assets/SmartImage-NGZcafy_.js","assets/Gallery-oQo-WamG.js","assets/SortSelector-D76W0eRq.js","assets/TagInput-gN0k0_Qy.js","assets/Music-CF0UORYD.js","assets/Videos-BgOF1a7p.js","assets/Articles-DTy2svy1.js","assets/Events-B7QEzDzg.js","assets/HomeCategories-D_Wjpggf.js","assets/About-UCF19xrp.js","assets/AdminDashboard-CvUxG2Qb.js","assets/NotFound-C3j7AqEx.js","assets/browser-ponyfill-ISVO8D-X.js"])))=>i.map(i=>d[i]);
var As=Object.defineProperty;var Us=(t,e,n)=>e in t?As(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>Us(t,typeof e!="symbol"?e+"":e,n);import{a as p,j as a,g as qt,R as W,A as re,m as L,b as Zt,u as St,L as lt,c as Ds,d as Bs,B as Fs,e as Hs,f as he}from"./react-vendor-CXoD4tGQ.js";import{s as $s,V as G,U as Ce,S as V,D as Gs,a as Vs,b as Ws,c as Ks,W as ue,L as ct,M as qs,C as ce,N as ut,F as Zs,B as Ue,E as Xt,d as Zn,e as Xn,f as P,g as nn,O as Xs,h as Js,i as et,j as Ge,k as ye,l as Ys,m as Ee,n as Jn,T as Yn,R as Qn,P as Qs,A as ei,o as Jt,p as sn,q as rn,u as pe,r as ti,H as ni,t as q,v as si,w as ii,x as be,y as Ne,z as ri,G as ai,I as oi,J as st,K as De,Q as Lt,X as es,Y as ts,Z as ve,_ as it,$ as Ye,a0 as an,a1 as dt,a2 as Y,a3 as li}from"./three-vendor-CkDWRuyZ.js";import{n as X,R as on,G as ns,X as we,U as Yt,L as ss,a as is,A as rs,C as ci,b as ui,H as ht,I as ft,M as qe,F as pt,c as mt,d as gt,e as ln,f as di,g as hi,S as Ve,h as fi,i as Ct,j as pi,k as mi,l as gi,m as vi,o as xi,p as cn,q as yi,r as bi,s as wi,O as Si,t as ji,B as Ci,W as Ti,N as _i,u as Ei,D as Ni,v as Ri,w as un,x as ki,y as Pi,Z as Oi,z as Mi,E as zi,J as Ii,K as dn,P as Li,Q as hn,T as Ai,V as Ui,Y as Di,_ as Bi,$ as Fi,a0 as Hi,a1 as $i,a2 as Gi,a3 as Vi,a4 as Wi}from"./ui-vendor-ChojsKpE.js";import{a as rt}from"./utils-Cv9gmu_1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const as=p.createContext(),Ki=()=>p.useContext(as),qi=({children:t})=>{const[e,n]=p.useState(null),[s,i]=p.useState(!1),[r,o]=p.useState([]),[l,c]=p.useState(!1),u=p.useRef(new Audio),h=()=>{s?u.current.pause():u.current.play().catch(g=>console.error("Playback failed",g)),i(!s)},d=(g,v=[])=>{v.length>0&&o(v),(e==null?void 0:e.id)===g.id?h():(n(g),i(!0),c(!0),u.current.src=g.audio,u.current.play().catch(x=>console.error("Playback failed",x)))};p.useEffect(()=>{const g=u.current,v=()=>{if(r.length>0&&e){const w=(r.findIndex(S=>S.id===e.id)+1)%r.length;d(r[w],r)}else i(!1)};return g.addEventListener("ended",v),()=>g.removeEventListener("ended",v)},[e,r]);const m=()=>{if(r.length===0||!e)return;const v=(r.findIndex(x=>x.id===e.id)+1)%r.length;d(r[v])},f=()=>{if(r.length===0||!e)return;const v=(r.findIndex(x=>x.id===e.id)-1+r.length)%r.length;d(r[v])};return a.jsx(as.Provider,{value:{currentTrack:e,isPlaying:s,playlist:r,playTrack:d,togglePlay:h,nextTrack:m,prevTrack:f,audioRef:u,isMiniPlayerVisible:l,setIsMiniPlayerVisible:c},children:t})},U=rt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});U.interceptors.request.use(t=>{const e=sessionStorage.getItem("token")||localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));U.interceptors.response.use(t=>t,async t=>{const e=t.config;return(!e||!e.retry)&&(e.retry=0),e.retry<3&&(t.message==="Network Error"||t.response&&t.response.status>=500)?(e.retry+=1,await new Promise(s=>setTimeout(s,1e3*e.retry)),U(e)):(console.error("API Error:",t.response?t.response.data:t.message),Promise.reject(t))});const gc=t=>U.get(t).then(e=>e.data),vc=(t,e)=>U.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}),os=p.createContext(),ls=()=>p.useContext(os),Zi=({children:t})=>{const[e,n]=p.useState({pagination_enabled:"false",theme:"space",language:"zh"}),[s,i]=p.useState(()=>{const h=localStorage.getItem("cursorEnabled");return h!==null?JSON.parse(h):!0}),r=()=>{i(h=>{const d=!h;return localStorage.setItem("cursorEnabled",JSON.stringify(d)),d})},[o,l]=p.useState(!0),c=()=>{U.get("/settings").then(h=>{n(d=>({...d,...h.data})),l(!1)}).catch(h=>{console.error("Failed to fetch settings:",h),l(!1)})};p.useEffect(()=>{c()},[]);const u=(h,d)=>{U.post("/settings",{key:h,value:d}).then(m=>{m.data.success&&n(f=>({...f,[h]:String(d)}))}).catch(m=>console.error("Failed to update setting:",m))};return a.jsx(os.Provider,{value:{settings:e,updateSetting:u,loading:o,cursorEnabled:s,toggleCursor:r},children:t})},cs=p.createContext(),Qe=()=>p.useContext(cs),Xi=({children:t})=>{const[e,n]=p.useState(null),[s,i]=p.useState(!0);p.useEffect(()=>{const u=localStorage.getItem("token");u?(U.defaults.headers.common.Authorization=`Bearer ${u}`,U.get("/auth/me").then(h=>n(h.data)).catch(()=>{localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization}).finally(()=>i(!1))):i(!1)},[]);const r=async(u,h)=>{var d,m;try{const f=await U.post("/auth/login",{username:u,password:h}),{token:g,user:v}=f.data;return localStorage.setItem("token",g),U.defaults.headers.common.Authorization=`Bearer ${g}`,n(v),X.success(`Welcome back, ${v.username}!`),!0}catch(f){return console.error(f),X.error(((m=(d=f.response)==null?void 0:d.data)==null?void 0:m.error)||"Login failed"),!1}},o=async(u,h)=>{var d,m;try{const f=await U.post("/auth/register",{username:u,password:h}),{token:g,user:v}=f.data;return localStorage.setItem("token",g),U.defaults.headers.common.Authorization=`Bearer ${g}`,n(v),X.success(`Welcome, ${v.username}!`),!0}catch(f){return console.error(f),X.error(((m=(d=f.response)==null?void 0:d.data)==null?void 0:m.error)||"Registration failed"),!1}},l=()=>{localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization,n(null),X.success("Logged out successfully")},c=async()=>{try{const u=await U.get("/auth/me");n(u.data)}catch(u){console.error(u)}};return a.jsx(cs.Provider,{value:{user:e,login:r,register:o,logout:l,loading:s,refreshUser:c,isAdmin:(e==null?void 0:e.role)==="admin"},children:t})};var Ji=typeof Element<"u",Yi=typeof Map=="function",Qi=typeof Set=="function",er=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function at(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,s,i;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(!at(t[s],e[s]))return!1;return!0}var r;if(Yi&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(r=t.entries();!(s=r.next()).done;)if(!e.has(s.value[0]))return!1;for(r=t.entries();!(s=r.next()).done;)if(!at(s.value[1],e.get(s.value[0])))return!1;return!0}if(Qi&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(r=t.entries();!(s=r.next()).done;)if(!e.has(s.value[0]))return!1;return!0}if(er&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(t[s]!==e[s])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[s]))return!1;if(Ji&&t instanceof Element)return!1;for(s=n;s--!==0;)if(!((i[s]==="_owner"||i[s]==="__v"||i[s]==="__o")&&t.$$typeof)&&!at(t[i[s]],e[i[s]]))return!1;return!0}return t!==t&&e!==e}var tr=function(e,n){try{return at(e,n)}catch(s){if((s.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw s}};const nr=qt(tr);var sr=function(t,e,n,s,i,r,o,l){if(!t){var c;if(e===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,s,i,r,o,l],h=0;c=new Error(e.replace(/%s/g,function(){return u[h++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},ir=sr;const fn=qt(ir);var rr=function(e,n,s,i){var r=s?s.call(i,e,n):void 0;if(r!==void 0)return!!r;if(e===n)return!0;if(typeof e!="object"||!e||typeof n!="object"||!n)return!1;var o=Object.keys(e),l=Object.keys(n);if(o.length!==l.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(n),u=0;u<o.length;u++){var h=o[u];if(!c(h))return!1;var d=e[h],m=n[h];if(r=s?s.call(i,d,m,h):void 0,r===!1||r===void 0&&d!==m)return!1}return!0};const ar=qt(rr);var us=(t=>(t.BASE="base",t.BODY="body",t.HEAD="head",t.HTML="html",t.LINK="link",t.META="meta",t.NOSCRIPT="noscript",t.SCRIPT="script",t.STYLE="style",t.TITLE="title",t.FRAGMENT="Symbol(react.fragment)",t))(us||{}),Tt={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},pn=Object.values(us),Qt={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},or=Object.entries(Qt).reduce((t,[e,n])=>(t[n]=e,t),{}),ie="data-rh",Ie={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},Le=(t,e)=>{for(let n=t.length-1;n>=0;n-=1){const s=t[n];if(Object.prototype.hasOwnProperty.call(s,e))return s[e]}return null},lr=t=>{let e=Le(t,"title");const n=Le(t,Ie.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),n&&e)return n.replace(/%s/g,()=>e);const s=Le(t,Ie.DEFAULT_TITLE);return e||s||void 0},cr=t=>Le(t,Ie.ON_CHANGE_CLIENT_STATE)||(()=>{}),_t=(t,e)=>e.filter(n=>typeof n[t]<"u").map(n=>n[t]).reduce((n,s)=>({...n,...s}),{}),ur=(t,e)=>e.filter(n=>typeof n.base<"u").map(n=>n.base).reverse().reduce((n,s)=>{if(!n.length){const i=Object.keys(s);for(let r=0;r<i.length;r+=1){const l=i[r].toLowerCase();if(t.indexOf(l)!==-1&&s[l])return n.concat(s)}}return n},[]),dr=t=>console&&typeof console.warn=="function"&&console.warn(t),Be=(t,e,n)=>{const s={};return n.filter(i=>Array.isArray(i[t])?!0:(typeof i[t]<"u"&&dr(`Helmet: ${t} should be of type "Array". Instead found type "${typeof i[t]}"`),!1)).map(i=>i[t]).reverse().reduce((i,r)=>{const o={};r.filter(c=>{let u;const h=Object.keys(c);for(let m=0;m<h.length;m+=1){const f=h[m],g=f.toLowerCase();e.indexOf(g)!==-1&&!(u==="rel"&&c[u].toLowerCase()==="canonical")&&!(g==="rel"&&c[g].toLowerCase()==="stylesheet")&&(u=g),e.indexOf(f)!==-1&&(f==="innerHTML"||f==="cssText"||f==="itemprop")&&(u=f)}if(!u||!c[u])return!1;const d=c[u].toLowerCase();return s[u]||(s[u]={}),o[u]||(o[u]={}),s[u][d]?!1:(o[u][d]=!0,!0)}).reverse().forEach(c=>i.push(c));const l=Object.keys(o);for(let c=0;c<l.length;c+=1){const u=l[c],h={...s[u],...o[u]};s[u]=h}return i},[]).reverse()},hr=(t,e)=>{if(Array.isArray(t)&&t.length){for(let n=0;n<t.length;n+=1)if(t[n][e])return!0}return!1},fr=t=>({baseTag:ur(["href"],t),bodyAttributes:_t("bodyAttributes",t),defer:Le(t,Ie.DEFER),encode:Le(t,Ie.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:_t("htmlAttributes",t),linkTags:Be("link",["rel","href"],t),metaTags:Be("meta",["name","charset","http-equiv","property","itemprop"],t),noscriptTags:Be("noscript",["innerHTML"],t),onChangeClientState:cr(t),scriptTags:Be("script",["src","innerHTML"],t),styleTags:Be("style",["cssText"],t),title:lr(t),titleAttributes:_t("titleAttributes",t),prioritizeSeoTags:hr(t,Ie.PRIORITIZE_SEO_TAGS)}),ds=t=>Array.isArray(t)?t.join(""):t,pr=(t,e)=>{const n=Object.keys(t);for(let s=0;s<n.length;s+=1)if(e[n[s]]&&e[n[s]].includes(t[n[s]]))return!0;return!1},Et=(t,e)=>Array.isArray(t)?t.reduce((n,s)=>(pr(s,e)?n.priority.push(s):n.default.push(s),n),{priority:[],default:[]}):{default:t,priority:[]},mn=(t,e)=>({...t,[e]:void 0}),mr=["noscript","script","style"],At=(t,e=!0)=>e===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),hs=t=>Object.keys(t).reduce((e,n)=>{const s=typeof t[n]<"u"?`${n}="${t[n]}"`:`${n}`;return e?`${e} ${s}`:s},""),gr=(t,e,n,s)=>{const i=hs(n),r=ds(e);return i?`<${t} ${ie}="true" ${i}>${At(r,s)}</${t}>`:`<${t} ${ie}="true">${At(r,s)}</${t}>`},vr=(t,e,n=!0)=>e.reduce((s,i)=>{const r=i,o=Object.keys(r).filter(u=>!(u==="innerHTML"||u==="cssText")).reduce((u,h)=>{const d=typeof r[h]>"u"?h:`${h}="${At(r[h],n)}"`;return u?`${u} ${d}`:d},""),l=r.innerHTML||r.cssText||"",c=mr.indexOf(t)===-1;return`${s}<${t} ${ie}="true" ${o}${c?"/>":`>${l}</${t}>`}`},""),fs=(t,e={})=>Object.keys(t).reduce((n,s)=>{const i=Qt[s];return n[i||s]=t[s],n},e),xr=(t,e,n)=>{const s={key:e,[ie]:!0},i=fs(n,s);return[W.createElement("title",i,e)]},ot=(t,e)=>e.map((n,s)=>{const i={key:s,[ie]:!0};return Object.keys(n).forEach(r=>{const l=Qt[r]||r;if(l==="innerHTML"||l==="cssText"){const c=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:c}}else i[l]=n[r]}),W.createElement(t,i)}),ee=(t,e,n=!0)=>{switch(t){case"title":return{toComponent:()=>xr(t,e.title,e.titleAttributes),toString:()=>gr(t,e.title,e.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>fs(e),toString:()=>hs(e)};default:return{toComponent:()=>ot(t,e),toString:()=>vr(t,e,n)}}},yr=({metaTags:t,linkTags:e,scriptTags:n,encode:s})=>{const i=Et(t,Tt.meta),r=Et(e,Tt.link),o=Et(n,Tt.script);return{priorityMethods:{toComponent:()=>[...ot("meta",i.priority),...ot("link",r.priority),...ot("script",o.priority)],toString:()=>`${ee("meta",i.priority,s)} ${ee("link",r.priority,s)} ${ee("script",o.priority,s)}`},metaTags:i.default,linkTags:r.default,scriptTags:o.default}},br=t=>{const{baseTag:e,bodyAttributes:n,encode:s=!0,htmlAttributes:i,noscriptTags:r,styleTags:o,title:l="",titleAttributes:c,prioritizeSeoTags:u}=t;let{linkTags:h,metaTags:d,scriptTags:m}=t,f={toComponent:()=>{},toString:()=>""};return u&&({priorityMethods:f,linkTags:h,metaTags:d,scriptTags:m}=yr(t)),{priority:f,base:ee("base",e,s),bodyAttributes:ee("bodyAttributes",n,s),htmlAttributes:ee("htmlAttributes",i,s),link:ee("link",h,s),meta:ee("meta",d,s),noscript:ee("noscript",r,s),script:ee("script",m,s),style:ee("style",o,s),title:ee("title",{title:l,titleAttributes:c},s)}},Ut=br,tt=[],ps=!!(typeof window<"u"&&window.document&&window.document.createElement),Dt=class{constructor(t,e){oe(this,"instances",[]);oe(this,"canUseDOM",ps);oe(this,"context");oe(this,"value",{setHelmet:t=>{this.context.helmet=t},helmetInstances:{get:()=>this.canUseDOM?tt:this.instances,add:t=>{(this.canUseDOM?tt:this.instances).push(t)},remove:t=>{const e=(this.canUseDOM?tt:this.instances).indexOf(t);(this.canUseDOM?tt:this.instances).splice(e,1)}}});this.context=t,this.canUseDOM=e||!1,e||(t.helmet=Ut({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},wr={},ms=W.createContext(wr),je,gs=(je=class extends p.Component{constructor(n){super(n);oe(this,"helmetData");this.helmetData=new Dt(this.props.context||{},je.canUseDOM)}render(){return W.createElement(ms.Provider,{value:this.helmetData.value},this.props.children)}},oe(je,"canUseDOM",ps),je),ke=(t,e)=>{const n=document.head||document.querySelector("head"),s=n.querySelectorAll(`${t}[${ie}]`),i=[].slice.call(s),r=[];let o;return e&&e.length&&e.forEach(l=>{const c=document.createElement(t);for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u))if(u==="innerHTML")c.innerHTML=l.innerHTML;else if(u==="cssText")c.styleSheet?c.styleSheet.cssText=l.cssText:c.appendChild(document.createTextNode(l.cssText));else{const h=u,d=typeof l[h]>"u"?"":l[h];c.setAttribute(u,d)}c.setAttribute(ie,"true"),i.some((u,h)=>(o=h,c.isEqualNode(u)))?i.splice(o,1):r.push(c)}),i.forEach(l=>{var c;return(c=l.parentNode)==null?void 0:c.removeChild(l)}),r.forEach(l=>n.appendChild(l)),{oldTags:i,newTags:r}},Bt=(t,e)=>{const n=document.getElementsByTagName(t)[0];if(!n)return;const s=n.getAttribute(ie),i=s?s.split(","):[],r=[...i],o=Object.keys(e);for(const l of o){const c=e[l]||"";n.getAttribute(l)!==c&&n.setAttribute(l,c),i.indexOf(l)===-1&&i.push(l);const u=r.indexOf(l);u!==-1&&r.splice(u,1)}for(let l=r.length-1;l>=0;l-=1)n.removeAttribute(r[l]);i.length===r.length?n.removeAttribute(ie):n.getAttribute(ie)!==o.join(",")&&n.setAttribute(ie,o.join(","))},Sr=(t,e)=>{typeof t<"u"&&document.title!==t&&(document.title=ds(t)),Bt("title",e)},gn=(t,e)=>{const{baseTag:n,bodyAttributes:s,htmlAttributes:i,linkTags:r,metaTags:o,noscriptTags:l,onChangeClientState:c,scriptTags:u,styleTags:h,title:d,titleAttributes:m}=t;Bt("body",s),Bt("html",i),Sr(d,m);const f={baseTag:ke("base",n),linkTags:ke("link",r),metaTags:ke("meta",o),noscriptTags:ke("noscript",l),scriptTags:ke("script",u),styleTags:ke("style",h)},g={},v={};Object.keys(f).forEach(x=>{const{newTags:w,oldTags:S}=f[x];w.length&&(g[x]=w),S.length&&(v[x]=f[x].oldTags)}),e&&e(),c(t,g,v)},Fe=null,jr=t=>{Fe&&cancelAnimationFrame(Fe),t.defer?Fe=requestAnimationFrame(()=>{gn(t,()=>{Fe=null})}):(gn(t),Fe=null)},Cr=jr,vn=class extends p.Component{constructor(){super(...arguments);oe(this,"rendered",!1)}shouldComponentUpdate(e){return!ar(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:n}=this.props.context;let s=null;const i=fr(e.get().map(r=>{const o={...r.props};return delete o.context,o}));gs.canUseDOM?Cr(i):Ut&&(s=Ut(i)),n(s)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},It,xc=(It=class extends p.Component{shouldComponentUpdate(t){return!nr(mn(this.props,"helmetData"),mn(t,"helmetData"))}mapNestedChildrenToProps(t,e){if(!e)return null;switch(t.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${t.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(t,e,n,s){return{...e,[t.type]:[...e[t.type]||[],{...n,...this.mapNestedChildrenToProps(t,s)}]}}mapObjectTypeChildren(t,e,n,s){switch(t.type){case"title":return{...e,[t.type]:s,titleAttributes:{...n}};case"body":return{...e,bodyAttributes:{...n}};case"html":return{...e,htmlAttributes:{...n}};default:return{...e,[t.type]:{...n}}}}mapArrayTypeChildrenToProps(t,e){let n={...e};return Object.keys(t).forEach(s=>{n={...n,[s]:t[s]}}),n}warnOnInvalidChildren(t,e){return fn(pn.some(n=>t.type===n),typeof t.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${pn.join(", ")} are allowed. Helmet does not support rendering <${t.type}> elements. Refer to our API for more information.`),fn(!e||typeof e=="string"||Array.isArray(e)&&!e.some(n=>typeof n!="string"),`Helmet expects a string as a child of <${t.type}>. Did you forget to wrap your children in braces? ( <${t.type}>{\`\`}</${t.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(t,e){let n={};return W.Children.forEach(t,s=>{if(!s||!s.props)return;const{children:i,...r}=s.props,o=Object.keys(r).reduce((c,u)=>(c[or[u]||u]=r[u],c),{});let{type:l}=s;switch(typeof l=="symbol"?l=l.toString():this.warnOnInvalidChildren(s,i),l){case"Symbol(react.fragment)":e=this.mapChildrenToProps(i,e);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(s,n,o,i);break;default:e=this.mapObjectTypeChildren(s,e,o,i);break}}),this.mapArrayTypeChildrenToProps(n,e)}render(){const{children:t,...e}=this.props;let n={...e},{helmetData:s}=e;if(t&&(n=this.mapChildrenToProps(t,n)),s&&!(s instanceof Dt)){const i=s;s=new Dt(i.context,!0),delete n.helmetData}return s?W.createElement(vn,{...n,context:s.value}):W.createElement(ms.Consumer,null,i=>W.createElement(vn,{...n,context:i}))}},oe(It,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),It);class ze extends W.Component{constructor(n){super(n);oe(this,"handleReset",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("Uncaught error:",n,s)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:this.props.silent||this.props.variant==="inline"?null:a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black text-white p-6 text-center z-[100] relative",children:[a.jsx("h1",{className:"text-4xl font-bold font-serif text-red-500 mb-4",children:"Something went wrong"}),a.jsx("p",{className:"text-gray-400 max-w-md mb-8",children:"The application encountered an error but has attempted to contain it."}),this.state.error&&a.jsx("div",{className:"bg-white/5 border border-white/10 p-4 rounded-lg text-left text-xs font-mono text-red-300 max-w-2xl overflow-auto mb-8 w-full max-h-48",children:this.state.error.toString()}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("button",{onClick:()=>{this.handleReset()},className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-full transition-colors font-bold",children:[a.jsx(on,{size:20}),"Try Again"]}),a.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors font-bold",children:[a.jsx(on,{size:20}),"Force Reload"]})]})]}):this.props.children}}const T=t=>typeof t=="string",He=()=>{let t,e;const n=new Promise((s,i)=>{t=s,e=i});return n.resolve=t,n.reject=e,n},xn=t=>t==null?"":""+t,Tr=(t,e,n)=>{t.forEach(s=>{e[s]&&(n[s]=e[s])})},_r=/###/g,yn=t=>t&&t.indexOf("###")>-1?t.replace(_r,"."):t,bn=t=>!t||T(t),We=(t,e,n)=>{const s=T(e)?e.split("."):e;let i=0;for(;i<s.length-1;){if(bn(t))return{};const r=yn(s[i]);!t[r]&&n&&(t[r]=new n),Object.prototype.hasOwnProperty.call(t,r)?t=t[r]:t={},++i}return bn(t)?{}:{obj:t,k:yn(s[i])}},wn=(t,e,n)=>{const{obj:s,k:i}=We(t,e,Object);if(s!==void 0||e.length===1){s[i]=n;return}let r=e[e.length-1],o=e.slice(0,e.length-1),l=We(t,o,Object);for(;l.obj===void 0&&o.length;)r=`${o[o.length-1]}.${r}`,o=o.slice(0,o.length-1),l=We(t,o,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${r}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${r}`]=n},Er=(t,e,n,s)=>{const{obj:i,k:r}=We(t,e,Object);i[r]=i[r]||[],i[r].push(n)},vt=(t,e)=>{const{obj:n,k:s}=We(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,s))return n[s]},Nr=(t,e,n)=>{const s=vt(t,n);return s!==void 0?s:vt(e,n)},vs=(t,e,n)=>{for(const s in e)s!=="__proto__"&&s!=="constructor"&&(s in t?T(t[s])||t[s]instanceof String||T(e[s])||e[s]instanceof String?n&&(t[s]=e[s]):vs(t[s],e[s],n):t[s]=e[s]);return t},Pe=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Rr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const kr=t=>T(t)?t.replace(/[&<>"'\/]/g,e=>Rr[e]):t;class Pr{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const s=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,s),this.regExpQueue.push(e),s}}const Or=[" ",",","?","!",";"],Mr=new Pr(20),zr=(t,e,n)=>{e=e||"",n=n||"";const s=Or.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(s.length===0)return!0;const i=Mr.getRegExp(`(${s.map(o=>o==="?"?"\\?":o).join("|")})`);let r=!i.test(t);if(!r){const o=t.indexOf(n);o>0&&!i.test(t.substring(0,o))&&(r=!0)}return r},Ft=(t,e,n=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const s=e.split(n);let i=t;for(let r=0;r<s.length;){if(!i||typeof i!="object")return;let o,l="";for(let c=r;c<s.length;++c)if(c!==r&&(l+=n),l+=s[c],o=i[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<s.length-1)continue;r+=c-r+1;break}i=o}return i},Ze=t=>t==null?void 0:t.replace("_","-"),Ir={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var n,s;(s=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||s.call(n,console,e)}};class xt{constructor(e,n={}){this.init(e,n)}init(e,n={}){this.prefix=n.prefix||"i18next:",this.logger=e||Ir,this.options=n,this.debug=n.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,s,i){return i&&!this.debug?null:(T(e[0])&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new xt(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new xt(this.logger,e)}}var le=new xt;class jt{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(s=>{this.observers[s]||(this.observers[s]=new Map);const i=this.observers[s].get(n)||0;this.observers[s].set(n,i+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e,...n){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([i,r])=>{for(let o=0;o<r;o++)i(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,r])=>{for(let o=0;o<r;o++)i.apply(i,[e,...n])})}}class Sn extends jt{constructor(e,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,s,i={}){var u,h;const r=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],s&&(Array.isArray(s)?l.push(...s):T(s)&&r?l.push(...s.split(r)):l.push(s)));const c=vt(this.data,l);return!c&&!n&&!s&&e.indexOf(".")>-1&&(e=l[0],n=l[1],s=l.slice(2).join(".")),c||!o||!T(s)?c:Ft((h=(u=this.data)==null?void 0:u[e])==null?void 0:h[n],s,r)}addResource(e,n,s,i,r={silent:!1}){const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let l=[e,n];s&&(l=l.concat(o?s.split(o):s)),e.indexOf(".")>-1&&(l=e.split("."),i=n,n=l[1]),this.addNamespaces(n),wn(this.data,l,i),r.silent||this.emit("added",e,n,s,i)}addResources(e,n,s,i={silent:!1}){for(const r in s)(T(s[r])||Array.isArray(s[r]))&&this.addResource(e,n,r,s[r],{silent:!0});i.silent||this.emit("added",e,n,s)}addResourceBundle(e,n,s,i,r,o={silent:!1,skipCopy:!1}){let l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),i=s,s=n,n=l[1]),this.addNamespaces(n);let c=vt(this.data,l)||{};o.skipCopy||(s=JSON.parse(JSON.stringify(s))),i?vs(c,s,r):c={...c,...s},wn(this.data,l,c),o.silent||this.emit("added",e,n,s)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(i=>n[i]&&Object.keys(n[i]).length>0)}toJSON(){return this.data}}var xs={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,s,i){return t.forEach(r=>{var o;e=((o=this.processors[r])==null?void 0:o.process(e,n,s,i))??e}),e}};const ys=Symbol("i18next/PATH_KEY");function Lr(){const t=[],e=Object.create(null);let n;return e.get=(s,i)=>{var r;return(r=n==null?void 0:n.revoke)==null||r.call(n),i===ys?t:(t.push(i),n=Proxy.revocable(s,e),n.proxy)},Proxy.revocable(Object.create(null),e).proxy}function Ht(t,e){const{[ys]:n}=t(Lr());return n.join((e==null?void 0:e.keySeparator)??".")}const jn={},Nt=t=>!T(t)&&typeof t!="boolean"&&typeof t!="number";class yt extends jt{constructor(e,n={}){super(),Tr(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=le.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,n={interpolation:{}}){const s={...n};if(e==null)return!1;const i=this.resolve(e,s);if((i==null?void 0:i.res)===void 0)return!1;const r=Nt(i.res);return!(s.returnObjects===!1&&r)}extractFromKey(e,n){let s=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let r=n.ns||this.options.defaultNS||[];const o=s&&e.indexOf(s)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!zr(e,s,i);if(o&&!l){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:T(r)?[r]:r};const u=e.split(s);(s!==i||s===i&&this.options.ns.indexOf(u[0])>-1)&&(r=u.shift()),e=u.join(i)}return{key:e,namespaces:T(r)?[r]:r}}translate(e,n,s){let i=typeof n=="object"?{...n}:n;if(typeof i!="object"&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),typeof i=="object"&&(i={...i}),i||(i={}),e==null)return"";typeof e=="function"&&(e=Ht(e,{...this.options,...i})),Array.isArray(e)||(e=[String(e)]);const r=i.returnDetails!==void 0?i.returnDetails:this.options.returnDetails,o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],i),u=c[c.length-1];let h=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const d=i.lng||this.language,m=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((d==null?void 0:d.toLowerCase())==="cimode")return m?r?{res:`${u}${h}${l}`,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:`${u}${h}${l}`:r?{res:l,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u,usedParams:this.getUsedParamsDetails(i)}:l;const f=this.resolve(e,i);let g=f==null?void 0:f.res;const v=(f==null?void 0:f.usedKey)||l,x=(f==null?void 0:f.exactUsedKey)||l,w=["[object Number]","[object Function]","[object RegExp]"],S=i.joinArrays!==void 0?i.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,C=i.count!==void 0&&!T(i.count),I=yt.hasDefaultValue(i),B=C?this.pluralResolver.getSuffix(d,i.count,i):"",D=i.ordinal&&C?this.pluralResolver.getSuffix(d,i.count,{ordinal:!1}):"",H=C&&!i.ordinal&&i.count===0,O=H&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${B}`]||i[`defaultValue${D}`]||i.defaultValue;let N=g;b&&!g&&I&&(N=O);const A=Nt(N),_=Object.prototype.toString.apply(N);if(b&&N&&A&&w.indexOf(_)<0&&!(T(S)&&Array.isArray(N))){if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const y=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,N,{...i,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return r?(f.res=y,f.usedParams=this.getUsedParamsDetails(i),f):y}if(o){const y=Array.isArray(N),E=y?[]:{},M=y?x:v;for(const k in N)if(Object.prototype.hasOwnProperty.call(N,k)){const F=`${M}${o}${k}`;I&&!g?E[k]=this.translate(F,{...i,defaultValue:Nt(O)?O[k]:void 0,joinArrays:!1,ns:c}):E[k]=this.translate(F,{...i,joinArrays:!1,ns:c}),E[k]===F&&(E[k]=N[k])}g=E}}else if(b&&T(S)&&Array.isArray(g))g=g.join(S),g&&(g=this.extendTranslation(g,e,i,s));else{let y=!1,E=!1;!this.isValidLookup(g)&&I&&(y=!0,g=O),this.isValidLookup(g)||(E=!0,g=l);const k=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:g,F=I&&O!==g&&this.options.updateMissing;if(E||y||F){if(this.logger.log(F?"updateKey":"missingKey",d,u,l,F?O:g),o){const $=this.resolve(l,{...i,keySeparator:!1});$&&$.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Q=[];const me=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if(this.options.saveMissingTo==="fallback"&&me&&me[0])for(let $=0;$<me.length;$++)Q.push(me[$]);else this.options.saveMissingTo==="all"?Q=this.languageUtils.toResolveHierarchy(i.lng||this.language):Q.push(i.lng||this.language);const te=($,ne,se)=>{var ae;const j=I&&se!==g?se:k;this.options.missingKeyHandler?this.options.missingKeyHandler($,u,ne,j,F,i):(ae=this.backendConnector)!=null&&ae.saveMissing&&this.backendConnector.saveMissing($,u,ne,j,F,i),this.emit("missingKey",$,u,ne,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?Q.forEach($=>{const ne=this.pluralResolver.getSuffixes($,i);H&&i[`defaultValue${this.options.pluralSeparator}zero`]&&ne.indexOf(`${this.options.pluralSeparator}zero`)<0&&ne.push(`${this.options.pluralSeparator}zero`),ne.forEach(se=>{te([$],l+se,i[`defaultValue${se}`]||O)})}):te(Q,l,O))}g=this.extendTranslation(g,e,i,f,s),E&&g===l&&this.options.appendNamespaceToMissingKey&&(g=`${u}${h}${l}`),(E||y)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${h}${l}`:l,y?g:void 0,i))}return r?(f.res=g,f.usedParams=this.getUsedParamsDetails(i),f):g}extendTranslation(e,n,s,i,r){var c,u;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const h=T(e)&&(((u=s==null?void 0:s.interpolation)==null?void 0:u.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(h){const f=e.match(this.interpolator.nestingRegexp);d=f&&f.length}let m=s.replace&&!T(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),e=this.interpolator.interpolate(e,m,s.lng||this.language||i.usedLng,s),h){const f=e.match(this.interpolator.nestingRegexp),g=f&&f.length;d<g&&(s.nest=!1)}!s.lng&&i&&i.res&&(s.lng=this.language||i.usedLng),s.nest!==!1&&(e=this.interpolator.nest(e,(...f)=>(r==null?void 0:r[0])===f[0]&&!s.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):this.translate(...f,n),s)),s.interpolation&&this.interpolator.reset()}const o=s.postProcess||this.options.postProcess,l=T(o)?[o]:o;return e!=null&&(l!=null&&l.length)&&s.applyPostProcessor!==!1&&(e=xs.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),e}resolve(e,n={}){let s,i,r,o,l;return T(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(s))return;const u=this.extractFromKey(c,n),h=u.key;i=h;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const m=n.count!==void 0&&!T(n.count),f=m&&!n.ordinal&&n.count===0,g=n.context!==void 0&&(T(n.context)||typeof n.context=="number")&&n.context!=="",v=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);d.forEach(x=>{var w,S;this.isValidLookup(s)||(l=x,!jn[`${v[0]}-${x}`]&&((w=this.utils)!=null&&w.hasLoadedNamespace)&&!((S=this.utils)!=null&&S.hasLoadedNamespace(l))&&(jn[`${v[0]}-${x}`]=!0,this.logger.warn(`key "${i}" for languages "${v.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach(b=>{var B;if(this.isValidLookup(s))return;o=b;const C=[h];if((B=this.i18nFormat)!=null&&B.addLookupKeys)this.i18nFormat.addLookupKeys(C,h,b,x,n);else{let D;m&&(D=this.pluralResolver.getSuffix(b,n.count,n));const H=`${this.options.pluralSeparator}zero`,O=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(n.ordinal&&D.indexOf(O)===0&&C.push(h+D.replace(O,this.options.pluralSeparator)),C.push(h+D),f&&C.push(h+H)),g){const N=`${h}${this.options.contextSeparator||"_"}${n.context}`;C.push(N),m&&(n.ordinal&&D.indexOf(O)===0&&C.push(N+D.replace(O,this.options.pluralSeparator)),C.push(N+D),f&&C.push(N+H))}}let I;for(;I=C.pop();)this.isValidLookup(s)||(r=I,s=this.getResource(b,x,I,n))}))})}),{res:s,usedKey:i,exactUsedKey:r,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,s,i={}){var r;return(r=this.i18nFormat)!=null&&r.getResource?this.i18nFormat.getResource(e,n,s,i):this.resourceStore.getResource(e,n,s,i)}getUsedParamsDetails(e={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=e.replace&&!T(e.replace);let i=s?e.replace:e;if(s&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!s){i={...i};for(const r of n)delete i[r]}return i}static hasDefaultValue(e){const n="defaultValue";for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&n===s.substring(0,n.length)&&e[s]!==void 0)return!0;return!1}}class Cn{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=le.create("languageUtils")}getScriptPartFromCode(e){if(e=Ze(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Ze(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(T(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(s=>{if(n)return;const i=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(i))&&(n=i)}),!n&&this.options.supportedLngs&&e.forEach(s=>{if(n)return;const i=this.getScriptPartFromCode(s);if(this.isSupportedCode(i))return n=i;const r=this.getLanguagePartFromCode(s);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(o=>{if(o===r)return o;if(!(o.indexOf("-")<0&&r.indexOf("-")<0)&&(o.indexOf("-")>0&&r.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===r||o.indexOf(r)===0&&r.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),T(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let s=e[n];return s||(s=e[this.getScriptPartFromCode(n)]),s||(s=e[this.formatLanguageCode(n)]),s||(s=e[this.getLanguagePartFromCode(n)]),s||(s=e.default),s||[]}toResolveHierarchy(e,n){const s=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],e),i=[],r=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return T(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(e))):T(e)&&r(this.formatLanguageCode(e)),s.forEach(o=>{i.indexOf(o)<0&&r(this.formatLanguageCode(o))}),i}}const Tn={zero:0,one:1,two:2,few:3,many:4,other:5},_n={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Ar{constructor(e,n={}){this.languageUtils=e,this.options=n,this.logger=le.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e,n={}){const s=Ze(e==="dev"?"en":e),i=n.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:s,type:i});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let o;try{o=new Intl.PluralRules(s,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),_n;if(!e.match(/-|_/))return _n;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,n)}return this.pluralRulesCache[r]=o,o}needsPlural(e,n={}){let s=this.getRule(e,n);return s||(s=this.getRule("dev",n)),(s==null?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,n,s={}){return this.getSuffixes(e,s).map(i=>`${n}${i}`)}getSuffixes(e,n={}){let s=this.getRule(e,n);return s||(s=this.getRule("dev",n)),s?s.resolvedOptions().pluralCategories.sort((i,r)=>Tn[i]-Tn[r]).map(i=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,n,s={}){const i=this.getRule(e,s);return i?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${i.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,s))}}const En=(t,e,n,s=".",i=!0)=>{let r=Nr(t,e,n);return!r&&i&&T(n)&&(r=Ft(t,n,s),r===void 0&&(r=Ft(e,n,s))),r},Rt=t=>t.replace(/\$/g,"$$$$");class Nn{constructor(e={}){var n;this.logger=le.create("interpolator"),this.options=e,this.format=((n=e==null?void 0:e.interpolation)==null?void 0:n.format)||(s=>s),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:s,useRawValueToEscape:i,prefix:r,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:u,unescapeSuffix:h,unescapePrefix:d,nestingPrefix:m,nestingPrefixEscaped:f,nestingSuffix:g,nestingSuffixEscaped:v,nestingOptionsSeparator:x,maxReplaces:w,alwaysFormat:S}=e.interpolation;this.escape=n!==void 0?n:kr,this.escapeValue=s!==void 0?s:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=r?Pe(r):o||"{{",this.suffix=l?Pe(l):c||"}}",this.formatSeparator=u||",",this.unescapePrefix=h?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=m?Pe(m):f||Pe("$t("),this.nestingSuffix=g?Pe(g):v||Pe(")"),this.nestingOptionsSeparator=x||",",this.maxReplaces=w||1e3,this.alwaysFormat=S!==void 0?S:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,s)=>(n==null?void 0:n.source)===s?(n.lastIndex=0,n):new RegExp(s,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,n,s,i){var f;let r,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=g=>{if(g.indexOf(this.formatSeparator)<0){const S=En(n,c,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(S,void 0,s,{...i,...n,interpolationkey:g}):S}const v=g.split(this.formatSeparator),x=v.shift().trim(),w=v.join(this.formatSeparator).trim();return this.format(En(n,c,x,this.options.keySeparator,this.options.ignoreJSONStructure),w,s,{...i,...n,interpolationkey:x})};this.resetRegExp();const h=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((f=i==null?void 0:i.interpolation)==null?void 0:f.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>Rt(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?Rt(this.escape(g)):Rt(g)}].forEach(g=>{for(l=0;r=g.regex.exec(e);){const v=r[1].trim();if(o=u(v),o===void 0)if(typeof h=="function"){const w=h(e,r,i);o=T(w)?w:""}else if(i&&Object.prototype.hasOwnProperty.call(i,v))o="";else if(d){o=r[0];continue}else this.logger.warn(`missed to pass in variable ${v} for interpolating ${e}`),o="";else!T(o)&&!this.useRawValueToEscape&&(o=xn(o));const x=g.safeValue(o);if(e=e.replace(r[0],x),d?(g.regex.lastIndex+=o.length,g.regex.lastIndex-=r[0].length):g.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n,s={}){let i,r,o;const l=(c,u)=>{const h=this.nestingOptionsSeparator;if(c.indexOf(h)<0)return c;const d=c.split(new RegExp(`${h}[ ]*{`));let m=`{${d[1]}`;c=d[0],m=this.interpolate(m,o);const f=m.match(/'/g),g=m.match(/"/g);(((f==null?void 0:f.length)??0)%2===0&&!g||g.length%2!==0)&&(m=m.replace(/'/g,'"'));try{o=JSON.parse(m),u&&(o={...u,...o})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,v),`${c}${h}${m}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;i=this.nestingRegexp.exec(e);){let c=[];o={...s},o=o.replace&&!T(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const u=/{.*}/.test(i[1])?i[1].lastIndexOf("}")+1:i[1].indexOf(this.formatSeparator);if(u!==-1&&(c=i[1].slice(u).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),i[1]=i[1].slice(0,u)),r=n(l.call(this,i[1].trim(),o),o),r&&i[0]===e&&!T(r))return r;T(r)||(r=xn(r)),r||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),r=""),c.length&&(r=c.reduce((h,d)=>this.format(h,d,s.lng,{...s,interpolationkey:i[1].trim()}),r.trim())),e=e.replace(i[0],r),this.regexp.lastIndex=0}return e}}const Ur=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const s=t.split("(");e=s[0].toLowerCase().trim();const i=s[1].substring(0,s[1].length-1);e==="currency"&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),u=c.join(":").trim().replace(/^'+|'+$/g,""),h=l.trim();n[h]||(n[h]=u),u==="false"&&(n[h]=!1),u==="true"&&(n[h]=!0),isNaN(u)||(n[h]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},Rn=t=>{const e={};return(n,s,i)=>{let r=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(r={...r,[i.interpolationkey]:void 0});const o=s+JSON.stringify(r);let l=e[o];return l||(l=t(Ze(s),i),e[o]=l),l(n)}},Dr=t=>(e,n,s)=>t(Ze(n),s)(e);class Br{constructor(e={}){this.logger=le.create("formatter"),this.options=e,this.init(e)}init(e,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const s=n.cacheInBuiltFormats?Rn:Dr;this.formats={number:s((i,r)=>{const o=new Intl.NumberFormat(i,{...r});return l=>o.format(l)}),currency:s((i,r)=>{const o=new Intl.NumberFormat(i,{...r,style:"currency"});return l=>o.format(l)}),datetime:s((i,r)=>{const o=new Intl.DateTimeFormat(i,{...r});return l=>o.format(l)}),relativetime:s((i,r)=>{const o=new Intl.RelativeTimeFormat(i,{...r});return l=>o.format(l,r.range||"day")}),list:s((i,r)=>{const o=new Intl.ListFormat(i,{...r});return l=>o.format(l)})}}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=Rn(n)}format(e,n,s,i={}){const r=n.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(l=>l.indexOf(")")>-1)){const l=r.findIndex(c=>c.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,l)].join(this.formatSeparator)}return r.reduce((l,c)=>{var d;const{formatName:u,formatOptions:h}=Ur(c);if(this.formats[u]){let m=l;try{const f=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},g=f.locale||f.lng||i.locale||i.lng||s;m=this.formats[u](l,g,{...h,...i,...f})}catch(f){this.logger.warn(f)}return m}else this.logger.warn(`there was no format function for ${u}`);return l},e)}}const Fr=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class Hr extends jt{constructor(e,n,s,i={}){var r,o;super(),this.backend=e,this.store=n,this.services=s,this.languageUtils=s.languageUtils,this.options=i,this.logger=le.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(r=this.backend)==null?void 0:r.init)==null||o.call(r,s,i.backend,i)}queueLoad(e,n,s,i){const r={},o={},l={},c={};return e.forEach(u=>{let h=!0;n.forEach(d=>{const m=`${u}|${d}`;!s.reload&&this.store.hasResourceBundle(u,d)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?o[m]===void 0&&(o[m]=!0):(this.state[m]=1,h=!1,o[m]===void 0&&(o[m]=!0),r[m]===void 0&&(r[m]=!0),c[d]===void 0&&(c[d]=!0)))}),h||(l[u]=!0)}),(Object.keys(r).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(e,n,s){const i=e.split("|"),r=i[0],o=i[1];n&&this.emit("failedLoading",r,o,n),!n&&s&&this.store.addResourceBundle(r,o,s,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&s&&(this.state[e]=0);const l={};this.queue.forEach(c=>{Er(c.loaded,[r],o),Fr(c,e),n&&c.errors.push(n),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(u=>{l[u]||(l[u]={});const h=c.loaded[u];h.length&&h.forEach(d=>{l[u][d]===void 0&&(l[u][d]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(e,n,s,i=0,r=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:s,tried:i,wait:r,callback:o});return}this.readingCalls++;const l=(u,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&h&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,s,i+1,r*2,o)},r);return}o(u,h)},c=this.backend[s].bind(this.backend);if(c.length===2){try{const u=c(e,n);u&&typeof u.then=="function"?u.then(h=>l(null,h)).catch(l):l(null,u)}catch(u){l(u)}return}return c(e,n,l)}prepareLoading(e,n,s={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();T(e)&&(e=this.languageUtils.toResolveHierarchy(e)),T(n)&&(n=[n]);const r=this.queueLoad(e,n,s,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,s){this.prepareLoading(e,n,{},s)}reload(e,n,s){this.prepareLoading(e,n,{reload:!0},s)}loadOne(e,n=""){const s=e.split("|"),i=s[0],r=s[1];this.read(i,r,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${r} for language ${i} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${r} for language ${i}`,l),this.loaded(e,o,l)})}saveMissing(e,n,s,i,r,o={},l=()=>{}){var c,u,h,d,m;if((u=(c=this.services)==null?void 0:c.utils)!=null&&u.hasLoadedNamespace&&!((d=(h=this.services)==null?void 0:h.utils)!=null&&d.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${s}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if((m=this.backend)!=null&&m.create){const f={...o,isUpdate:r},g=this.backend.create.bind(this.backend);if(g.length<6)try{let v;g.length===5?v=g(e,n,s,i,f):v=g(e,n,s,i),v&&typeof v.then=="function"?v.then(x=>l(null,x)).catch(l):l(null,v)}catch(v){l(v)}else g(e,n,s,i,l,f)}!e||!e[0]||this.store.addResource(e[0],n,s,i)}}}const kn=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),T(t[1])&&(e.defaultValue=t[1]),T(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(s=>{e[s]=n[s]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),Pn=t=>{var e,n;return T(t.ns)&&(t.ns=[t.ns]),T(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),T(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:n.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},nt=()=>{},$r=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Ke extends jt{constructor(e={},n){if(super(),this.options=Pn(e),this.services={},this.logger=le,this.modules={external:[]},$r(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(e={},n){this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(T(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const s=kn();this.options={...s,...this.options,...Pn(e)},this.options.interpolation={...s.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?le.init(i(this.modules.logger),this.options):le.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=Br;const h=new Cn(this.options);this.store=new Sn(this.options.resources,this.options);const d=this.services;d.logger=le,d.resourceStore=this.store,d.languageUtils=h,d.pluralResolver=new Ar(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),u&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(d.formatter=i(u),d.formatter.init&&d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new Nn(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new Hr(i(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",(f,...g)=>{this.emit(f,...g)}),this.modules.languageDetector&&(d.languageDetector=i(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=i(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new yt(this.services,this.options),this.translator.on("*",(f,...g)=>{this.emit(f,...g)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,n||(n=nt),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=(...h)=>this.store[u](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=(...h)=>(this.store[u](...h),this)});const l=He(),c=()=>{const u=(h,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(d),n(h,d)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e,n=nt){var r,o;let s=n;const i=T(e)?e:this.language;if(typeof e=="function"&&(s=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const l=[],c=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(d=>{d!=="cimode"&&l.indexOf(d)<0&&l.push(d)})};i?c(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(h=>c(h)),(o=(r=this.options.preload)==null?void 0:r.forEach)==null||o.call(r,u=>c(u)),this.services.backendConnector.load(l,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(u)})}else s(null)}reloadResources(e,n,s){const i=He();return typeof e=="function"&&(s=e,e=void 0),typeof n=="function"&&(s=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),s||(s=nt),this.services.backendConnector.reload(e,n,r=>{i.resolve(),s(r)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&xs.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let n=0;n<this.languages.length;n++){const s=this.languages[n];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,n){this.isLanguageChangingTo=e;const s=He();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},r=(l,c)=>{c?this.isLanguageChangingTo===e&&(i(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,s.resolve((...u)=>this.t(...u)),n&&n(l,(...u)=>this.t(...u))},o=l=>{var h,d;!e&&!l&&this.services.languageDetector&&(l=[]);const c=T(l)?l:l&&l[0],u=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(T(l)?[l]:l);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),(d=(h=this.services.languageDetector)==null?void 0:h.cacheUserLanguage)==null||d.call(h,u)),this.loadResources(u,m=>{r(m,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),s}getFixedT(e,n,s){const i=(r,o,...l)=>{let c;typeof o!="object"?c=this.options.overloadTranslationOptionHandler([r,o].concat(l)):c={...o},c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||s||i.keyPrefix);const u=this.options.keySeparator||".";let h;return c.keyPrefix&&Array.isArray(r)?h=r.map(d=>(typeof d=="function"&&(d=Ht(d,{...this.options,...o})),`${c.keyPrefix}${u}${d}`)):(typeof r=="function"&&(r=Ht(r,{...this.options,...o})),h=c.keyPrefix?`${c.keyPrefix}${u}${r}`:r),this.t(h,c)};return T(e)?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=s,i}t(...e){var n;return(n=this.translator)==null?void 0:n.translate(...e)}exists(...e){var n;return(n=this.translator)==null?void 0:n.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=n.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const u=this.services.backendConnector.state[`${l}|${c}`];return u===-1||u===0||u===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(s,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(s,e)&&(!i||o(r,e)))}loadNamespaces(e,n){const s=He();return this.options.ns?(T(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{s.resolve(),n&&n(i)}),s):(n&&n(),Promise.resolve())}loadLanguages(e,n){const s=He();T(e)&&(e=[e]);const i=this.options.preload||[],r=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return r.length?(this.options.preload=i.concat(r),this.loadResources(o=>{s.resolve(),n&&n(o)}),s):(n&&n(),Promise.resolve())}dir(e){var i,r;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const l=o.getTextInfo();if(l&&l.direction)return l.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=((r=this.services)==null?void 0:r.languageUtils)||new Cn(kn());return e.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(s.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},n){const s=new Ke(e,n);return s.createInstance=Ke.createInstance,s}cloneInstance(e={},n=nt){const s=e.forkResourceStore;s&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},r=new Ke(i);if((e.debug!==void 0||e.prefix!==void 0)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(l=>{r[l]=this[l]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},s){const l=Object.keys(this.store.data).reduce((c,u)=>(c[u]={...this.store.data[u]},c[u]=Object.keys(c[u]).reduce((h,d)=>(h[d]={...c[u][d]},h),c[u]),c),{});r.store=new Sn(l,i),r.services.resourceStore=r.store}return e.interpolation&&(r.services.interpolator=new Nn(i)),r.translator=new yt(r.services,i),r.translator.on("*",(l,...c)=>{r.emit(l,...c)}),r.init(i,n),r.translator.options=i,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Z=Ke.createInstance();Z.createInstance;Z.dir;Z.init;Z.loadResources;Z.reloadResources;Z.use;Z.changeLanguage;Z.getFixedT;Z.t;Z.exists;Z.setDefaultNamespace;Z.hasLoadedNamespace;Z.loadNamespaces;Z.loadLanguages;const Gr=(t,e,n,s)=>{var r,o,l,c;const i=[n,{code:e,...s||{}}];if((o=(r=t==null?void 0:t.services)==null?void 0:r.logger)!=null&&o.forward)return t.services.logger.forward(i,"warn","react-i18next::",!0);Te(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),(c=(l=t==null?void 0:t.services)==null?void 0:l.logger)!=null&&c.warn?t.services.logger.warn(...i):console!=null&&console.warn&&console.warn(...i)},On={},bs=(t,e,n,s)=>{Te(n)&&On[n]||(Te(n)&&(On[n]=new Date),Gr(t,e,n,s))},ws=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},$t=(t,e,n)=>{t.loadNamespaces(e,ws(t,n))},Mn=(t,e,n,s)=>{if(Te(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return $t(t,n,s);n.forEach(i=>{t.options.ns.indexOf(i)<0&&t.options.ns.push(i)}),t.loadLanguages(e,ws(t,s))},Vr=(t,e,n={})=>!e.languages||!e.languages.length?(bs(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(s,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!i(s.isLanguageChangingTo,t))return!1}}),Te=t=>typeof t=="string",Wr=t=>typeof t=="object"&&t!==null,Kr=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,qr={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Zr=t=>qr[t],Xr=t=>t.replace(Kr,Zr);let Gt={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Xr};const Jr=(t={})=>{Gt={...Gt,...t}},Yr=()=>Gt;let Ss;const Qr=t=>{Ss=t},ea=()=>Ss,ta={type:"3rdParty",init(t){Jr(t.options.react),Qr(t)}},na=p.createContext();class sa{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const ia=(t,e)=>Te(e)?e:Wr(e)&&Te(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,ra={t:ia,ready:!1},aa=()=>()=>{},Re=(t,e={})=>{var O,N,A;const{i18n:n}=e,{i18n:s,defaultNS:i}=p.useContext(na)||{},r=n||s||ea();r&&!r.reportNamespaces&&(r.reportNamespaces=new sa),r||bs(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=p.useMemo(()=>{var _;return{...Yr(),...(_=r==null?void 0:r.options)==null?void 0:_.react,...e}},[r,e]),{useSuspense:l,keyPrefix:c}=o,u=i||((O=r==null?void 0:r.options)==null?void 0:O.defaultNS),h=Te(u)?[u]:u||["translation"],d=p.useMemo(()=>h,h);(A=(N=r==null?void 0:r.reportNamespaces)==null?void 0:N.addUsedNamespaces)==null||A.call(N,d);const m=p.useRef(0),f=p.useCallback(_=>{if(!r)return aa;const{bindI18n:y,bindI18nStore:E}=o,M=()=>{m.current+=1,_()};return y&&r.on(y,M),E&&r.store.on(E,M),()=>{y&&y.split(" ").forEach(k=>r.off(k,M)),E&&E.split(" ").forEach(k=>r.store.off(k,M))}},[r,o]),g=p.useRef(),v=p.useCallback(()=>{if(!r)return ra;const _=!!(r.isInitialized||r.initializedStoreOnce)&&d.every(Q=>Vr(Q,r,o)),y=e.lng||r.language,E=m.current,M=g.current;if(M&&M.ready===_&&M.lng===y&&M.keyPrefix===c&&M.revision===E)return M;const F={t:r.getFixedT(y,o.nsMode==="fallback"?d:d[0],c),ready:_,lng:y,keyPrefix:c,revision:E};return g.current=F,F},[r,d,c,o,e.lng]),[x,w]=p.useState(0),{t:S,ready:b}=$s.useSyncExternalStore(f,v,v);p.useEffect(()=>{if(r&&!b&&!l){const _=()=>w(y=>y+1);e.lng?Mn(r,e.lng,d,_):$t(r,d,_)}},[r,e.lng,d,b,l,x]);const C=r||{},I=p.useRef(null),B=p.useRef(),D=_=>{const y=Object.getOwnPropertyDescriptors(_);y.__original&&delete y.__original;const E=Object.create(Object.getPrototypeOf(_),y);if(!Object.prototype.hasOwnProperty.call(E,"__original"))try{Object.defineProperty(E,"__original",{value:_,writable:!1,enumerable:!1,configurable:!1})}catch{}return E},H=p.useMemo(()=>{const _=C,y=_==null?void 0:_.language;let E=_;_&&(I.current&&I.current.__original===_?B.current!==y?(E=D(_),I.current=E,B.current=y):E=I.current:(E=D(_),I.current=E,B.current=y));const M=[S,E,b];return M.t=S,M.i18n=E,M.ready=b,M},[S,C,b,C.resolvedLanguage,C.language,C.languages]);if(r&&l&&!b)throw new Promise(_=>{const y=()=>_();e.lng?Mn(r,e.lng,d,y):$t(r,d,y)});return H},kt=[{code:"zh",name:"",dir:"ltr"},{code:"en",name:"English",dir:"ltr"},{code:"fr",name:"Franais",dir:"ltr"},{code:"ja",name:"",dir:"ltr"},{code:"ko",name:"",dir:"ltr"}],zn=()=>{const{i18n:t}=Re(),[e,n]=W.useState(!1);p.useEffect(()=>{const i=kt.find(r=>r.code===t.language)||kt[0];document.body.dir=i.dir,document.documentElement.lang=i.code},[t.language]);const s=i=>{t.changeLanguage(i),n(!1)};return a.jsxs("div",{className:"relative z-50",children:[a.jsxs("button",{onClick:()=>n(!e),className:"flex items-center gap-2 text-gray-300 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:[a.jsx(ns,{className:"w-5 h-5"}),a.jsx("span",{className:"uppercase font-medium text-sm",children:t.language.split("-")[0]})]}),a.jsx(re,{children:e&&a.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute right-0 mt-2 w-40 bg-neutral-900 border border-white/10 rounded-lg shadow-xl overflow-hidden",children:kt.map(i=>a.jsxs("button",{onClick:()=>s(i.code),className:`w-full text-left px-4 py-3 text-sm hover:bg-white/10 transition-colors flex items-center justify-between
                  ${t.language===i.code?"text-white bg-white/5 font-bold":"text-gray-400"}`,children:[i.name,t.language===i.code&&a.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})]},i.code))})})]})},js=({isOpen:t,onClose:e})=>{const{t:n}=Re(),[s,i]=p.useState(!0),[r,o]=p.useState(""),[l,c]=p.useState(""),[u,h]=p.useState(!1),{login:d,register:m}=Qe(),f=async g=>{if(g.preventDefault(),!r||!l)return;h(!0);const v=s?await d(r,l):await m(r,l);h(!1),v&&(e(),o(""),c(""))};return t?Zt.createPortal(a.jsx(re,{children:a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-md bg-[#1a1a1a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden p-8 z-10",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 opacity-50 pointer-events-none"}),a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20",children:a.jsx(we,{size:20})}),a.jsxs("div",{className:"text-center mb-8 relative z-10",children:[a.jsx("h2",{className:"text-3xl font-bold text-white mb-2 tracking-tight",children:n(s?"auth.welcome_back":"auth.join_lumos")}),a.jsx("p",{className:"text-gray-400 text-sm",children:n(s?"auth.signin_desc":"auth.signup_desc")})]}),a.jsxs("form",{onSubmit:f,className:"space-y-5 relative z-10",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-indigo-400 uppercase mb-2 tracking-wider",children:n("auth.username")}),a.jsxs("div",{className:"relative group",children:[a.jsx(Yt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 group-focus-within:text-indigo-400 transition-colors",size:18}),a.jsx("input",{type:"text",value:r,onChange:g=>o(g.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/60",placeholder:n("auth.enter_username")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-indigo-400 uppercase mb-2 tracking-wider",children:n("auth.password")}),a.jsxs("div",{className:"relative group",children:[a.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 group-focus-within:text-indigo-400 transition-colors",size:18}),a.jsx("input",{type:"password",value:l,onChange:g=>c(g.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/60",placeholder:n("auth.enter_password")})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3.5 rounded-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed mt-8 shadow-lg shadow-indigo-500/25 active:scale-[0.98]",children:u?a.jsx(is,{className:"animate-spin",size:20}):a.jsxs(a.Fragment,{children:[n(s?"auth.sign_in":"auth.create_account"),a.jsx(rs,{size:18})]})})]}),a.jsxs("div",{className:"mt-8 text-center text-sm text-gray-400 relative z-10",children:[n(s?"auth.no_account":"auth.has_account"),a.jsx("button",{onClick:()=>i(!s),className:"text-white hover:text-indigo-400 font-bold ml-1 transition-colors underline decoration-indigo-500/50 hover:decoration-indigo-500",children:n(s?"auth.sign_up":"auth.log_in")})]})]})]})}),document.body):null},Pt=({value:t,onChange:e,options:n,placeholder:s="Select...",icon:i,className:r="",buttonClassName:o="",menuClassName:l=""})=>{const[c,u]=p.useState(!1),h=p.useRef(null);p.useEffect(()=>{const m=f=>{h.current&&!h.current.contains(f.target)&&u(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const d=n.find(m=>m.value===t);return a.jsxs("div",{className:`relative ${r}`,ref:h,style:{zIndex:c?50:1},children:[a.jsxs("button",{type:"button",onClick:()=>u(!c),className:`flex items-center justify-between gap-2 w-full bg-black/20 border border-white/10 rounded-xl px-4 py-2.5 text-white focus:outline-none focus:border-indigo-500/50 transition-all hover:bg-white/5 ${o}`,children:[a.jsxs("div",{className:"flex items-center gap-2 truncate",children:[i&&a.jsx(i,{size:16,className:"text-gray-400"}),a.jsx("span",{className:d?"text-white":"text-gray-400",children:d?d.label:s})]}),a.jsx(ci,{size:16,className:`text-gray-400 transition-transform duration-300 ${c?"rotate-180":""}`})]}),a.jsx(re,{children:c&&a.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:`absolute top-full right-0 mt-2 w-full min-w-[160px] bg-[#1a1a1a] border border-white/10 rounded-xl shadow-2xl overflow-hidden z-[100] ${l}`,children:a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-1",children:n.map(m=>a.jsxs("button",{type:"button",onClick:()=>{e(m.value),u(!1)},className:`w-full flex items-center justify-between px-3 py-2.5 text-sm rounded-lg transition-colors mb-0.5 last:mb-0 ${t===m.value?"bg-indigo-600 text-white":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:[a.jsx("span",{className:"truncate",children:m.label}),t===m.value&&a.jsx(ui,{size:14})]},m.value))})})})]})},oa=({itemId:t,itemType:e,initialFavorited:n=!1,favorited:s,className:i="",size:r=20,showCount:o=!1,count:l=0,onToggle:c})=>{const[u,h]=p.useState(n),[d,m]=p.useState(!1),[f,g]=p.useState(typeof l=="number"?l:0),{user:v}=Qe();p.useEffect(()=>{s!==void 0&&h(s)},[s]),p.useEffect(()=>{g(typeof l=="number"?l:0)},[l]),p.useEffect(()=>{let w=!0;return v?(async()=>{if(!(!v||!t||!e))try{const b=await U.get(`/favorites/check?itemId=${t}&itemType=${e}`);w&&h(b.data.favorited)}catch(b){console.error("Failed to check favorite status",b)}})():h(!1),()=>{w=!1}},[t,e,v]);const x=async w=>{if(w.preventDefault(),w.stopPropagation(),!v){X.error("");return}if(d)return;const S=u,b=f;h(!S),g(S?Math.max(0,b-1):b+1),m(!0);try{const C=await U.post("/favorites/toggle",{itemId:t,itemType:e});h(C.data.favorited),typeof C.data.likes=="number"&&g(C.data.likes),C.data.favorited,c&&c(C.data.favorited,C.data.likes)}catch(C){h(S),g(b),X.error(""),console.error(C)}finally{m(!1)}};return a.jsxs(L.button,{whileTap:{scale:.8},onClick:x,className:`relative flex items-center justify-center transition-colors ${i} ${u?"text-red-500":"text-gray-400 hover:text-red-400"}`,disabled:d,children:[a.jsx(re,{mode:"wait",children:u?a.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{type:"spring",stiffness:300,damping:20},children:a.jsx(ht,{size:r,fill:"currentColor"})},"filled"):a.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:a.jsx(ht,{size:r})},"outline")}),o&&f>0&&a.jsx("span",{className:"ml-1 text-[10px]",children:f})]})},la=({isOpen:t,onClose:e})=>{var se;const{user:n,logout:s}=Qe(),{t:i}=Re(),[r,o]=p.useState("profile"),[l,c]=p.useState([]),[u,h]=p.useState([]),[d,m]=p.useState(!1),[f,g]=p.useState(!1),[v,x]=p.useState("photos"),[w,S]=p.useState("photo"),[b,C]=p.useState({avatar:"",nickname:"",gender:"",age:"",organization:"",inviteCode:""}),[I,B]=p.useState(!1),[D,H]=p.useState(""),[O,N]=p.useState(""),[A,_]=p.useState(""),[y,E]=p.useState(!1);p.useEffect(()=>{t&&n&&C({avatar:n.avatar||"",nickname:n.nickname||"",gender:n.gender||"",age:n.age||"",organization:n.organization||"",inviteCode:""}),t&&r==="uploads"&&n&&M(),t&&r==="favorites"&&n&&k()},[t,r,v,w,n]);const M=async()=>{m(!0);try{const j=await U.get(`/${v}?uploader_id=${n.id}&status=all&limit=50`);c(j.data.data||[])}catch(j){console.error(j),X.error(i("common.error_fetching_data"))}finally{m(!1)}},k=async()=>{g(!0);try{const j=await U.get(`/favorites?type=${w}`);h(j.data||[])}catch{}finally{g(!1)}},F=()=>{s(),e(),X.success(i("user_profile.logout"))},Q=W.useRef(!1),me=async j=>{var ae,Se;if(j.preventDefault(),!Q.current){Q.current=!0,B(!0);try{const de={...b,organization_cr:b.organization,invitation_code:b.inviteCode};de.age||delete de.age,await U.put("/auth/profile",de),X.success(i("user_profile.profile_updated")),await refreshUser()}catch(de){X.error(((Se=(ae=de.response)==null?void 0:ae.data)==null?void 0:Se.error)||i("admin.toast.update_fail"))}finally{B(!1),Q.current=!1}}},te=async j=>{var ae,Se;if(j.preventDefault(),O!==A){X.error(i("user_profile.security.password_mismatch"));return}E(!0);try{await U.put("/auth/password",{currentPassword:D,newPassword:O}),X.success(i("user_profile.security.update_success")),H(""),N(""),_("")}catch(de){X.error(((Se=(ae=de.response)==null?void 0:ae.data)==null?void 0:Se.message)||i("user_profile.security.update_fail"))}finally{E(!1)}};if(!t||!n)return null;const $=[{value:"photos",label:i("nav.gallery"),icon:ft},{value:"music",label:i("nav.music"),icon:qe},{value:"videos",label:i("nav.videos"),icon:pt},{value:"articles",label:i("nav.articles"),icon:mt},{value:"events",label:i("nav.events"),icon:gt}],ne=[{value:"photo",label:i("nav.gallery"),icon:ft},{value:"music",label:i("nav.music"),icon:qe},{value:"video",label:i("nav.videos"),icon:pt},{value:"article",label:i("nav.articles"),icon:mt},{value:"event",label:i("nav.events"),icon:gt}];return Zt.createPortal(a.jsx(re,{children:a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[a.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-4xl bg-[#1a1a1a] border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col md:flex-row h-[85vh] md:h-[600px] z-10",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-purple-500/5 opacity-50 pointer-events-none"}),a.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20 md:hidden",children:a.jsx(we,{size:20})}),a.jsxs("div",{className:"w-full md:w-64 bg-black/20 border-b md:border-b-0 md:border-r border-white/10 p-4 md:p-6 flex flex-col relative z-10 shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4 md:mb-8",children:[a.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg md:text-xl shrink-0",children:(se=n==null?void 0:n.username)==null?void 0:se.charAt(0).toUpperCase()}),a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("h3",{className:"text-white font-bold truncate text-sm md:text-base",children:n==null?void 0:n.username}),a.jsx("p",{className:"text-xs text-gray-400 truncate",children:n==null?void 0:n.email})]})]}),a.jsxs("nav",{className:"grid grid-cols-2 gap-2 md:flex md:flex-col md:space-y-2 flex-1 mb-4 md:mb-0",children:[a.jsxs("button",{onClick:()=>o("profile"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${r==="profile"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(Yt,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",i("user_profile.tabs.profile")]}),a.jsxs("button",{onClick:()=>o("uploads"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${r==="uploads"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(ln,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",i("user_profile.tabs.uploads")]}),a.jsxs("button",{onClick:()=>o("favorites"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${r==="favorites"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(ht,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",i("user_profile.tabs.favorites")]}),a.jsxs("button",{onClick:()=>o("security"),className:`w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 transition-colors text-sm md:text-base ${r==="security"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.jsx(ss,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",i("user_profile.tabs.security")]})]}),a.jsxs("button",{onClick:F,className:"mt-auto w-full text-left px-3 py-2 md:px-4 md:py-3 rounded-xl flex items-center gap-2 md:gap-3 text-red-400 hover:bg-red-500/10 transition-colors text-sm md:text-base",children:[a.jsx(di,{size:16,className:"md:w-[18px] md:h-[18px]"})," ",i("user_profile.logout")]})]}),a.jsx("div",{className:"flex-1 p-6 md:p-8 overflow-y-auto custom-scrollbar relative z-10 bg-[#1a1a1a]",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[r==="profile"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:i("user_profile.tabs.profile")}),a.jsxs("form",{onSubmit:me,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.fields.avatar")}),a.jsx("input",{type:"text",value:b.avatar,onChange:j=>C({...b,avatar:j.target.value}),placeholder:i("user_profile.fields.avatar_placeholder"),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.fields.nickname")}),a.jsx("input",{type:"text",value:b.nickname,onChange:j=>C({...b,nickname:j.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.fields.gender")}),a.jsx(Pt,{value:b.gender,onChange:j=>C({...b,gender:j}),options:[{value:"male",label:i("user_profile.gender.male")},{value:"female",label:i("user_profile.gender.female")},{value:"other",label:i("user_profile.gender.other")}],placeholder:i("common.select"),buttonClassName:"bg-black/20 border-white/10 w-full py-3"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.fields.age")}),a.jsx("input",{type:"number",value:b.age,onChange:j=>C({...b,age:j.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"})]})]}),a.jsxs("div",{className:"pt-4 border-t border-white/10",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.fields.organization")}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("input",{type:"text",value:b.organization,onChange:j=>C({...b,organization:j.target.value}),placeholder:i("user_profile.fields.org_placeholder"),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"}),a.jsx("input",{type:"text",value:b.inviteCode,onChange:j=>C({...b,inviteCode:j.target.value}),placeholder:i("user_profile.fields.invite_code_hint"),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:i("user_profile.fields.org_help")})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{type:"submit",disabled:I,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold transition-colors disabled:opacity-50",children:i(I?"common.saving":"common.save")})})]}),a.jsx("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/10 mt-8",children:a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:i("user_profile.profile.username")}),a.jsx("p",{className:"font-bold text-white text-lg",children:n==null?void 0:n.username})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:i("user_profile.profile.role")}),a.jsx("p",{className:"font-bold text-white text-lg uppercase",children:i(`user_profile.roles.${n==null?void 0:n.role}`)||(n==null?void 0:n.role)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:i("user_profile.profile.joined")}),a.jsx("p",{className:"font-bold text-white",children:new Date((n==null?void 0:n.created_at)||Date.now()).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:i("user_profile.profile.id")}),a.jsxs("p",{className:"font-bold text-white font-mono",children:["#",n==null?void 0:n.id]})]})]})})]}),r==="uploads"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:i("user_profile.uploads.title")}),a.jsx("div",{className:"w-40",children:a.jsx(Pt,{value:v,onChange:x,options:$,buttonClassName:"bg-black/40 border-white/10 w-full"})})]}),d?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):l.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500 bg-black/20 rounded-xl border border-white/5 border-dashed",children:[a.jsx(ln,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:i("user_profile.uploads.no_uploads")})]}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.map(j=>a.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-black/50 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:j.cover||j.thumbnail||j.url||j.image,alt:j.title,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-white truncate",children:j.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:new Date(j.created_at||Date.now()).toLocaleDateString()})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${j.status==="approved"?"bg-green-500/20 text-green-400":j.status==="rejected"?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:i(`user_profile.uploads.status.${j.status}`)||j.status})})]},j.id))})]}),r==="favorites"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:i("user_profile.favorites.title")}),a.jsx("div",{className:"w-40",children:a.jsx(Pt,{value:w,onChange:S,options:ne,buttonClassName:"bg-black/40 border-white/10 w-full"})})]}),f?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}):u.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500 bg-black/20 rounded-xl border border-white/5 border-dashed",children:[a.jsx(ht,{size:48,className:"mx-auto mb-4 opacity-20"}),a.jsx("p",{children:i("user_profile.favorites.no_favorites")})]}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:u.map(j=>a.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[a.jsx("div",{className:"w-16 h-16 rounded-lg bg-black/50 overflow-hidden flex-shrink-0",children:a.jsx("img",{src:j.cover||j.thumbnail||j.url||j.image,alt:j.title,className:"w-full h-full object-cover"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-white truncate",children:j.title}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:j.artist||j.category})]}),a.jsx(oa,{itemId:j.id,itemType:w,initialFavorited:!0,size:18,showCount:!1,className:"p-2 hover:bg-white/10 rounded-full transition-colors",onToggle:ae=>{ae||h(Se=>Se.filter(de=>de.id!==j.id))}})]},j.id))})]}),r==="security"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-6",children:i("user_profile.security.title")}),a.jsxs("form",{onSubmit:te,className:"bg-white/5 rounded-2xl p-6 border border-white/10 space-y-4",children:[a.jsx("h4",{className:"text-lg font-bold text-white mb-4",children:i("user_profile.security.change_password")}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.security.current_password")}),a.jsx("input",{type:"password",value:D,onChange:j=>H(j.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.security.new_password")}),a.jsx("input",{type:"password",value:O,onChange:j=>N(j.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0,minLength:6})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:i("user_profile.security.confirm_password")}),a.jsx("input",{type:"password",value:A,onChange:j=>_(j.target.value),className:"w-full bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-indigo-500",required:!0,minLength:6})]}),a.jsx("button",{type:"submit",disabled:y,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50",children:i(y?"user_profile.security.updating":"user_profile.security.update_btn")})]})]})]})})]})]})}),document.body)},ca=[{id:"bj",name:"",name_en:"Beijing",lat:39.9042,lon:116.4074,country:"China",admin1:"Beijing"},{id:"sh",name:"",name_en:"Shanghai",lat:31.2304,lon:121.4737,country:"China",admin1:"Shanghai"},{id:"tj",name:"",name_en:"Tianjin",lat:39.0842,lon:117.2008,country:"China",admin1:"Tianjin"},{id:"cq",name:"",name_en:"Chongqing",lat:29.563,lon:106.5516,country:"China",admin1:"Chongqing"},{id:"hz",name:"",name_en:"Hangzhou",lat:30.2741,lon:120.1551,country:"China",admin1:"Zhejiang"},{id:"nb",name:"",name_en:"Ningbo",lat:29.8683,lon:121.544,country:"China",admin1:"Zhejiang"},{id:"wz",name:"",name_en:"Wenzhou",lat:27.9943,lon:120.6994,country:"China",admin1:"Zhejiang"},{id:"jx",name:"",name_en:"Jiaxing",lat:30.7539,lon:120.7525,country:"China",admin1:"Zhejiang"},{id:"huz",name:"",name_en:"Huzhou",lat:30.8943,lon:120.0868,country:"China",admin1:"Zhejiang"},{id:"sx",name:"",name_en:"Shaoxing",lat:30.0016,lon:120.5753,country:"China",admin1:"Zhejiang"},{id:"jh",name:"",name_en:"Jinhua",lat:29.1054,lon:119.6495,country:"China",admin1:"Zhejiang"},{id:"qz",name:"",name_en:"Quzhou",lat:28.9355,lon:118.8758,country:"China",admin1:"Zhejiang"},{id:"zs",name:"",name_en:"Zhoushan",lat:29.9855,lon:122.2066,country:"China",admin1:"Zhejiang"},{id:"tz_zj",name:"",name_en:"Taizhou",lat:28.6564,lon:121.4208,country:"China",admin1:"Zhejiang"},{id:"ls",name:"",name_en:"Lishui",lat:28.4677,lon:119.9218,country:"China",admin1:"Zhejiang"},{id:"nj",name:"",name_en:"Nanjing",lat:32.0603,lon:118.7969,country:"China",admin1:"Jiangsu"},{id:"wx",name:"",name_en:"Wuxi",lat:31.4912,lon:120.3119,country:"China",admin1:"Jiangsu"},{id:"xz",name:"",name_en:"Xuzhou",lat:34.2044,lon:117.2837,country:"China",admin1:"Jiangsu"},{id:"cz",name:"",name_en:"Changzhou",lat:31.8127,lon:119.9741,country:"China",admin1:"Jiangsu"},{id:"su",name:"",name_en:"Suzhou",lat:31.2989,lon:120.5853,country:"China",admin1:"Jiangsu"},{id:"nt",name:"",name_en:"Nantong",lat:31.9802,lon:120.8943,country:"China",admin1:"Jiangsu"},{id:"lyg",name:"",name_en:"Lianyungang",lat:34.5967,lon:119.2216,country:"China",admin1:"Jiangsu"},{id:"ha",name:"",name_en:"Huai'an",lat:33.589,lon:119.1438,country:"China",admin1:"Jiangsu"},{id:"yc",name:"",name_en:"Yancheng",lat:33.3473,lon:120.1636,country:"China",admin1:"Jiangsu"},{id:"yz",name:"",name_en:"Yangzhou",lat:32.3942,lon:119.4129,country:"China",admin1:"Jiangsu"},{id:"zj",name:"",name_en:"Zhenjiang",lat:32.2109,lon:119.4613,country:"China",admin1:"Jiangsu"},{id:"tz_js",name:"",name_en:"Taizhou",lat:32.4555,lon:119.9229,country:"China",admin1:"Jiangsu"},{id:"sq",name:"",name_en:"Suqian",lat:33.963,lon:118.2753,country:"China",admin1:"Jiangsu"},{id:"gz",name:"",name_en:"Guangzhou",lat:23.1291,lon:113.2644,country:"China",admin1:"Guangdong"},{id:"sz",name:"",name_en:"Shenzhen",lat:22.5431,lon:114.0579,country:"China",admin1:"Guangdong"},{id:"zh",name:"",name_en:"Zhuhai",lat:22.2707,lon:113.5767,country:"China",admin1:"Guangdong"},{id:"st",name:"",name_en:"Shantou",lat:23.3517,lon:116.6636,country:"China",admin1:"Guangdong"},{id:"fs",name:"",name_en:"Foshan",lat:23.0215,lon:113.1214,country:"China",admin1:"Guangdong"},{id:"sg",name:"",name_en:"Shaoguan",lat:24.8104,lon:113.5975,country:"China",admin1:"Guangdong"},{id:"zj_gd",name:"",name_en:"Zhanjiang",lat:21.1968,lon:110.4032,country:"China",admin1:"Guangdong"},{id:"zq",name:"",name_en:"Zhaoqing",lat:23.0511,lon:112.4674,country:"China",admin1:"Guangdong"},{id:"jm",name:"",name_en:"Jiangmen",lat:22.5787,lon:113.0816,country:"China",admin1:"Guangdong"},{id:"mm",name:"",name_en:"Maoming",lat:21.662,lon:110.9254,country:"China",admin1:"Guangdong"},{id:"hz_gd",name:"",name_en:"Huizhou",lat:23.1118,lon:114.4156,country:"China",admin1:"Guangdong"},{id:"mz",name:"",name_en:"Meizhou",lat:24.2886,lon:116.1225,country:"China",admin1:"Guangdong"},{id:"sw",name:"",name_en:"Shanwei",lat:22.7876,lon:115.3752,country:"China",admin1:"Guangdong"},{id:"hy",name:"",name_en:"Heyuan",lat:23.7431,lon:114.7006,country:"China",admin1:"Guangdong"},{id:"yj",name:"",name_en:"Yangjiang",lat:21.8572,lon:111.9822,country:"China",admin1:"Guangdong"},{id:"qy",name:"",name_en:"Qingyuan",lat:23.682,lon:113.0561,country:"China",admin1:"Guangdong"},{id:"dg",name:"",name_en:"Dongguan",lat:23.0208,lon:113.7518,country:"China",admin1:"Guangdong"},{id:"zs_gd",name:"",name_en:"Zhongshan",lat:22.5167,lon:113.3928,country:"China",admin1:"Guangdong"},{id:"cz_gd",name:"",name_en:"Chaozhou",lat:23.6669,lon:116.629,country:"China",admin1:"Guangdong"},{id:"jy",name:"",name_en:"Jieyang",lat:23.5417,lon:116.3668,country:"China",admin1:"Guangdong"},{id:"yf",name:"",name_en:"Yunfu",lat:22.915,lon:112.0445,country:"China",admin1:"Guangdong"},{id:"cd",name:"",name_en:"Chengdu",lat:30.5728,lon:104.0668,country:"China",admin1:"Sichuan"},{id:"zg",name:"",name_en:"Zigong",lat:29.3527,lon:104.7784,country:"China",admin1:"Sichuan"},{id:"pzh",name:"",name_en:"Panzhihua",lat:26.5823,lon:101.7186,country:"China",admin1:"Sichuan"},{id:"lz_sc",name:"",name_en:"Luzhou",lat:28.8724,lon:105.4405,country:"China",admin1:"Sichuan"},{id:"dy",name:"",name_en:"Deyang",lat:31.1271,lon:104.3978,country:"China",admin1:"Sichuan"},{id:"my",name:"",name_en:"Mianyang",lat:31.4674,lon:104.6791,country:"China",admin1:"Sichuan"},{id:"gy",name:"",name_en:"Guangyuan",lat:32.4412,lon:105.8434,country:"China",admin1:"Sichuan"},{id:"sn",name:"",name_en:"Suining",lat:30.5328,lon:105.5929,country:"China",admin1:"Sichuan"},{id:"nj_sc",name:"",name_en:"Neijiang",lat:29.587,lon:105.0584,country:"China",admin1:"Sichuan"},{id:"ls_sc",name:"",name_en:"Leshan",lat:29.5605,lon:103.7657,country:"China",admin1:"Sichuan"},{id:"nc_sc",name:"",name_en:"Nanchong",lat:30.7991,lon:106.0823,country:"China",admin1:"Sichuan"},{id:"ms",name:"",name_en:"Meishan",lat:30.0483,lon:103.8318,country:"China",admin1:"Sichuan"},{id:"yb",name:"",name_en:"Yibin",lat:28.7518,lon:104.6419,country:"China",admin1:"Sichuan"},{id:"ga",name:"",name_en:"Guang'an",lat:30.4561,lon:106.6334,country:"China",admin1:"Sichuan"},{id:"dz",name:"",name_en:"Dazhou",lat:31.2096,lon:107.5023,country:"China",admin1:"Sichuan"},{id:"ya",name:"",name_en:"Ya'an",lat:29.9803,lon:103.001,country:"China",admin1:"Sichuan"},{id:"bz",name:"",name_en:"Bazhong",lat:31.8588,lon:106.7537,country:"China",admin1:"Sichuan"},{id:"zy",name:"",name_en:"Ziyang",lat:30.1289,lon:104.6276,country:"China",admin1:"Sichuan"},{id:"fz",name:"",name_en:"Fuzhou",lat:26.0745,lon:119.2965,country:"China",admin1:"Fujian"},{id:"xm",name:"",name_en:"Xiamen",lat:24.4798,lon:118.0894,country:"China",admin1:"Fujian"},{id:"pt",name:"",name_en:"Putian",lat:25.431,lon:119.0076,country:"China",admin1:"Fujian"},{id:"sm",name:"",name_en:"Sanming",lat:26.2634,lon:117.6386,country:"China",admin1:"Fujian"},{id:"qz_fj",name:"",name_en:"Quanzhou",lat:24.9147,lon:118.5868,country:"China",admin1:"Fujian"},{id:"zz_fj",name:"",name_en:"Zhangzhou",lat:24.5126,lon:117.6475,country:"China",admin1:"Fujian"},{id:"np",name:"",name_en:"Nanping",lat:26.6436,lon:118.1784,country:"China",admin1:"Fujian"},{id:"ly",name:"",name_en:"Longyan",lat:25.0787,lon:117.0173,country:"China",admin1:"Fujian"},{id:"nd",name:"",name_en:"Ningde",lat:26.6656,lon:119.527,country:"China",admin1:"Fujian"},{id:"jn",name:"",name_en:"Jinan",lat:36.6512,lon:117.1201,country:"China",admin1:"Shandong"},{id:"qd",name:"",name_en:"Qingdao",lat:36.0671,lon:120.3826,country:"China",admin1:"Shandong"},{id:"zb",name:"",name_en:"Zibo",lat:36.8133,lon:118.055,country:"China",admin1:"Shandong"},{id:"zz_sd",name:"",name_en:"Zaozhuang",lat:34.8693,lon:117.5537,country:"China",admin1:"Shandong"},{id:"dy_sd",name:"",name_en:"Dongying",lat:37.4348,lon:118.6741,country:"China",admin1:"Shandong"},{id:"yt",name:"",name_en:"Yantai",lat:37.5398,lon:121.3914,country:"China",admin1:"Shandong"},{id:"wf",name:"",name_en:"Weifang",lat:36.7072,lon:119.1617,country:"China",admin1:"Shandong"},{id:"jn_sd",name:"",name_en:"Jining",lat:35.415,lon:116.5872,country:"China",admin1:"Shandong"},{id:"ta",name:"",name_en:"Tai'an",lat:36.2001,lon:117.0877,country:"China",admin1:"Shandong"},{id:"wh_sd",name:"",name_en:"Weihai",lat:37.513,lon:122.1204,country:"China",admin1:"Shandong"},{id:"rz",name:"",name_en:"Rizhao",lat:35.4164,lon:119.527,country:"China",admin1:"Shandong"},{id:"lw",name:"",name_en:"Laiwu",lat:36.2136,lon:117.6767,country:"China",admin1:"Shandong"},{id:"ly_sd",name:"",name_en:"Linyi",lat:35.0606,lon:118.3523,country:"China",admin1:"Shandong"},{id:"dz_sd",name:"",name_en:"Dezhou",lat:37.4354,lon:116.3574,country:"China",admin1:"Shandong"},{id:"lc",name:"",name_en:"Liaocheng",lat:36.456,lon:115.9855,country:"China",admin1:"Shandong"},{id:"bz_sd",name:"",name_en:"Binzhou",lat:37.382,lon:117.9701,country:"China",admin1:"Shandong"},{id:"hz_sd",name:"",name_en:"Heze",lat:35.2437,lon:115.4806,country:"China",admin1:"Shandong"},{id:"wh",name:"",name_en:"Wuhan",lat:30.5928,lon:114.3055,country:"China",admin1:"Hubei"},{id:"hs",name:"",name_en:"Huangshi",lat:30.2261,lon:115.0413,country:"China",admin1:"Hubei"},{id:"sy_hb",name:"",name_en:"Shiyan",lat:32.6475,lon:110.7993,country:"China",admin1:"Hubei"},{id:"yc_hb",name:"",name_en:"Yichang",lat:30.692,lon:111.2865,country:"China",admin1:"Hubei"},{id:"xy",name:"",name_en:"Xiangyang",lat:32.0082,lon:112.1224,country:"China",admin1:"Hubei"},{id:"ez",name:"",name_en:"Ezhou",lat:30.3939,lon:114.8906,country:"China",admin1:"Hubei"},{id:"jm_hb",name:"",name_en:"Jingmen",lat:31.0354,lon:112.1999,country:"China",admin1:"Hubei"},{id:"xg",name:"",name_en:"Xiaogan",lat:30.9168,lon:113.9556,country:"China",admin1:"Hubei"},{id:"jz",name:"",name_en:"Jingzhou",lat:30.3342,lon:112.2393,country:"China",admin1:"Hubei"},{id:"hg",name:"",name_en:"Huanggang",lat:30.4539,lon:114.8726,country:"China",admin1:"Hubei"},{id:"xn",name:"",name_en:"Xianning",lat:29.8414,lon:114.3225,country:"China",admin1:"Hubei"},{id:"sz_hb",name:"",name_en:"Suizhou",lat:31.7175,lon:113.3826,country:"China",admin1:"Hubei"},{id:"es",name:"",name_en:"Enshi",lat:30.295,lon:109.4792,country:"China",admin1:"Hubei"},{id:"cs",name:"",name_en:"Changsha",lat:28.2282,lon:112.9388,country:"China",admin1:"Hunan"},{id:"zz_hn",name:"",name_en:"Zhuzhou",lat:27.8307,lon:113.1348,country:"China",admin1:"Hunan"},{id:"xt",name:"",name_en:"Xiangtan",lat:27.8297,lon:112.944,country:"China",admin1:"Hunan"},{id:"hy_hn",name:"",name_en:"Hengyang",lat:26.8968,lon:112.5721,country:"China",admin1:"Hunan"},{id:"sy_hn",name:"",name_en:"Shaoyang",lat:27.2389,lon:111.4693,country:"China",admin1:"Hunan"},{id:"yy",name:"",name_en:"Yueyang",lat:29.3567,lon:113.129,country:"China",admin1:"Hunan"},{id:"cd_hn",name:"",name_en:"Changde",lat:29.0317,lon:111.6985,country:"China",admin1:"Hunan"},{id:"zjj",name:"",name_en:"Zhangjiajie",lat:29.117,lon:110.4792,country:"China",admin1:"Hunan"},{id:"iy",name:"",name_en:"Yiyang",lat:28.588,lon:112.355,country:"China",admin1:"Hunan"},{id:"cz_hn",name:"",name_en:"Chenzhou",lat:25.7705,lon:113.0145,country:"China",admin1:"Hunan"},{id:"yz_hn",name:"",name_en:"Yongzhou",lat:26.4204,lon:111.6134,country:"China",admin1:"Hunan"},{id:"hh",name:"",name_en:"Huaihua",lat:27.5496,lon:109.9985,country:"China",admin1:"Hunan"},{id:"ld",name:"",name_en:"Loudi",lat:27.7017,lon:111.9962,country:"China",admin1:"Hunan"},{id:"xx",name:"",name_en:"Xiangxi",lat:28.3125,lon:109.7397,country:"China",admin1:"Hunan"},{id:"hf",name:"",name_en:"Hefei",lat:31.8206,lon:117.2272,country:"China",admin1:"Anhui"},{id:"wh_ah",name:"",name_en:"Wuhu",lat:31.3528,lon:118.4331,country:"China",admin1:"Anhui"},{id:"bb",name:"",name_en:"Bengbu",lat:32.9163,lon:117.3897,country:"China",admin1:"Anhui"},{id:"hn",name:"",name_en:"Huainan",lat:32.6255,lon:116.9969,country:"China",admin1:"Anhui"},{id:"mas",name:"",name_en:"Ma'anshan",lat:31.67,lon:118.506,country:"China",admin1:"Anhui"},{id:"hb",name:"",name_en:"Huaibei",lat:33.9558,lon:116.7983,country:"China",admin1:"Anhui"},{id:"tl",name:"",name_en:"Tongling",lat:30.9455,lon:117.8115,country:"China",admin1:"Anhui"},{id:"aq",name:"",name_en:"Anqing",lat:30.5354,lon:117.116,country:"China",admin1:"Anhui"},{id:"hs_ah",name:"",name_en:"Huangshan",lat:29.7147,lon:118.3375,country:"China",admin1:"Anhui"},{id:"cz_ah",name:"",name_en:"Chuzhou",lat:32.3017,lon:118.3163,country:"China",admin1:"Anhui"},{id:"fy",name:"",name_en:"Fuyang",lat:32.8901,lon:115.8142,country:"China",admin1:"Anhui"},{id:"sz_ah",name:"",name_en:"Suzhou",lat:33.6393,lon:116.9773,country:"China",admin1:"Anhui"},{id:"la",name:"",name_en:"Lu'an",lat:31.7444,lon:116.5077,country:"China",admin1:"Anhui"},{id:"bz_ah",name:"",name_en:"Bozhou",lat:33.8446,lon:115.7741,country:"China",admin1:"Anhui"},{id:"cz_ah2",name:"",name_en:"Chizhou",lat:30.6648,lon:117.4916,country:"China",admin1:"Anhui"},{id:"xc",name:"",name_en:"Xuancheng",lat:30.9407,lon:118.7588,country:"China",admin1:"Anhui"},{id:"sjz",name:"",name_en:"Shijiazhuang",lat:38.0428,lon:114.5149,country:"China",admin1:"Hebei"},{id:"ty",name:"",name_en:"Taiyuan",lat:37.8706,lon:112.5489,country:"China",admin1:"Shanxi"},{id:"hu",name:"",name_en:"Hohhot",lat:40.8415,lon:111.7492,country:"China",admin1:"Inner Mongolia"},{id:"sy",name:"",name_en:"Shenyang",lat:41.8057,lon:123.4315,country:"China",admin1:"Liaoning"},{id:"cc",name:"",name_en:"Changchun",lat:43.8171,lon:125.3235,country:"China",admin1:"Jilin"},{id:"hrb",name:"",name_en:"Harbin",lat:45.8038,lon:126.5349,country:"China",admin1:"Heilongjiang"},{id:"nc",name:"",name_en:"Nanchang",lat:28.683,lon:115.8579,country:"China",admin1:"Jiangxi"},{id:"zz",name:"",name_en:"Zhengzhou",lat:34.7466,lon:113.6253,country:"China",admin1:"Henan"},{id:"nn",name:"",name_en:"Nanning",lat:22.817,lon:108.3665,country:"China",admin1:"Guangxi"},{id:"hk",name:"",name_en:"Haikou",lat:20.044,lon:110.1999,country:"China",admin1:"Hainan"},{id:"gy_gz",name:"",name_en:"Guiyang",lat:26.647,lon:106.6302,country:"China",admin1:"Guizhou"},{id:"km",name:"",name_en:"Kunming",lat:24.8801,lon:102.8329,country:"China",admin1:"Yunnan"},{id:"ls_xz",name:"",name_en:"Lhasa",lat:29.65,lon:91.1,country:"China",admin1:"Tibet"},{id:"xa",name:"",name_en:"Xi'an",lat:34.3416,lon:108.9398,country:"China",admin1:"Shaanxi"},{id:"lz",name:"",name_en:"Lanzhou",lat:36.0611,lon:103.8343,country:"China",admin1:"Gansu"},{id:"xn_qh",name:"",name_en:"Xining",lat:36.6171,lon:101.7782,country:"China",admin1:"Qinghai"},{id:"yc_nx",name:"",name_en:"Yinchuan",lat:38.4872,lon:106.2309,country:"China",admin1:"Ningxia"},{id:"wlmq",name:"",name_en:"Urumqi",lat:43.8256,lon:87.6168,country:"China",admin1:"Xinjiang"},{id:"hk_sar",name:"",name_en:"Hong Kong",lat:22.3193,lon:114.1694,country:"China",admin1:"Hong Kong"},{id:"mo_sar",name:"",name_en:"Macau",lat:22.1987,lon:113.5439,country:"China",admin1:"Macau"},{id:"tw",name:"",name_en:"Taipei",lat:25.033,lon:121.5654,country:"China",admin1:"Taiwan"}],ua=({children:t})=>Zt.createPortal(t,document.body),da=()=>{const[t,e]=p.useState(!1),[n,s]=p.useState(!1);St();const{t:i}=Re(),{cursorEnabled:r,toggleCursor:o}=ls(),{user:l,logout:c}=Qe(),[u,h]=p.useState(new Date),[d,m]=p.useState(null),[f,g]=p.useState(!1),[v,x]=p.useState(localStorage.getItem("weather_city")||"Hangzhou"),[w,S]=p.useState(JSON.parse(localStorage.getItem("weather_coords"))||{lat:30.27,lon:120.15}),[b,C]=p.useState(""),[I,B]=p.useState(!1),[D,H]=p.useState([]);p.useEffect(()=>{const y=setInterval(()=>h(new Date),6e4);return()=>clearInterval(y)},[]),p.useEffect(()=>{w&&rt.get(`https://api.open-meteo.com/v1/forecast?latitude=${w.lat}&longitude=${w.lon}&current_weather=true`).then(y=>{m(y.data.current_weather)}).catch(y=>console.error("Weather fetch failed",y))},[w]);const O=async y=>{if(y.preventDefault(),!b.trim())return;B(!0),H([]);const E=b.toLowerCase().trim(),M=ca.filter(k=>k.name.includes(E)||k.name_en.toLowerCase().includes(E)||k.admin1&&k.admin1.toLowerCase().includes(E)).map(k=>({id:`local-${k.id}`,name:k.name,country:k.country,admin1:k.admin1,latitude:k.lat,longitude:k.lon,isLocal:!0}));try{const k=await rt.get(`https://geocoding-api.open-meteo.com/v1/search?name=${b}&count=10&language=zh&format=json`);let F=[];if(k.data.results&&k.data.results.length>0)F=k.data.results;else{const te=await rt.get(`https://geocoding-api.open-meteo.com/v1/search?name=${b}&count=10&format=json`);te.data.results&&te.data.results.length>0&&(F=te.data.results)}const me=[...M,...F].filter((te,$,ne)=>ne.findIndex(se=>Math.abs(se.latitude-te.latitude)<.1&&Math.abs(se.longitude-te.longitude)<.1)===$);H(me)}catch(k){console.error("Geocoding failed",k),H(M)}finally{B(!1)}},N=y=>{const E={lat:y.latitude,lon:y.longitude},M=y.name;S(E),x(M),localStorage.setItem("weather_city",M),localStorage.setItem("weather_coords",JSON.stringify(E)),g(!1),C(""),H([])},A=y=>y===0||y===1?a.jsx(vi,{size:14,className:"text-yellow-400"}):y===2||y===3?a.jsx(Ct,{size:14,className:"text-gray-400"}):y>=45&&y<=48?a.jsx(xi,{size:14,className:"text-gray-400"}):y>=51&&y<=67?a.jsx(cn,{size:14,className:"text-blue-400"}):y>=71&&y<=77?a.jsx(yi,{size:14,className:"text-white"}):y>=80&&y<=82?a.jsx(cn,{size:14,className:"text-blue-500"}):y>=95&&y<=99?a.jsx(bi,{size:14,className:"text-yellow-500"}):a.jsx(Ct,{size:14}),_=[{key:"home",path:"/"},{key:"events",path:"/events"},{key:"gallery",path:"/gallery"},{key:"music",path:"/music"},{key:"videos",path:"/videos"},{key:"articles",path:"/articles"},{key:"about",path:"/about"},{key:"admin",path:"/admin"}];return a.jsxs(L.nav,{initial:{y:-100},animate:{y:0},transition:{duration:.8},className:"fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 backdrop-blur-md bg-black/30 border-b border-white/10",children:[a.jsxs(lt,{to:"/",className:"flex items-center gap-2 text-white group z-50",children:[a.jsx(hi,{className:"w-6 h-6 group-hover:rotate-12 transition-transform duration-300"}),a.jsx("span",{className:"font-bold font-serif text-xl tracking-tighter",children:"LUMOS"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[_.map(y=>a.jsxs(lt,{to:y.path,className:"text-sm font-medium text-gray-300 hover:text-white transition-colors relative group",children:[i(`nav.${y.key}`),a.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"})]},y.key)),a.jsx("div",{className:"w-px h-6 bg-white/20 mx-2"}),a.jsx("button",{onClick:()=>window.dispatchEvent(new Event("open-search-palette")),className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-full transition-all",title:i("nav.search_title"),children:a.jsx(Ve,{size:18})}),a.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-3 text-xs text-gray-400 border border-white/10 px-3 py-1.5 rounded-full bg-black/20 hover:bg-white/10 hover:text-white transition-all cursor-pointer",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fi,{size:12}),a.jsx("span",{children:u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("div",{className:"w-px h-3 bg-white/20"}),a.jsxs("div",{className:"flex items-center gap-1",children:[d?A(d.weathercode):a.jsx(Ct,{size:12}),a.jsx("span",{children:d?`${Math.round(d.temperature)}C`:"..."})]}),a.jsx("div",{className:"w-px h-3 bg-white/20"}),a.jsx("span",{className:"truncate max-w-[60px]",children:v})]}),a.jsx("button",{onClick:o,className:`p-2 rounded-full transition-all ${r?"bg-white/10 text-white":"text-gray-400 hover:text-white"}`,title:i(r?"nav.cursor_disable":"nav.cursor_enable"),children:a.jsx(pi,{size:18})}),a.jsx(zn,{}),l?a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 text-sm font-bold text-white hover:text-indigo-400 transition-colors bg-white/5 hover:bg-white/10 px-4 py-2 rounded-full border border-white/10",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-600 flex items-center justify-center text-[10px] text-white",children:l.username.charAt(0).toUpperCase()}),a.jsx("span",{children:l.username})]})}):a.jsx("button",{onClick:()=>e(!0),className:"text-sm font-bold bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-full transition-all",children:i("auth.log_in")})]}),a.jsxs("div",{className:"md:hidden flex items-center gap-3 z-50",children:[a.jsx("button",{onClick:()=>window.dispatchEvent(new Event("open-search-palette")),className:"p-2 text-gray-300 hover:text-white",children:a.jsx(Ve,{size:20})}),a.jsx(zn,{}),l?a.jsx("button",{onClick:()=>s(!0),className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center text-[10px] text-white font-bold border border-white/20",children:l.username.charAt(0).toUpperCase()}):a.jsx("button",{onClick:()=>e(!0),className:"p-2 text-white bg-indigo-600 hover:bg-indigo-700 rounded-full transition-colors",children:a.jsx(mi,{size:18})})]}),a.jsx(re,{children:f&&a.jsx(ua,{children:a.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>g(!1),children:a.jsxs(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-[#1a1a1a] border border-white/10 rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl p-6 relative z-10",onClick:y=>y.stopPropagation(),children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-purple-500/5 opacity-50 pointer-events-none"}),a.jsxs("div",{className:"flex justify-between items-center mb-6 relative z-10",children:[a.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[a.jsx(gi,{size:24,className:"text-indigo-400"})," ",i("weather.location")]}),a.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(we,{size:24})})]}),a.jsxs("form",{onSubmit:O,className:"space-y-4 relative z-10",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:i("weather.city_label")}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:b,onChange:y=>C(y.target.value),placeholder:i("weather.placeholder"),className:"w-full bg-black/20 border border-white/10 rounded-xl pl-10 pr-4 py-3 text-white focus:outline-none focus:border-indigo-500 transition-all focus:bg-black/40",autoFocus:!0}),a.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:i("weather.search_help")})]}),a.jsx("button",{type:"submit",disabled:I,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-indigo-500/25",children:i(I?"weather.searching":"weather.search_btn")})]}),D.length>0&&a.jsxs("div",{className:"mt-4 max-h-48 overflow-y-auto custom-scrollbar space-y-2 border-t border-white/10 pt-4 relative z-10",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:i("weather.select")}),D.map(y=>a.jsxs("button",{onClick:()=>N(y),className:`w-full text-left p-3 rounded-lg hover:bg-white/10 transition-colors flex flex-col group ${y.isLocal?"bg-indigo-900/20 border border-indigo-500/30":"bg-black/20"}`,children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:`font-bold transition-colors ${y.isLocal?"text-indigo-400":"text-white group-hover:text-indigo-400"}`,children:y.name}),y.country_code?a.jsx("img",{src:`https://flagcdn.com/16x12/${y.country_code.toLowerCase()}.png`,alt:y.country,className:"opacity-50 group-hover:opacity-100 transition-opacity"}):a.jsx("span",{className:"text-[10px] bg-white/10 px-1.5 rounded text-gray-400",children:y.country})]}),a.jsx("span",{className:"text-xs text-gray-400 group-hover:text-gray-300",children:[y.admin1,y.country].filter(Boolean).join(", ")})]},y.id))]})]})})})}),a.jsx(js,{isOpen:t,onClose:()=>e(!1)}),a.jsx(la,{isOpen:n,onClose:()=>s(!1)})]})};/**
 * postprocessing v6.38.0 build Sat Nov 08 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var Ot=1/1e3,ha=1e3,fa=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*Ot}get fixedDelta(){return this._fixedDelta*Ot}set fixedDelta(t){this._fixedDelta=t*ha}get elapsed(){return this._elapsed*Ot}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},pa=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new Jt;return n.setAttribute("position",new sn(t,3)),n.setAttribute("uv",new sn(e,2)),n})(),J=class Vt{static get fullscreenGeometry(){return pa}constructor(e="Pass",n=new nn,s=new Xs){this.name=e,this.renderer=null,this.scene=n,this.camera=s,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new Js(Vt.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new nn),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=Ue){}render(e,n,s,i,r){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,s){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof ue||n instanceof Jn||n instanceof Yn||n instanceof Vt)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},ma=class extends J{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,s,i){const r=t.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},ga=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,Cs="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Ts=class extends ye{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new P(null),depthBuffer:new P(null),channelWeights:new P(null),opacity:new P(1)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ga,vertexShader:Cs}),this.depthFunc=ei}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(t){const e=t!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){const e=t!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(t){t!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=t):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},va=class extends J{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new Ts,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new ue(1,1,{minFilter:ct,magFilter:ct,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,s,i){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Ce?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===V&&(this.renderTarget.texture.colorSpace=V))}},In=new ce,_s=class extends J{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,s,i){const r=this.overrideClearColor,o=this.overrideClearAlpha,l=t.getClearAlpha(),c=r!==null,u=o>=0;c?(t.getClearColor(In),t.setClearColor(r,u?o:l)):u&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),c?t.setClearColor(In,l):u&&t.setClearAlpha(l)}},xa=class extends J{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new _s(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,s,i){const r=t.getContext(),o=t.state.buffers,l=this.scene,c=this.camera,u=this.clearPass,h=this.inverted?0:1,d=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.stencil.setFunc(r.ALWAYS,h,4294967295),o.stencil.setClear(d),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(t,null):(u.render(t,e),u.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(l,c)):(t.setRenderTarget(e),t.render(l,c),t.setRenderTarget(n),t.render(l,c)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(r.EQUAL,1,4294967295),o.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.stencil.setLocked(!0)}},ya=class{constructor(e=null,{depthBuffer:n=!0,stencilBuffer:s=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(n,s,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new va,this.depthTexture=null,this.passes=[],this.timer=new fa,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const n=this.inputBuffer,s=this.multisampling;s>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):s!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(n.depthBuffer,n.stencilBuffer,n.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const n=e.getSize(new G),s=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Ce&&e.outputColorSpace===V&&(this.inputBuffer.texture.colorSpace=V,this.outputBuffer.texture.colorSpace=V,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(n.width,n.height);for(const r of this.passes)r.initialize(e,s,i)}}replaceRenderer(e,n=!0){const s=this.renderer,i=s.domElement.parentNode;return this.setRenderer(e),n&&i!==null&&(i.removeChild(s.domElement),i.appendChild(e.domElement)),s}createDepthTexture(){const e=this.depthTexture=new Gs;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Vs,e.type=Ws):e.type=Ks,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,n,s,i){const r=this.renderer,o=r===null?new G:r.getDrawingBufferSize(new G),l={minFilter:ct,magFilter:ct,stencilBuffer:n,depthBuffer:e,type:s},c=new ue(o.width,o.height,l);return i>0&&(c.samples=i),s===Ce&&r!==null&&r.outputColorSpace===V&&(c.texture.colorSpace=V),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(e){for(const n of this.passes)n.mainScene=e}setMainCamera(e){for(const n of this.passes)n.mainCamera=e}addPass(e,n){const s=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new G),o=i.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(r.width,r.height),e.initialize(i,o,l),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),n!==void 0?s.splice(n,0,e):s.push(e),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(e of s)e.setDepthTexture(c)}else e.setDepthTexture(this.depthTexture)}removePass(e){const n=this.passes,s=n.indexOf(e);if(s!==-1&&n.splice(s,1).length>0){if(this.depthTexture!==null){const o=(c,u)=>c||u.needsDepthTexture;n.reduce(o,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&s===n.length&&(e.renderToScreen=!1,n.length>0&&(n[n.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const n=this.renderer,s=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,o=!1,l,c,u;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(n,i,r,e,o),h.needsSwap&&(o&&(s.renderToScreen=h.renderToScreen,l=n.getContext(),c=n.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),s.render(n,i,r,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,i=r,r=u),h instanceof xa?o=!0:h instanceof ma&&(o=!1))}setSize(e,n,s){const i=this.renderer,r=i.getSize(new G);(e===void 0||n===void 0)&&(e=r.width,n=r.height),(r.width!==e||r.height!==n)&&i.setSize(e,n,s);const o=i.getDrawingBufferSize(new G);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const l of this.passes)l.setSize(o.width,o.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),J.fullscreenGeometry.dispose()}},fe={NONE:0,DEPTH:1,CONVOLUTION:2},z={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},ba=class{constructor(){this.shaderParts=new Map([[z.FRAGMENT_HEAD,null],[z.FRAGMENT_MAIN_UV,null],[z.FRAGMENT_MAIN_IMAGE,null],[z.VERTEX_HEAD,null],[z.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=fe.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Zn}},Mt=!1,Ln=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case Ge:n=this.materialsFlatShadedDoubleSide;break;case et:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case Ge:n=this.materialsDoubleSide;break;case et:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof ye))return t.clone();const e=t.uniforms,n=new Map;for(const i in e){const r=e[i].value;r.isRenderTargetTexture&&(e[i].value=null,n.set(i,r))}const s=t.clone();for(const i of n)e[i[0]].value=i[1],s.uniforms[i[0]].value=i[1];return s}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=Ys;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.side=et,s}),this.materialsDoubleSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.side=Ge,s}),this.materialsFlatShaded=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s}),this.materialsFlatShadedBackSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s.side=et,s}),this.materialsFlatShadedDoubleSide=e.map(n=>{const s=this.cloneMaterial(n);return s.uniforms=Object.assign({},t.uniforms),s.flatShading=!0,s.side=Ge,s})}}render(t,e,n){const s=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,Mt){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const r of i)r[0].material=r[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=i}t.shadowMap.enabled=s}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Mt}static set workaroundEnabled(t){Mt=t}},ge=-1,K=class extends Xt{constructor(t,e=ge,n=ge,s=1){super(),this.resizable=t,this.baseSize=new G(1,1),this.preferredSize=new G(e,n),this.target=this.preferredSize,this.s=s,this.effectiveSize=new G,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,n=this.effectiveSize,s=this.scale;e.width!==ge?n.width=e.width:e.height!==ge?n.width=Math.round(e.height*(t.width/Math.max(t.height,1))):n.width=Math.round(t.width*s),e.height!==ge?n.height=e.height:e.width!==ge?n.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n.height=Math.round(t.height*s)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(ge),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ge}},R={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},wa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",Sa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",ja="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Ca="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",Ta="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",_a="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",Ea="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",Na="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",Ra="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",ka="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Pa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",Oa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",Ma="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",za="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",Ia="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",La="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Aa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",Ua="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Da="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Ba="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",Fa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",Ha="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",$a="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",Ga="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",Va="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",Wa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Ka="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",qa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",Za="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Xa="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",Ja="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",Ya=new Map([[R.ADD,wa],[R.AVERAGE,Sa],[R.COLOR,ja],[R.COLOR_BURN,Ca],[R.COLOR_DODGE,Ta],[R.DARKEN,_a],[R.DIFFERENCE,Ea],[R.DIVIDE,Na],[R.DST,null],[R.EXCLUSION,Ra],[R.HARD_LIGHT,ka],[R.HARD_MIX,Pa],[R.HUE,Oa],[R.INVERT,Ma],[R.INVERT_RGB,za],[R.LIGHTEN,Ia],[R.LINEAR_BURN,La],[R.LINEAR_DODGE,Aa],[R.LINEAR_LIGHT,Ua],[R.LUMINOSITY,Da],[R.MULTIPLY,Ba],[R.NEGATION,Fa],[R.NORMAL,Ha],[R.OVERLAY,$a],[R.PIN_LIGHT,Ga],[R.REFLECT,Va],[R.SATURATION,Wa],[R.SCREEN,Ka],[R.SOFT_LIGHT,qa],[R.SRC,Za],[R.SUBTRACT,Xa],[R.VIVID_LIGHT,Ja]]),Qa=class extends Xt{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new P(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return Ya.get(this.blendFunction)}},Xe=class extends Xt{constructor(t,e,{attributes:n=fe.NONE,blendFunction:s=R.NORMAL,defines:i=new Map,uniforms:r=new Map,extensions:o=null,vertexShader:l=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=l,this.defines=i,this.uniforms=r,this.extensions=o,this.blendMode=new Qa(s),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=Zn,this._outputColorSpace=Xn}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=Ue){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof ue||e instanceof Jn||e instanceof Yn||e instanceof J)&&this[t].dispose()}}},en={MEDIUM:2,LARGE:3},eo=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,to="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",no=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],so=class extends ye{constructor(t=new rn){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new P(null),texelSize:new P(new rn),scale:new P(1),kernel:new P(0)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:eo,vertexShader:to}),this.setTexelSize(t.x,t.y),this.kernelSize=en.MEDIUM}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get kernelSequence(){return no[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e,t*.5,e*.5)}setSize(t,e){const n=1/t,s=1/e;this.uniforms.texelSize.value.set(n,s,n*.5,s*.5)}},io=class extends J{constructor({kernelSize:t=en.MEDIUM,resolutionScale:e=.5,width:n=K.AUTO_SIZE,height:s=K.AUTO_SIZE,resolutionX:i=n,resolutionY:r=s}={}){super("KawaseBlurPass"),this.renderTargetA=new ue(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new K(this,i,r,e);o.addEventListener("change",l=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new so,this._blurMaterial.kernelSize=t,this.copyMaterial=new Ts}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(t){this._blurMaterial=t}get dithering(){return this.copyMaterial.dithering}set dithering(t){this.copyMaterial.dithering=t}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(t){this.blurMaterial.kernelSize=t}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,s,i){const r=this.scene,o=this.camera,l=this.renderTargetA,c=this.renderTargetB,u=this.blurMaterial,h=u.kernelSequence;let d=e;this.fullscreenMaterial=u;for(let m=0,f=h.length;m<f;++m){const g=m&1?c:l;u.kernel=h[m],u.inputBuffer=d.texture,t.setRenderTarget(g),t.render(r,o),d=g}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=d.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(r,o)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e);const s=n.width,i=n.height;this.renderTargetA.setSize(s,i),this.renderTargetB.setSize(s,i),this.blurMaterial.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Ce?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t!==null&&t.outputColorSpace===V&&(this.renderTargetA.texture.colorSpace=V,this.renderTargetB.texture.colorSpace=V))}static get AUTO_SIZE(){return K.AUTO_SIZE}},ro=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,ao=class extends ye{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Qn.replace(/\D+/g,"")},uniforms:{inputBuffer:new P(null),threshold:new P(0),smoothing:new P(1),range:new P(null)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ro,vertexShader:Cs}),this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},oo=class extends J{constructor({renderTarget:t,luminanceRange:e,colorOutput:n,resolutionScale:s=1,width:i=K.AUTO_SIZE,height:r=K.AUTO_SIZE,resolutionX:o=i,resolutionY:l=r}={}){super("LuminancePass"),this.fullscreenMaterial=new ao(n,e),this.needsSwap=!1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new ue(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new K(this,o,l,s);c.addEventListener("change",u=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,n,s,i){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){n!==void 0&&n!==Ce&&(this.renderTarget.texture.type=n,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},lo=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,co="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",uo=class extends ye{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new P(null),texelSize:new P(new G)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:lo,vertexShader:co})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},ho=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,fo="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",po=class extends ye{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new P(null),supportBuffer:new P(null),texelSize:new P(new G),radius:new P(.85)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ho,vertexShader:fo})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}set supportBuffer(t){this.uniforms.supportBuffer.value=t}get radius(){return this.uniforms.radius.value}set radius(t){this.uniforms.radius.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},mo=class extends J{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new ue(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new uo,this.upsamplingMaterial=new po,this.resolution=new G}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(t){if(this.levels!==t){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let n=0;n<t;++n){const s=e.clone();s.texture.name="Downsampling.Mipmap"+n,this.downsamplingMipmaps.push(s)}this.upsamplingMipmaps.push(e);for(let n=1,s=t-1;n<s;++n){const i=e.clone();i.texture.name="Upsampling.Mipmap"+n,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(t){this.upsamplingMaterial.radius=t}render(t,e,n,s,i){const{scene:r,camera:o}=this,{downsamplingMaterial:l,upsamplingMaterial:c}=this,{downsamplingMipmaps:u,upsamplingMipmaps:h}=this;let d=e;this.fullscreenMaterial=l;for(let m=0,f=u.length;m<f;++m){const g=u[m];l.setSize(d.width,d.height),l.inputBuffer=d.texture,t.setRenderTarget(g),t.render(r,o),d=g}this.fullscreenMaterial=c;for(let m=h.length-1;m>=0;--m){const f=h[m];c.setSize(d.width,d.height),c.inputBuffer=d.texture,c.supportBuffer=u[m].texture,t.setRenderTarget(f),t.render(r,o),d=f}}setSize(t,e){const n=this.resolution;n.set(t,e);let s=n.width,i=n.height;for(let r=0,o=this.downsamplingMipmaps.length;r<o;++r)s=Math.round(s*.5),i=Math.round(i*.5),this.downsamplingMipmaps[r].setSize(s,i),r<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[r].setSize(s,i)}initialize(t,e,n){if(n!==void 0){const s=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of s)i.texture.type=n;if(n!==Ce)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(t!==null&&t.outputColorSpace===V)for(const i of s)i.texture.colorSpace=V}}dispose(){super.dispose();for(const t of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))t.dispose()}},go=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,vo=class extends Xe{constructor({blendFunction:t=R.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:n=.03,mipmapBlur:s=!0,intensity:i=1,radius:r=.85,levels:o=8,kernelSize:l=en.LARGE,resolutionScale:c=.5,width:u=K.AUTO_SIZE,height:h=K.AUTO_SIZE,resolutionX:d=u,resolutionY:m=h}={}){super("BloomEffect",go,{blendFunction:t,uniforms:new Map([["map",new P(null)],["intensity",new P(i)]])}),this.renderTarget=new ue(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new io({kernelSize:l}),this.luminancePass=new oo({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=n,this.mipmapBlurPass=new mo,this.mipmapBlurPass.enabled=s,this.mipmapBlurPass.radius=r,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=s?this.mipmapBlurPass.texture:this.renderTarget.texture;const f=this.resolution=new K(this,d,m,c);f.addEventListener("change",g=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){const s=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(t,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,i.renderTarget):this.blurPass.render(t,i.renderTarget,s)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,e):this.blurPass.render(t,e,s)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.blurPass.resolution.copy(n),this.luminancePass.setSize(t,e),this.mipmapBlurPass.setSize(t,e)}initialize(t,e,n){this.blurPass.initialize(t,e,n),this.luminancePass.initialize(t,e,n),this.mipmapBlurPass.initialize(t,e,n),n!==void 0&&(this.renderTarget.texture.type=n,t!==null&&t.outputColorSpace===V&&(this.renderTarget.texture.colorSpace=V))}},Es=class extends J{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new _s,this.overrideMaterialManager=n===null?null:new Ln(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new Ln(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,s,i){const r=this.scene,o=this.camera,l=this.selection,c=o.layers.mask,u=r.background,h=t.shadowMap.autoUpdate,d=this.renderToScreen?null:e;l!==null&&o.layers.set(l.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,r,o):t.render(r,o),o.layers.mask=c,r.background=u,t.shadowMap.autoUpdate=h}},$e={DEFAULT:0,ESKIL:1},xo=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,yo=class extends Xe{constructor({blendFunction:t=R.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",xo,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},bo=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,wo="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",So=class extends ye{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new P(null),normalBuffer:new P(null),texelSize:new P(new G)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:bo,vertexShader:wo})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=Ue){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},jo=class extends J{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:n=K.AUTO_SIZE,height:s=K.AUTO_SIZE,resolutionX:i=n,resolutionY:r=s}={}){super("DepthDownsamplingPass");const o=new So;o.normalBuffer=t,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new ue(1,1,{minFilter:ut,magFilter:ut,depthBuffer:!1,type:Zs}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const l=this.resolution=new K(this,i,r,e);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=Ue){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,n,s,i){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,n){const s=t.getContext();if(!(s.getExtension("EXT_color_buffer_float")||s.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},Co=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,To=class extends Xe{constructor({blendFunction:t,eskil:e=!1,technique:n=e?$e.ESKIL:$e.DEFAULT,offset:s=.5,darkness:i=.5}={}){super("VignetteEffect",Co,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",n.toFixed(0)]]),uniforms:new Map([["offset",new P(s)],["darkness",new P(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===$e.ESKIL}set eskil(t){this.technique=t?$e.ESKIL:$e.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},_o=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Eo="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",No=class extends ye{constructor(t,e,n,s,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Qn.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new P(null),depthBuffer:new P(null),resolution:new P(new G),texelSize:new P(new G),cameraNear:new P(.3),cameraFar:new P(1e3),aspect:new P(1),time:new P(0)},blending:Ee,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(s)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=Ue){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=_o.replace(z.FRAGMENT_HEAD,t.get(z.FRAGMENT_HEAD)||"").replace(z.FRAGMENT_MAIN_UV,t.get(z.FRAGMENT_MAIN_UV)||"").replace(z.FRAGMENT_MAIN_IMAGE,t.get(z.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Eo.replace(z.VERTEX_HEAD,t.get(z.VERTEX_HEAD)||"").replace(z.VERTEX_MAIN_SUPPORT,t.get(z.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Qs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return z}};function An(t,e,n){for(const s of e){const i="$1"+t+s.charAt(0).toUpperCase()+s.slice(1),r=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(r,i))}}function Ro(t,e,n){let s=e.getFragmentShader(),i=e.getVertexShader();const r=s!==void 0&&/mainImage/.test(s),o=s!==void 0&&/mainUv/.test(s);if(n.attributes|=e.getAttributes(),s===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&n.attributes&fe.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=n.shaderParts;let u=c.get(z.FRAGMENT_HEAD)||"",h=c.get(z.FRAGMENT_MAIN_UV)||"",d=c.get(z.FRAGMENT_MAIN_IMAGE)||"",m=c.get(z.VERTEX_HEAD)||"",f=c.get(z.VERTEX_MAIN_SUPPORT)||"";const g=new Set,v=new Set;if(o&&(h+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const S=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);f+=`	${t}MainSupport(`,f+=S?`vUv);
`:`);
`;for(const b of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const C of b[1].split(/\s*,\s*/))n.varyings.add(C),g.add(C),v.add(C);for(const b of i.matchAll(l))v.add(b[1])}for(const S of s.matchAll(l))v.add(S[1]);for(const S of e.defines.keys())v.add(S.replace(/\([\w\s,]*\)/g,""));for(const S of e.uniforms.keys())v.add(S);v.delete("while"),v.delete("for"),v.delete("if"),e.uniforms.forEach((S,b)=>n.uniforms.set(t+b.charAt(0).toUpperCase()+b.slice(1),S)),e.defines.forEach((S,b)=>n.defines.set(t+b.charAt(0).toUpperCase()+b.slice(1),S));const x=new Map([["fragment",s],["vertex",i]]);An(t,v,n.defines),An(t,v,x),s=x.get("fragment"),i=x.get("vertex");const w=e.blendMode;if(n.blendModes.set(w.blendFunction,w),r){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(d+=e.inputColorSpace===V?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Xn?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const S=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${t}MainImage(color0, UV, `,n.attributes&fe.DEPTH&&S.test(s)&&(d+="depth, ",n.readDepth=!0),d+=`color1);
	`;const b=t+"BlendOpacity";n.uniforms.set(b,w.opacity),d+=`color0 = blend${w.blendFunction}(color0, color1, ${b});

	`,u+=`uniform float ${b};

`}if(u+=s+`
`,i!==null&&(m+=i+`
`),c.set(z.FRAGMENT_HEAD,u),c.set(z.FRAGMENT_MAIN_UV,h),c.set(z.FRAGMENT_MAIN_IMAGE,d),c.set(z.VERTEX_HEAD,m),c.set(z.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const S of e.extensions)n.extensions.add(S)}}var ko=class extends J{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new No(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new ba;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===R.DST)t.attributes|=o.getAttributes()&fe.DEPTH;else{if(t.attributes&o.getAttributes()&fe.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);Ro("e"+e++,o,t)}let n=t.shaderParts.get(z.FRAGMENT_HEAD),s=t.shaderParts.get(z.FRAGMENT_MAIN_IMAGE),i=t.shaderParts.get(z.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const o of t.blendModes.values())n+=o.getShaderCode().replace(r,`blend${o.blendFunction}`)+`
`;t.attributes&fe.DEPTH?(t.readDepth&&(s=`float depth = readDepth(UV);

	`+s),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===V&&(s+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(z.FRAGMENT_HEAD,n),t.shaderParts.set(z.FRAGMENT_MAIN_IMAGE,s),t.shaderParts.set(z.FRAGMENT_MAIN_UV,i);for(const[o,l]of t.shaderParts)l!==null&&t.shaderParts.set(o,l.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=Ue){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,s,i){for(const r of this.effects)r.update(t,e,s);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=s*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const s of this.effects)s.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==Ce&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},Po=class extends J{constructor(t,e,{renderTarget:n,resolutionScale:s=1,width:i=K.AUTO_SIZE,height:r=K.AUTO_SIZE,resolutionX:o=i,resolutionY:l=r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new Es(t,e,new qs);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const u=c.getClearPass();u.overrideClearColor=new ce(7829503),u.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new ue(1,1,{minFilter:ut,magFilter:ut}),this.renderTarget.texture.name="NormalPass.Target");const h=this.resolution=new K(this,o,l,s);h.addEventListener("change",d=>this.setSize(h.baseWidth,h.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,s,i){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,r,r)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}};const Oo=p.createContext(null),Un=t=>(t.getAttributes()&fe.CONVOLUTION)===fe.CONVOLUTION,Mo=W.memo(p.forwardRef(({children:t,camera:e,scene:n,resolutionScale:s,enabled:i=!0,renderPriority:r=1,autoClear:o=!0,depthBuffer:l,enableNormalPass:c,stencilBuffer:u,multisampling:h=8,frameBufferType:d=ni},m)=>{const{gl:f,scene:g,camera:v,size:x}=pe(),w=n||g,S=e||v,[b,C,I]=p.useMemo(()=>{const O=ti(),N=new ya(f,{depthBuffer:l,stencilBuffer:u,multisampling:h>0&&O?h:0,frameBufferType:d});N.addPass(new Es(w,S));let A=null,_=null;return c&&(_=new Po(w,S),_.enabled=!1,N.addPass(_),s!==void 0&&O&&(A=new jo({normalBuffer:_.texture,resolutionScale:s}),A.enabled=!1,N.addPass(A))),[N,_,A]},[S,f,l,u,h,d,w,c,s]);p.useEffect(()=>b==null?void 0:b.setSize(x.width,x.height),[b,x]),q((O,N)=>{if(i){const A=f.autoClear;f.autoClear=o,u&&!o&&f.clearStencil(),b.render(N),f.autoClear=A}},i?r:0);const B=p.useRef(null),D=si(B);p.useLayoutEffect(()=>{const O=[];if(B.current&&D.current&&b){const N=D.current.objects;for(let A=0;A<N.length;A++){const _=N[A];if(_ instanceof Xe){const y=[_];if(!Un(_)){let M=null;for(;(M=N[A+1])instanceof Xe&&!Un(M);)y.push(M),A++}const E=new ko(S,...y);O.push(E)}else _ instanceof J&&O.push(_)}for(const A of O)b==null||b.addPass(A);C&&(C.enabled=!0),I&&(I.enabled=!0)}return()=>{for(const N of O)b==null||b.removePass(N);C&&(C.enabled=!1),I&&(I.enabled=!1)}},[b,t,S,C,I,D]),p.useEffect(()=>{const O=f.toneMapping;return f.toneMapping=ii,()=>{f.toneMapping=O}},[]);const H=p.useMemo(()=>({composer:b,normalPass:C,downSamplingPass:I,resolutionScale:s,camera:S,scene:w}),[b,C,I,s,S,w]);return p.useImperativeHandle(m,()=>b,[b]),a.jsx(Oo.Provider,{value:H,children:a.jsx("group",{ref:B,children:t})})}));let zo=0;const Dn=new WeakMap,tn=(t,e)=>W.forwardRef(function({blendFunction:s=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r},o){let l=Dn.get(t);if(!l){const h=`@react-three/postprocessing/${t.name}-${zo++}`;be({[h]:t}),Dn.set(t,l=h)}const c=pe(h=>h.camera),u=W.useMemo(()=>{var h,d;return[...(h=e==null?void 0:e.args)!=null?h:[],...(d=r.args)!=null?d:[{...e,...r}]]},[JSON.stringify(r)]);return a.jsx(l,{camera:c,"blendMode-blendFunction":s,"blendMode-opacity-value":i,...r,ref:o,args:u})}),Io=tn(vo,{blendFunction:R.ADD}),Lo=tn(yo,{blendFunction:R.COLOR_DODGE}),Ao=tn(To),bt="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9ImciIGN4PSI1MCUiIGN5PSI1MCUiIHI9IjUwJSIgZng9IjUwJSIgZnk9IjUwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0id2hpdGUiIHN0b3Atb3BhY2l0eT0iMSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0id2hpdGUiIHN0b3Atb3BhY2l0eT0iMCIvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxjaXJjbGUgY3g9IjY0IiBjeT0iNjQiIHI9IjY0IiBmaWxsPSJ1cmwoI2cpIi8+PC9zdmc+",Uo=()=>a.jsxs("group",{children:[a.jsx(De,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:.5}),a.jsxs(ve,{speed:1,rotationIntensity:.2,floatIntensity:.2,children:[a.jsx(dt,{texture:bt,opacity:.3,speed:.2,width:10,depth:1.5,segments:20,position:[0,0,-20],color:"#4c1d95"}),a.jsx(dt,{texture:bt,opacity:.3,speed:.2,width:10,depth:1.5,segments:20,position:[10,5,-25],color:"#1e40af"})]})]}),Do=Ne({uTime:0,uColorStart:new ce("#001e36"),uColorEnd:new ce("#004d7a")},`
    varying vec2 vUv;
    varying float vElevation;
    uniform float uTime;
    void main() {
      vUv = uv;
      float elevation = sin(position.x * 2.0 + uTime * 0.5) * 0.2;
      elevation += sin(position.y * 1.5 + uTime * 0.3) * 0.2;
      vElevation = elevation;
      vec3 pos = position;
      pos.z += vElevation;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
  `,`
    uniform vec3 uColorStart;
    uniform vec3 uColorEnd;
    varying float vElevation;
    void main() {
      vec3 color = mix(uColorStart, uColorEnd, vElevation * 2.0 + 0.5);
      float highlight = smoothstep(0.4, 0.6, vElevation);
      color += highlight * 0.2;
      gl_FragColor = vec4(color, 1.0);
    }
  `);be({WaterShaderMaterial:Do});const Bo=()=>{const t=p.useRef();q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)});const{viewport:e}=pe();return a.jsx("group",{rotation:[-Math.PI/5,0,0],children:a.jsxs("mesh",{position:[0,0,-2],scale:[e.width*1.5,e.height*1.5,1],children:[a.jsx("planeGeometry",{args:[1,1,128,128]}),a.jsx("waterShaderMaterial",{ref:t,transparent:!0})]})})},Ns=Ne({uTime:0,uResolution:new G(1,1)},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
    uniform float uTime;
    varying vec2 vUv;
    float random(vec2 st) { return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123); }
    void main() {
      vec2 uv = vUv;
      float colId = floor(uv.x * 40.0);
      float speed = random(vec2(colId, 1.0)) * 0.5 + 0.2;
      float rain = smoothstep(0.8, 1.0, fract(uv.y * 10.0 + uTime * speed));
      vec3 color = vec3(0.0, 1.0, 0.5) * rain;
      gl_FragColor = vec4(color, 1.0);
    }
  `);be({MatrixShaderMaterial:Ns});const Fo=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsxs("mesh",{scale:[e.width,e.height,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("matrixShaderMaterial",{ref:t,transparent:!0})]})},Ho=()=>{const t=p.useRef();return q(e=>{t.current&&(t.current.position.z=e.clock.elapsedTime*5%10)}),a.jsxs("group",{rotation:[Math.PI/2.5,0,0],position:[0,-2,-10],children:[a.jsx("gridHelper",{ref:t,args:[100,50,16711935,2228292]}),a.jsx("fog",{attach:"fog",args:["#000",5,40]}),a.jsx(De,{radius:50,count:1e3,factor:4,fade:!0,speed:1})]})},$o=Ne({uTime:0,uColor1:new ce("#00ffcc"),uColor2:new ce("#aa00ff")},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
    uniform float uTime;
    uniform vec3 uColor1;
    uniform vec3 uColor2;
    varying vec2 vUv;
    void main() {
      vec2 uv = vUv;
      float wave = sin(uv.x * 10.0 + uTime) * 0.1 + sin(uv.y * 8.0 + uTime * 0.8) * 0.1;
      float glow = 0.01 / abs(uv.y - 0.5 + wave);
      vec3 col = mix(uColor1, uColor2, uv.x + sin(uTime));
      gl_FragColor = vec4(col * glow, 1.0);
    }
  `);be({AuroraMaterial:$o});const Go=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsxs("mesh",{scale:[e.width,e.height,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("auroraMaterial",{ref:t,transparent:!0})]})},Vo=()=>a.jsxs("group",{children:[a.jsx(Ye,{count:500,scale:[20,10,10],size:6,speed:.4,opacity:.8,color:"#ffaa00",position:[0,-5,0]}),a.jsx("pointLight",{position:[0,-5,0],intensity:2,color:"#ff4400",distance:15}),a.jsx("fog",{attach:"fog",args:["#1a0500",5,20]})]}),Wo=()=>a.jsxs("group",{children:[a.jsxs(ve,{speed:2,rotationIntensity:1,floatIntensity:2,children:[a.jsx(it,{args:[2,0],position:[0,0,-5],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#00ffff",emissive:"#004444",wireframe:!0})}),a.jsx(it,{args:[1.5,0],position:[4,2,-8],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#ff00ff",emissive:"#440044",wireframe:!0})}),a.jsx(it,{args:[1,0],position:[-4,-2,-6],children:a.jsx("meshPhysicalMaterial",{roughness:0,metalness:.1,transmission:.9,thickness:2,color:"#ffff00",emissive:"#444400",wireframe:!0})})]}),a.jsx(Ye,{count:100,scale:15,size:3,speed:.5,opacity:.5,color:"white"})]}),Ko=Ne({uTime:0,uColor:new ce("#00ff88")},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
    uniform float uTime;
    uniform vec3 uColor;
    varying vec2 vUv;
    // Simplex noise function
    vec3 permute(vec3 x) { return mod(((x*34.0)+1.0)*x, 289.0); }
    float snoise(vec2 v){
      const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
      vec2 i  = floor(v + dot(v, C.yy) );
      vec2 x0 = v -   i + dot(i, C.xx);
      vec2 i1;
      i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
      vec4 x12 = x0.xyxy + C.xxzz;
      x12.xy -= i1;
      i = mod(i, 289.0);
      vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
      vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
      m = m*m ; m = m*m ;
      vec3 x = 2.0 * fract(p * C.www) - 1.0;
      vec3 h = abs(x) - 0.5;
      vec3 ox = floor(x + 0.5);
      vec3 a0 = x - ox;
      m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
      vec3 g;
      g.x  = a0.x  * x0.x  + h.x  * x0.y;
      g.yz = a0.yz * x12.xz + h.yz * x12.yw;
      return 130.0 * dot(m, g);
    }
    void main() {
      float noise = snoise(vUv * 5.0 + uTime * 0.2);
      float alpha = smoothstep(0.4, 0.6, noise);
      gl_FragColor = vec4(uColor, alpha * 0.5);
    }
  `);be({QuantumShaderMaterial:Ko});const qo=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsxs("mesh",{scale:[e.width,e.height,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("quantumShaderMaterial",{ref:t,transparent:!0})]})},Zo=()=>a.jsxs("group",{children:[a.jsx("color",{attach:"background",args:["#88ccff"]}),a.jsxs(ve,{speed:.5,rotationIntensity:.1,floatIntensity:.5,children:[a.jsx(dt,{texture:bt,opacity:.5,speed:.1,width:20,depth:2,segments:20,position:[0,0,-15],color:"white"}),a.jsx(dt,{texture:bt,opacity:.3,speed:.1,width:10,depth:1,segments:10,position:[-5,2,-10],color:"#ffdddd"})]}),a.jsx("ambientLight",{intensity:1})]}),Xo=()=>{const t=p.useRef();return q((e,n)=>{t.current&&(t.current.rotation.z+=n*.2,t.current.position.z=e.clock.elapsedTime*10%20)}),a.jsxs("group",{children:[a.jsx("group",{ref:t,children:[...Array(20)].map((e,n)=>a.jsx(st,{args:[3+n*.5,.05,16,100],position:[0,0,-n*5],rotation:[0,0,n],children:a.jsx("meshBasicMaterial",{color:`hsl(${n*20}, 100%, 50%)`})},n))}),a.jsx("fog",{attach:"fog",args:["#000",5,30]})]})},Jo=()=>{const t=p.useRef();return q(e=>{t.current&&(t.current.position.z=e.clock.elapsedTime*2%5,t.current.position.x=Math.sin(e.clock.elapsedTime*.5)*2)}),a.jsxs("group",{rotation:[Math.PI/3,0,0],position:[0,-2,-10],children:[a.jsx("gridHelper",{ref:t,args:[60,30,65535,13107]}),a.jsx("fog",{attach:"fog",args:["#000",2,25]}),a.jsx(De,{radius:40,count:500,factor:3,fade:!0,speed:.5,color:"#00ffff"})]})},Yo=()=>{const t=p.useRef();q(n=>{t.current&&(t.current.rotation.y=n.clock.elapsedTime*.5)});const e=p.useMemo(()=>{const n=[];for(let s=0;s<100;s++){const i=s*.2;n.push(new Lt(Math.sin(i),s*.1-5,Math.cos(i))),n.push(new Lt(Math.sin(i+Math.PI),s*.1-5,Math.cos(i+Math.PI)))}return n},[]);return a.jsxs("group",{ref:t,rotation:[0,0,Math.PI/4],children:[a.jsxs(es,{limit:1e3,range:1e3,children:[a.jsx("primitive",{object:new Jt().setFromPoints(e)}),a.jsx(ts,{transparent:!0,vertexColors:!0,size:.15,sizeAttenuation:!0,depthWrite:!1,color:"#00ff88"})]}),a.jsx(De,{radius:50,count:1e3,factor:2,fade:!0,speed:.2})]})},Qo=()=>a.jsxs("group",{children:[a.jsx(Ye,{count:300,scale:[20,10,0],size:4,speed:2,opacity:.5,color:"#00ff00",noise:1}),a.jsxs(ve,{speed:5,rotationIntensity:0,floatIntensity:0,children:[a.jsx(an,{args:[.1,20,.1],position:[-5,0,-5],children:a.jsx("meshBasicMaterial",{color:"#003300",transparent:!0,opacity:.5})}),a.jsx(an,{args:[.1,20,.1],position:[5,0,-5],children:a.jsx("meshBasicMaterial",{color:"#003300",transparent:!0,opacity:.5})})]})]}),el=()=>a.jsxs("group",{children:[a.jsx(De,{radius:30,count:200,factor:6,fade:!0,speed:.5,color:"#4488ff"}),a.jsxs("group",{position:[0,0,-5],children:[[...Array(5)].map((t,e)=>a.jsx(ve,{speed:1,rotationIntensity:1,floatIntensity:2,position:[Math.random()*10-5,Math.random()*6-3,Math.random()*5-5],children:a.jsx(it,{args:[.2,0],children:a.jsx("meshBasicMaterial",{color:"#4488ff",wireframe:!0})})},e)),a.jsx(Ye,{count:50,scale:15,size:2,speed:.2,opacity:.3,color:"#4488ff"})]})]}),tl=Ne({uTime:0,uColor:new ce("#00aaff")},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
      uniform float uTime;
      uniform vec3 uColor;
      varying vec2 vUv;
      void main() {
        float grid = step(0.95, fract(vUv.x * 20.0)) + step(0.95, fract(vUv.y * 20.0 + uTime * 0.2));
        float alpha = grid * (0.5 + 0.5 * sin(uTime + vUv.x * 10.0));
        gl_FragColor = vec4(uColor, alpha);
      }
    `);be({HoloShaderMaterial:tl});const nl=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsx("group",{rotation:[Math.PI/3,0,0],position:[0,-1,-2],children:a.jsxs("mesh",{scale:[e.width*2,e.height*2,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("holoShaderMaterial",{ref:t,transparent:!0})]})})},sl=()=>{const t=p.useMemo(()=>{const n=[];for(let s=0;s<50;s++)for(let i=0;i<50;i++)n.push(new Lt((s-25)*.5,0,(i-25)*.5));return n},[]),e=p.useRef();return q(n=>{if(!e.current)return;const s=e.current.geometry.attributes.position.array,i=n.clock.elapsedTime;for(let r=0;r<s.length;r+=3){const o=s[r],l=s[r+2];s[r+1]=Math.sin(o*.5+i)*Math.cos(l*.5+i)*1.5}e.current.geometry.attributes.position.needsUpdate=!0}),a.jsx("group",{rotation:[Math.PI/6,0,0],position:[0,-2,-5],children:a.jsxs(es,{ref:e,limit:2500,range:2500,children:[a.jsx("primitive",{object:new Jt().setFromPoints(t)}),a.jsx(ts,{transparent:!0,size:.1,color:"#ff00aa"})]})})},il=Ne({uTime:0,uColor:new ce("#ccff00")},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
      uniform float uTime;
      uniform vec3 uColor;
      varying vec2 vUv;
      // Hexagon SDF
      float hex(vec2 p) {
          p = abs(p);
          return max(p.x + p.y * 0.57735, p.y * 1.1547);
      }
      void main() {
        vec2 uv = vUv * 10.0;
        vec2 gv = fract(uv) - 0.5;
        vec2 id = floor(uv);
        float h = hex(gv);
        float pulse = sin(uTime * 2.0 + length(id) * 0.5) * 0.5 + 0.5;
        float mask = smoothstep(0.45, 0.46, h); // Hex border
        float fill = smoothstep(0.4, 0.0, h) * pulse;
        gl_FragColor = vec4(uColor, (1.0 - mask) * 0.2 + fill * 0.5);
      }
    `);be({HexShaderMaterial:il});const rl=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsxs("mesh",{scale:[e.width,e.height,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("hexShaderMaterial",{ref:t,transparent:!0})]})},al=()=>{const t=p.useRef();return q(e=>{t.current&&t.current.children.forEach((n,s)=>{const i=(e.clock.elapsedTime*.5+s*.2)%1;n.scale.setScalar(i*5),n.material.opacity=1-i})}),a.jsx("group",{ref:t,rotation:[Math.PI/3,0,0],children:[...Array(5)].map((e,n)=>a.jsx(ol,{},n))})},ol=t=>a.jsxs("mesh",{...t,rotation:[-Math.PI/2,0,0],children:[a.jsx("ringGeometry",{args:[.9,1,64]}),a.jsx("meshBasicMaterial",{color:"#00ffcc",transparent:!0,side:Ge})]}),ll=()=>{const t=p.useRef(),e=p.useRef(),n=p.useRef();return q(s=>{const i=s.clock.elapsedTime;t.current&&t.current.rotation.set(i*.2,i*.3,0),e.current&&e.current.rotation.set(i*.3,0,i*.2),n.current&&n.current.rotation.set(0,i*.2,i*.4)}),a.jsxs("group",{children:[a.jsx(oi,{args:[.5,32,32],children:a.jsx("meshStandardMaterial",{color:"#ff3366",emissive:"#aa0033",emissiveIntensity:2})}),a.jsx("group",{ref:t,children:a.jsx(st,{args:[3,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx("group",{ref:e,children:a.jsx(st,{args:[4,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx("group",{ref:n,children:a.jsx(st,{args:[5,.02,16,100],children:a.jsx("meshBasicMaterial",{color:"#ff3366"})})}),a.jsx(De,{radius:50,count:500,factor:2,fade:!0})]})},cl=Ne({uTime:0,uColor:new ce("#ffffff")},"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }",`
      uniform float uTime;
      uniform vec3 uColor;
      varying vec2 vUv;
      void main() {
        float scan = smoothstep(0.0, 0.05, abs(fract(vUv.y - uTime * 0.2) - 0.5)); // Moving line
        float grid = step(0.98, fract(vUv.x * 50.0)) + step(0.98, fract(vUv.y * 50.0));
        float alpha = (1.0 - scan) * 0.8 + grid * 0.1;
        gl_FragColor = vec4(uColor, alpha);
      }
    `);be({ScannerShaderMaterial:cl});const ul=()=>{const t=p.useRef(),{viewport:e}=pe();return q(n=>{t.current&&(t.current.uTime=n.clock.elapsedTime)}),a.jsxs("mesh",{scale:[e.width,e.height,1],children:[a.jsx("planeGeometry",{args:[1,1]}),a.jsx("scannerShaderMaterial",{ref:t,transparent:!0})]})},dl=()=>a.jsxs("group",{children:[a.jsx("color",{attach:"background",args:["#050505"]}),a.jsx("fog",{attach:"fog",args:["#050505",10,50]}),a.jsx("group",{rotation:[Math.PI/2.5,0,0],position:[0,-5,-10],children:a.jsx("gridHelper",{args:[100,40,3355443,1118481]})}),a.jsx(ve,{speed:1,rotationIntensity:.5,floatIntensity:.5,children:a.jsx(Ye,{count:100,scale:[20,10,15],size:2,speed:.2,opacity:.4,color:"#4488ff"})}),a.jsxs("group",{children:[a.jsxs(ve,{speed:2,rotationIntensity:0,floatIntensity:2,position:[-5,2,-10],children:[a.jsxs("mesh",{children:[a.jsx("sphereGeometry",{args:[.2,32,32]}),a.jsx("meshBasicMaterial",{color:"#4488ff",transparent:!0,opacity:.5})]}),a.jsx("pointLight",{distance:10,intensity:2,color:"#4488ff"})]}),a.jsxs(ve,{speed:3,rotationIntensity:0,floatIntensity:1.5,position:[5,-2,-15],children:[a.jsxs("mesh",{children:[a.jsx("sphereGeometry",{args:[.15,32,32]}),a.jsx("meshBasicMaterial",{color:"#00ffaa",transparent:!0,opacity:.5})]}),a.jsx("pointLight",{distance:10,intensity:2,color:"#00ffaa"})]})]}),a.jsx(Ns,{transparent:!0,opacity:.1,position:[0,0,-20],scale:[50,50,1]})]}),hl=({forcedTheme:t=null})=>{const{t:e}=Re(),[n,s]=p.useState(!1),i=p.useMemo(()=>({space:{name:e("themes.space.name"),icon:un,component:Uo,desc:e("themes.space.desc"),color:"text-purple-400",bg:"bg-purple-500/20"},water:{name:e("themes.water.name"),icon:Li,component:Bo,desc:e("themes.water.desc"),color:"text-blue-400",bg:"bg-blue-500/20"},matrix:{name:e("themes.matrix.name"),icon:dn,component:Fo,desc:e("themes.matrix.desc"),color:"text-green-400",bg:"bg-green-500/20"},grid:{name:e("themes.grid.name"),icon:dn,component:Ho,desc:e("themes.grid.desc"),color:"text-pink-400",bg:"bg-pink-500/20"},aurora:{name:e("themes.aurora.name"),icon:Ii,component:Go,desc:e("themes.aurora.desc"),color:"text-teal-400",bg:"bg-teal-500/20"},embers:{name:e("themes.embers.name"),icon:zi,component:Vo,desc:e("themes.embers.desc"),color:"text-orange-400",bg:"bg-orange-500/20"},crystal:{name:e("themes.crystal.name"),icon:Mi,component:Wo,desc:e("themes.crystal.desc"),color:"text-cyan-400",bg:"bg-cyan-500/20"},quantum:{name:e("themes.quantum.name"),icon:Oi,component:qo,desc:e("themes.quantum.desc"),color:"text-emerald-400",bg:"bg-emerald-500/20"},clouds:{name:e("themes.clouds.name"),icon:Pi,component:Zo,desc:e("themes.clouds.desc"),color:"text-sky-300",bg:"bg-sky-500/20"},tunnel:{name:e("themes.tunnel.name"),icon:ki,component:Xo,desc:e("themes.tunnel.desc"),color:"text-red-400",bg:"bg-red-500/20"},elegance:{name:e("themes.elegance.name"),icon:un,component:dl,desc:e("themes.elegance.desc"),color:"text-indigo-400",bg:"bg-indigo-500/20"},cyber:{name:e("themes.cyber.name"),icon:Ri,component:Jo,desc:e("themes.cyber.desc"),color:"text-cyan-500",bg:"bg-cyan-500/20"},dna:{name:e("themes.dna.name"),icon:Ni,component:Yo,desc:e("themes.dna.desc"),color:"text-green-500",bg:"bg-green-500/20"},binary:{name:e("themes.binary.name"),icon:Ei,component:Qo,desc:e("themes.binary.desc"),color:"text-green-300",bg:"bg-green-500/20"},network:{name:e("themes.network.name"),icon:_i,component:el,desc:e("themes.network.desc"),color:"text-blue-500",bg:"bg-blue-500/20"},holo:{name:e("themes.holo.name"),icon:ns,component:nl,desc:e("themes.holo.desc"),color:"text-sky-400",bg:"bg-sky-500/20"},wave:{name:e("themes.wave.name"),icon:Ti,component:sl,desc:e("themes.wave.desc"),color:"text-pink-500",bg:"bg-pink-500/20"},hex:{name:e("themes.hex.name"),icon:Ci,component:rl,desc:e("themes.hex.desc"),color:"text-yellow-400",bg:"bg-yellow-500/20"},sonar:{name:e("themes.sonar.name"),icon:ji,component:al,desc:e("themes.sonar.desc"),color:"text-teal-300",bg:"bg-teal-500/20"},orbit:{name:e("themes.orbit.name"),icon:Si,component:ll,desc:e("themes.orbit.desc"),color:"text-rose-400",bg:"bg-rose-500/20"},scanner:{name:e("themes.scanner.name"),icon:wi,component:ul,desc:e("themes.scanner.desc"),color:"text-gray-300",bg:"bg-gray-500/20"}}),[e]),[r,o]=p.useState(()=>{const m=localStorage.getItem("background_scene");return m&&i[m]?m:"elegance"}),[l,c]=p.useState(1.5),[u,h]=p.useState(!0);p.useEffect(()=>{t&&i[t]&&o(t)},[t]),p.useEffect(()=>{t||localStorage.setItem("background_scene",r)},[r,t]);const d=i[r].component;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 -z-10 bg-black",children:a.jsxs(ri,{dpr:l,camera:{position:[0,0,10],fov:60},gl:{antialias:!1,powerPreference:"high-performance"},children:[a.jsx(ai,{onDecline:()=>{c(1),h(!1)},onIncline:()=>{c(1.5),h(!0)}}),a.jsxs(p.Suspense,{fallback:null,children:[a.jsx(d,{}),u&&a.jsxs(Mo,{disableNormalPass:!0,children:[a.jsx(Io,{luminanceThreshold:.5,mipmapBlur:!0,intensity:1.5,radius:.4}),a.jsx(Lo,{opacity:.02}),a.jsx(Ao,{offset:.5,darkness:.5})]})]})]})}),a.jsxs("div",{className:"fixed bottom-6 right-6 z-50",children:[a.jsx(re,{children:n&&a.jsxs(L.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"absolute bottom-16 right-0 bg-[#0f172a]/90 backdrop-blur-xl border border-white/10 p-4 rounded-2xl shadow-2xl w-80 mb-2 max-h-[80vh] overflow-y-auto custom-scrollbar",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4 text-white/80 sticky top-0 bg-[#0f172a]/95 p-2 rounded-lg z-10 backdrop-blur-md",children:[a.jsx(hn,{size:16}),a.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest",children:["Ambient Themes (",Object.keys(i).length,")"]})]}),a.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(i).map(([m,f])=>{const g=f.icon,v=r===m;return a.jsx("button",{onClick:()=>o(m),className:`w-full text-left p-3 rounded-xl transition-all duration-300 border group relative overflow-hidden
                        ${v?`${f.bg} border-${f.color.split("-")[1]}-500/50`:"bg-white/5 border-transparent hover:bg-white/10"}`,children:a.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${v?"bg-black/20":"bg-black/40"} ${f.color}`,children:a.jsx(g,{size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:`font-bold text-sm ${v?"text-white":"text-gray-300"}`,children:f.name}),a.jsx("div",{className:"text-[10px] text-white/50 font-mono uppercase tracking-wider",children:f.desc})]}),v&&a.jsx("div",{className:"ml-auto",children:a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${f.color.replace("text","bg")}`}),a.jsx("span",{className:`relative inline-flex rounded-full h-2 w-2 ${f.color.replace("text","bg")}`})]})})]})},m)})})]})}),a.jsx("button",{onClick:()=>s(!n),className:`p-4 rounded-full shadow-[0_0_30px_rgba(255,255,255,0.2)] transition-all duration-500 border border-white/10 relative group
            ${n?"bg-white text-black rotate-90 scale-110":"bg-black/80 text-white hover:bg-white/20 backdrop-blur-md hover:scale-105"}`,children:n?a.jsx(we,{size:24}):a.jsx(hn,{size:24})})]})]})},fl=({isPlaying:t})=>a.jsx("div",{className:"flex items-end justify-center gap-1 h-8 w-full mb-2 opacity-50",children:[...Array(20)].map((e,n)=>a.jsx(L.div,{className:"w-1 bg-gradient-to-t from-cyan-500 to-blue-600 rounded-t-full",animate:{height:t?[4,Math.random()*24+4,4]:4},transition:{duration:.4,repeat:1/0,repeatType:"reverse",delay:n*.05,ease:"easeInOut"}},n))}),pl=()=>{const{currentTrack:t,isPlaying:e,togglePlay:n,nextTrack:s,prevTrack:i,audioRef:r,isMiniPlayerVisible:o,setIsMiniPlayerVisible:l}=Ki(),[c,u]=p.useState(0),[h,d]=p.useState(0),m=St();p.useEffect(()=>{const v=r.current,x=()=>{u(v.currentTime),d(v.duration||0)};return v.addEventListener("timeupdate",x),v.addEventListener("loadedmetadata",x),()=>{v.removeEventListener("timeupdate",x),v.removeEventListener("loadedmetadata",x)}},[r]);const f=v=>{if(!v)return"0:00";const x=Math.floor(v/60),w=Math.floor(v%60);return`${x}:${w<10?"0":""}${w}`},g=v=>{const x=parseFloat(v.target.value);r.current.currentTime=x,u(x)};return!t||!o||m.pathname==="/music"?null:a.jsx(L.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},drag:!0,dragMomentum:!1,whileDrag:{scale:1.05,cursor:"grabbing"},className:"fixed bottom-[calc(5rem+env(safe-area-inset-bottom))] md:bottom-4 right-0 md:right-4 z-[80] w-full md:w-auto max-w-md cursor-grab active:cursor-grabbing px-4 md:px-0",children:a.jsxs("div",{className:"bg-[#0a0a0a] border border-white/20 rounded-2xl p-4 shadow-2xl flex flex-col relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-20 pointer-events-none z-0",children:a.jsx(fl,{isPlaying:e})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[a.jsx("div",{className:"w-1 h-8 bg-white/10 rounded-full"}),a.jsxs("div",{className:"w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 relative group",children:[a.jsx("img",{src:t.cover,alt:t.title,className:`w-full h-full object-cover ${e?"animate-[spin_4s_linear_infinite]":""}`}),a.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(qe,{size:16,className:"text-white"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"truncate pr-2",children:[a.jsx("h4",{className:"font-bold text-white text-sm truncate",children:t.title}),a.jsx("p",{className:"text-xs text-gray-400 truncate",children:t.artist})]}),a.jsx("button",{onClick:()=>l(!1),className:"p-2 -mr-2 text-gray-400 hover:text-white active:scale-95 transition-transform",children:a.jsx(we,{size:20})})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("span",{className:"text-[10px] text-gray-500 font-mono w-8 text-right",children:f(c)}),a.jsx("input",{type:"range",min:"0",max:h||100,value:c,onChange:g,className:"flex-1 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-2 [&::-webkit-slider-thumb]:h-2 [&::-webkit-slider-thumb]:bg-cyan-500 [&::-webkit-slider-thumb]:rounded-full"}),a.jsx("span",{className:"text-[10px] text-gray-500 font-mono w-8",children:f(h)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-full text-white transition-colors",children:a.jsx(Ai,{size:18})}),a.jsx("button",{onClick:n,className:"p-3 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-400 hover:to-blue-400 text-white rounded-full transition-all hover:scale-105 shadow-[0_0_15px_rgba(6,182,212,0.5)]",children:e?a.jsx(Ui,{size:20,fill:"currentColor"}):a.jsx(Di,{size:20,fill:"currentColor",className:"ml-0.5"})}),a.jsx("button",{onClick:s,className:"p-2 hover:bg-white/10 rounded-full text-white transition-colors",children:a.jsx(Bi,{size:18})})]})]})]})})},ml=()=>{const[t,e]=p.useState(!1);p.useEffect(()=>{const s=()=>{window.pageYOffset>300?e(!0):e(!1)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]);const n=()=>{window.scrollTo({top:0,behavior:"smooth"})};return a.jsx(re,{children:t&&a.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed bottom-24 right-6 z-40",children:a.jsx("button",{onClick:n,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg transition-colors border border-white/20 backdrop-blur-md",title:"Scroll to Top",children:a.jsx(Fi,{size:24})})})})},gl=()=>{const[t,e]=p.useState({x:0,y:0}),[n,s]=p.useState(!1);return p.useEffect(()=>{const i=u=>{e({x:u.clientX,y:u.clientY})},r=()=>s(!0),o=()=>s(!1);window.addEventListener("mousemove",i);const l=document.querySelectorAll("a, button, input, textarea, .cursor-pointer");l.forEach(u=>{u.addEventListener("mouseenter",r),u.addEventListener("mouseleave",o)});const c=new MutationObserver(()=>{document.querySelectorAll("a, button, input, textarea, .cursor-pointer").forEach(h=>{h.removeEventListener("mouseenter",r),h.removeEventListener("mouseleave",o),h.addEventListener("mouseenter",r),h.addEventListener("mouseleave",o)})});return c.observe(document.body,{childList:!0,subtree:!0}),document.body.style.cursor="none",()=>{window.removeEventListener("mousemove",i),l.forEach(u=>{u.removeEventListener("mouseenter",r),u.removeEventListener("mouseleave",o)}),c.disconnect(),document.body.style.cursor="auto"}},[]),a.jsxs(a.Fragment,{children:[a.jsx(L.div,{className:"fixed top-0 left-0 w-3 h-3 bg-white rounded-full pointer-events-none z-[9999] mix-blend-difference",animate:{x:t.x-6,y:t.y-6,scale:n?0:1,opacity:n?0:1},transition:{type:"spring",stiffness:1e3,damping:50,mass:.1}}),a.jsx(L.div,{className:"fixed top-0 left-0 w-8 h-8 border border-white rounded-full pointer-events-none z-[9998] mix-blend-difference",animate:{x:t.x-16,y:t.y-16,scale:n?2.5:1,backgroundColor:n?"rgba(255, 255, 255, 1)":"rgba(255, 255, 255, 0)",borderWidth:n?"0px":"1px",mixBlendMode:"difference"},transition:{type:"spring",stiffness:300,damping:25,mass:.5}})]})},vl=()=>{const{scrollYProgress:t}=Ds();return a.jsx(L.div,{className:"fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 origin-left z-[100]",style:{scaleX:t}})},xl=()=>{const[t,e]=p.useState(null),[n,s]=p.useState(!1);p.useEffect(()=>{const r=o=>{o.preventDefault(),e(o),s(!0)};return window.addEventListener("beforeinstallprompt",r),()=>{window.removeEventListener("beforeinstallprompt",r)}},[]);const i=async()=>{if(!t)return;t.prompt();const{outcome:r}=await t.userChoice;e(null),s(!1)};return a.jsx(re,{children:n&&a.jsxs(L.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-6 right-6 z-[100] flex items-center gap-4 bg-[#111] border border-white/10 p-4 rounded-2xl shadow-2xl max-w-sm",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-600 p-3 rounded-xl",children:a.jsx(Hi,{size:24,className:"text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-bold text-white text-sm",children:"Install App"}),a.jsx("p",{className:"text-xs text-gray-400",children:"Install our app for a better experience"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>s(!1),className:"p-2 text-gray-400 hover:text-white transition-colors",children:a.jsx(we,{size:18})}),a.jsx("button",{onClick:i,className:"px-4 py-2 bg-white text-black text-xs font-bold rounded-lg hover:bg-gray-200 transition-colors",children:"Install"})]})]})})},yl=()=>{const{t}=Re(),[e,n]=p.useState(!1),[s,i]=p.useState(""),[r,o]=p.useState([]),[l,c]=p.useState(0),[u,h]=p.useState(!1),d=p.useRef(null),m=Bs();p.useEffect(()=>{const x=S=>{(S.metaKey||S.ctrlKey)&&S.key==="k"&&(S.preventDefault(),n(b=>!b)),S.key==="Escape"&&n(!1)},w=()=>n(!0);return window.addEventListener("keydown",x),window.addEventListener("open-search-palette",w),()=>{window.removeEventListener("keydown",x),window.removeEventListener("open-search-palette",w)}},[]),p.useEffect(()=>{e?setTimeout(()=>{var x;return(x=d.current)==null?void 0:x.focus()},100):(i(""),o([]))},[e]),p.useEffect(()=>{const x=setTimeout(()=>{s.length>=2?(h(!0),U.get(`/search?q=${s}`).then(w=>{o(w.data),c(0),h(!1)}).catch(w=>{console.error(w),h(!1)})):o([])},300);return()=>clearTimeout(x)},[s]);const f=x=>{x.key==="ArrowDown"?(x.preventDefault(),c(w=>(w+1)%r.length)):x.key==="ArrowUp"?(x.preventDefault(),c(w=>(w-1+r.length)%r.length)):x.key==="Enter"&&(x.preventDefault(),r[l]&&g(r[l]))},g=x=>{m(`${x.link}?id=${x.id}`),n(!1)},v=x=>{switch(x){case"photo":return a.jsx(ft,{size:16,className:"text-purple-400"});case"music":return a.jsx(qe,{size:16,className:"text-pink-400"});case"video":return a.jsx(pt,{size:16,className:"text-blue-400"});case"article":return a.jsx(mt,{size:16,className:"text-yellow-400"});case"event":return a.jsx(gt,{size:16,className:"text-green-400"});default:return a.jsx(Ve,{size:16})}};return e?a.jsx(re,{children:a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center md:pt-[20vh] md:px-4",children:[a.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>n(!1),className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),a.jsxs(L.div,{initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{duration:.2},className:"relative w-full h-[100dvh] md:h-auto md:max-w-2xl bg-[#1a1a1a] border-0 md:border md:border-white/10 rounded-none md:rounded-xl shadow-2xl overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-white/10 shrink-0 mt-[env(safe-area-inset-top)] md:mt-0",children:[a.jsx(Ve,{className:"text-gray-400",size:20}),a.jsx("input",{ref:d,type:"text",value:s,onChange:x=>i(x.target.value),onKeyDown:f,placeholder:t("search.placeholder"),className:"flex-1 bg-transparent text-white placeholder-gray-500 focus:outline-none text-lg"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("kbd",{className:"hidden md:inline-flex items-center gap-1 px-2 py-1 bg-white/5 rounded text-xs text-gray-400 font-mono",children:a.jsx("span",{className:"text-xs",children:"ESC"})}),a.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-white p-2",children:a.jsx(we,{size:20})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 pb-[env(safe-area-inset-bottom)]",children:u?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Searching..."}):r.length>0?a.jsx("div",{className:"space-y-1",children:r.map((x,w)=>a.jsxs(L.button,{layout:!0,onClick:()=>g(x),onMouseEnter:()=>c(w),className:`w-full flex items-center gap-4 px-4 py-3 rounded-lg transition-colors ${w===l?"bg-white/10":"hover:bg-white/5"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded bg-black/50 overflow-hidden flex-shrink-0 border border-white/10",children:x.image?a.jsx("img",{src:x.image,alt:"",className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:v(x.type)})}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("h4",{className:`text-sm font-medium ${w===l?"text-white":"text-gray-300"}`,children:x.title}),a.jsx("span",{className:"text-xs text-gray-500 capitalize",children:x.type})]}),w===l&&a.jsx(rs,{size:16,className:"text-gray-400"})]},`${x.type}-${x.id}`))}):s.length>=2?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:['No results found for "',s,'"']}):a.jsxs("div",{className:"p-12 text-center text-gray-500",children:[a.jsx($i,{className:"mx-auto mb-4 opacity-20",size:48}),a.jsx("p",{children:"Type to search photos, music, videos, and more..."})]})}),a.jsxs("div",{className:"bg-black/20 px-4 py-2 border-t border-white/5 text-xs text-gray-500 flex justify-between",children:[a.jsx("span",{children:"Pro tip: Use arrow keys to navigate"}),a.jsx("span",{children:"Lumos Search"})]})]})]})}):null},bl=()=>{const{t}=Re(),e=St(),{user:n}=Qe(),[s,i]=p.useState(!1),[r,o]=p.useState(!1),l=[{key:"events",path:"/events",icon:gt},{key:"about",path:"/about",icon:Gi},{key:"menu",action:"menu",icon:Vi}],c=[{key:"gallery",path:"/gallery",icon:ft},{key:"music",path:"/music",icon:qe},{key:"videos",path:"/videos",icon:pt},{key:"articles",path:"/articles",icon:mt}];n&&c.push({key:"profile",path:"/admin",icon:Yt});const u=d=>{navigator.vibrate&&navigator.vibrate(10),d==="menu"?i(!0):d==="login"&&o(!0)},h=()=>{navigator.vibrate&&navigator.vibrate(10),i(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-[90] bg-black/90 backdrop-blur-xl border-t border-white/10 pb-[env(safe-area-inset-bottom)] md:hidden app-select-none",children:a.jsx("div",{className:"flex justify-around items-center h-16 px-2",children:l.map(d=>{const m=e.pathname===d.path,f=d.icon;return d.action?a.jsx("button",{onClick:()=>u(d.action),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${s&&d.action==="menu"?"text-indigo-400":"text-gray-400 hover:text-white"}`,children:a.jsxs(L.div,{whileTap:{scale:.9},className:"flex flex-col items-center gap-1",children:[a.jsx(f,{size:20}),a.jsx("span",{className:"text-[10px] font-medium",children:d.key==="menu"?"":d.key==="about"?"":t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))})]})},d.key):a.jsx(lt,{to:d.path,onClick:h,className:`flex flex-col items-center justify-center w-full h-full transition-colors ${m&&!s?"text-indigo-400":"text-gray-400 hover:text-white"}`,children:a.jsxs(L.div,{whileTap:{scale:.9},className:"flex flex-col items-center gap-1",children:[a.jsx(f,{size:20,strokeWidth:m&&!s?2.5:2}),a.jsx("span",{className:"text-[10px] font-medium",children:t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))}),m&&!s&&a.jsx(L.div,{layoutId:"activeTab",className:"absolute bottom-1 w-1 h-1 bg-indigo-400 rounded-full"})]})},d.key)})})}),a.jsx(re,{children:s&&a.jsxs(L.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},drag:"y",dragConstraints:{top:0},dragElastic:.1,onDragEnd:(d,m)=>{m.offset.y>100&&i(!1)},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[100] bg-[#0a0a0a] md:hidden flex flex-col touch-none",children:[a.jsx("div",{className:"w-full flex justify-center pt-3 pb-1",onClick:()=>i(!1),children:a.jsx("div",{className:"w-12 h-1.5 bg-white/20 rounded-full"})}),a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10 bg-black/50 backdrop-blur-md",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:t("nav.more","Menu")}),a.jsx("button",{onClick:()=>i(!1),className:"p-2 bg-white/10 rounded-full text-white hover:bg-white/20",children:a.jsx(we,{size:24})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsx("div",{className:"grid grid-cols-2 gap-4",children:c.map(d=>d.action?a.jsxs("button",{onClick:()=>{i(!1),u(d.action)},className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition-colors aspect-square",children:[a.jsx(d.icon,{size:32,className:"text-indigo-400"}),a.jsx("span",{className:"font-medium text-white",children:d.key==="login"?"":t(`nav.${d.key}`,d.key)})]},d.key):a.jsxs(lt,{to:d.path,onClick:()=>i(!1),className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/5 border border-white/10 rounded-2xl hover:bg-white/10 transition-colors aspect-square",children:[a.jsx(d.icon,{size:32,className:"text-indigo-400"}),a.jsx("span",{className:"font-medium text-white",children:t(`nav.${d.key}`,d.key.charAt(0).toUpperCase()+d.key.slice(1))})]},d.key))})})]})}),a.jsx(js,{isOpen:r,onClose:()=>o(!1)})]})},wl=p.lazy(()=>Y(()=>import("./Hero-DspoqsMo.js"),__vite__mapDeps([0,1,2,3,4])));p.lazy(()=>Y(()=>import("./HomeFeed-BVo34rP5.js"),__vite__mapDeps([5,1,6,3,2,4,7])));const Sl=p.lazy(()=>Y(()=>import("./Gallery-oQo-WamG.js"),__vite__mapDeps([8,1,2,3,6,9,10,7,4]))),jl=p.lazy(()=>Y(()=>import("./Music-CF0UORYD.js"),__vite__mapDeps([11,1,9,2,10,7,3,4]))),Cl=p.lazy(()=>Y(()=>import("./Videos-BgOF1a7p.js"),__vite__mapDeps([12,1,9,2,10,7,3,4]))),Tl=p.lazy(()=>Y(()=>import("./Articles-DTy2svy1.js"),__vite__mapDeps([13,1,7,2,9,10,4,3]))),_l=p.lazy(()=>Y(()=>import("./Events-B7QEzDzg.js"),__vite__mapDeps([14,1,9,2,10,7,3,4]))),El=p.lazy(()=>Y(()=>import("./HomeCategories-D_Wjpggf.js"),__vite__mapDeps([15,1,2,3,4]))),Rs=p.lazy(()=>Y(()=>import("./About-UCF19xrp.js"),__vite__mapDeps([16,1,2,3,4]))),Nl=p.lazy(()=>Y(()=>import("./AdminDashboard-CvUxG2Qb.js"),__vite__mapDeps([17,1,2,10,3,4]))),Rl=p.lazy(()=>Y(()=>import("./NotFound-C3j7AqEx.js"),__vite__mapDeps([18,1,2,3,4]))),kl=()=>a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black text-white",children:a.jsx(is,{className:"animate-spin",size:48})}),Pl=()=>a.jsxs(a.Fragment,{children:[a.jsx(wl,{}),a.jsx(El,{}),a.jsx(Rs,{})]}),Ol=()=>{const t=St();t.pathname.startsWith("/admin");const e=t.pathname.startsWith("/admin"),{cursorEnabled:n}=ls();return a.jsxs(a.Fragment,{children:[!e&&a.jsx(ze,{variant:"inline",silent:!0,children:a.jsx(da,{})}),!e&&a.jsx(ze,{variant:"inline",silent:!0,children:a.jsx(hl,{})}),!e&&n&&a.jsx("div",{className:"hidden md:block",children:a.jsx(gl,{})}),!e&&a.jsx(vl,{}),a.jsx(ze,{variant:"inline",silent:!0,children:a.jsx(yl,{})}),a.jsx("main",{className:"pb-[calc(4rem+env(safe-area-inset-bottom))] md:pb-0",children:a.jsx(p.Suspense,{fallback:a.jsx(kl,{}),children:a.jsxs(Hs,{children:[a.jsx(he,{path:"/",element:a.jsx(Pl,{})}),a.jsx(he,{path:"/gallery",element:a.jsx(Sl,{})}),a.jsx(he,{path:"/music",element:a.jsx(jl,{})}),a.jsx(he,{path:"/videos",element:a.jsx(Cl,{})}),a.jsx(he,{path:"/articles",element:a.jsx(Tl,{})}),a.jsx(he,{path:"/events",element:a.jsx(_l,{})}),a.jsx(he,{path:"/about",element:a.jsx(Rs,{})}),a.jsx(he,{path:"/admin",element:a.jsx(Nl,{})}),a.jsx(he,{path:"*",element:a.jsx(Rl,{})})]})})}),!e&&a.jsx(ze,{variant:"inline",silent:!0,children:a.jsx(pl,{})}),!e&&a.jsx(bl,{}),a.jsx(ml,{}),a.jsx(xl,{})]})},Ml=()=>a.jsx(gs,{children:a.jsx(ze,{children:a.jsx(Xi,{children:a.jsx(Zi,{children:a.jsx(qi,{children:a.jsxs(Fs,{children:[a.jsx(Ol,{}),a.jsx(Wi,{position:"bottom-right",toastOptions:{style:{background:"#333",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}}})]})})})})})}),{slice:zl,forEach:Il}=[];function Ll(t){return Il.call(zl.call(arguments,1),e=>{if(e)for(const n in e)t[n]===void 0&&(t[n]=e[n])}),t}function Al(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const Bn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Ul=function(t,e){const s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(e);let r=`${t}=${i}`;if(s.maxAge>0){const o=s.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(o)}`}if(s.domain){if(!Bn.test(s.domain))throw new TypeError("option domain is invalid");r+=`; Domain=${s.domain}`}if(s.path){if(!Bn.test(s.path))throw new TypeError("option path is invalid");r+=`; Path=${s.path}`}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");r+=`; Expires=${s.expires.toUTCString()}`}if(s.httpOnly&&(r+="; HttpOnly"),s.secure&&(r+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s.partitioned&&(r+="; Partitioned"),r},Fn={create(t,e,n,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+n*60*1e3)),s&&(i.domain=s),document.cookie=Ul(t,e,i)},read(t){const e=`${t}=`,n=document.cookie.split(";");for(let s=0;s<n.length;s++){let i=n[s];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return i.substring(e.length,i.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var Dl={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return Fn.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:n,cookieMinutes:s,cookieDomain:i,cookieOptions:r}=e;n&&typeof document<"u"&&Fn.create(n,t,s,i,r)}},Bl={name:"querystring",lookup(t){var s;let{lookupQuerystring:e}=t,n;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&((s=window.location.hash)==null?void 0:s.indexOf("?"))>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const o=i.substring(1).split("&");for(let l=0;l<o.length;l++){const c=o[l].indexOf("=");c>0&&o[l].substring(0,c)===e&&(n=o[l].substring(c+1))}}return n}},Fl={name:"hash",lookup(t){var i;let{lookupHash:e,lookupFromHashIndex:n}=t,s;if(typeof window<"u"){const{hash:r}=window.location;if(r&&r.length>2){const o=r.substring(1);if(e){const l=o.split("&");for(let c=0;c<l.length;c++){const u=l[c].indexOf("=");u>0&&l[c].substring(0,u)===e&&(s=l[c].substring(u+1))}}if(s)return s;if(!s&&n>-1){const l=r.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(i=l[typeof n=="number"?n:0])==null?void 0:i.replace("/",""):void 0}}}return s}};let Oe=null;const Hn=()=>{if(Oe!==null)return Oe;try{if(Oe=typeof window<"u"&&window.localStorage!==null,!Oe)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Oe=!1}return Oe};var Hl={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&Hn())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:n}=e;n&&Hn()&&window.localStorage.setItem(n,t)}};let Me=null;const $n=()=>{if(Me!==null)return Me;try{if(Me=typeof window<"u"&&window.sessionStorage!==null,!Me)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Me=!1}return Me};var $l={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&$n())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:n}=e;n&&$n()&&window.sessionStorage.setItem(n,t)}},Gl={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:n,userLanguage:s,language:i}=navigator;if(n)for(let r=0;r<n.length;r++)e.push(n[r]);s&&e.push(s),i&&e.push(i)}return e.length>0?e:void 0}},Vl={name:"htmlTag",lookup(t){let{htmlTag:e}=t,n;const s=e||(typeof document<"u"?document.documentElement:null);return s&&typeof s.getAttribute=="function"&&(n=s.getAttribute("lang")),n}},Wl={name:"path",lookup(t){var i;let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(i=n[typeof e=="number"?e:0])==null?void 0:i.replace("/",""):void 0}},Kl={name:"subdomain",lookup(t){var i,r;let{lookupFromSubdomainIndex:e}=t;const n=typeof e=="number"?e+1:1,s=typeof window<"u"&&((r=(i=window.location)==null?void 0:i.hostname)==null?void 0:r.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(s)return s[n]}};let ks=!1;try{document.cookie,ks=!0}catch{}const Ps=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];ks||Ps.splice(1,1);const ql=()=>({order:Ps,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class Os{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,n)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=Ll(n,this.options||{},ql()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(Dl),this.addDetector(Bl),this.addDetector(Hl),this.addDetector($l),this.addDetector(Gl),this.addDetector(Vl),this.addDetector(Wl),this.addDetector(Kl),this.addDetector(Fl)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return e.forEach(s=>{if(this.detectors[s]){let i=this.detectors[s].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(n=n.concat(i))}}),n=n.filter(s=>s!=null&&!Al(s)).map(s=>this.options.convertDetectedLanguage(s)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||n.forEach(s=>{this.detectors[s]&&this.detectors[s].cacheUserLanguage(e,this.options)}))}}Os.type="languageDetector";function Wt(t){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(t)}function Ms(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":Wt(XMLHttpRequest))==="object"}function Zl(t){return!!t&&typeof t.then=="function"}function Xl(t){return Zl(t)?t:Promise.resolve(t)}function Gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function Vn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Gn(Object(n),!0).forEach(function(s){Jl(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Jl(t,e,n){return(e=Yl(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yl(t){var e=Ql(t,"string");return _e(e)=="symbol"?e:e+""}function Ql(t,e){if(_e(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(_e(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _e(t){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(t)}var xe=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?xe=global.fetch:typeof window<"u"&&window.fetch&&(xe=window.fetch);var Je;Ms()&&(typeof global<"u"&&global.XMLHttpRequest?Je=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Je=window.XMLHttpRequest));var wt;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?wt=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(wt=window.ActiveXObject));typeof xe!="function"&&(xe=void 0);if(!xe&&!Je&&!wt)try{Y(()=>import("./browser-ponyfill-ISVO8D-X.js").then(t=>t.b),__vite__mapDeps([19,1])).then(function(t){xe=t.default}).catch(function(){})}catch{}var Kt=function(e,n){if(n&&_e(n)==="object"){var s="";for(var i in n)s+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n[i]);if(!s)return e;e=e+(e.indexOf("?")!==-1?"&":"?")+s.slice(1)}return e},Wn=function(e,n,s,i){var r=function(c){if(!c.ok)return s(c.statusText||"Error",{status:c.status});c.text().then(function(u){s(null,{status:c.status,data:u})}).catch(s)};if(i){var o=i(e,n);if(o instanceof Promise){o.then(r).catch(s);return}}typeof fetch=="function"?fetch(e,n).then(r).catch(s):xe(e,n).then(r).catch(s)},Kn=!1,ec=function(e,n,s,i){e.queryStringParams&&(n=Kt(n,e.queryStringParams));var r=Vn({},typeof e.customHeaders=="function"?e.customHeaders():e.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(r["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),s&&(r["Content-Type"]="application/json");var o=typeof e.requestOptions=="function"?e.requestOptions(s):e.requestOptions,l=Vn({method:s?"POST":"GET",body:s?e.stringify(s):void 0,headers:r},Kn?{}:o),c=typeof e.alternateFetch=="function"&&e.alternateFetch.length>=1?e.alternateFetch:void 0;try{Wn(n,l,i,c)}catch(u){if(!o||Object.keys(o).length===0||!u.message||u.message.indexOf("not implemented")<0)return i(u);try{Object.keys(o).forEach(function(h){delete l[h]}),Wn(n,l,i,c),Kn=!0}catch(h){i(h)}}},tc=function(e,n,s,i){s&&_e(s)==="object"&&(s=Kt("",s).slice(1)),e.queryStringParams&&(n=Kt(n,e.queryStringParams));try{var r=Je?new Je:new wt("MSXML2.XMLHTTP.3.0");r.open(s?"POST":"GET",n,1),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!e.withCredentials,s&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var o=e.customHeaders;if(o=typeof o=="function"?o():o,o)for(var l in o)r.setRequestHeader(l,o[l]);r.onreadystatechange=function(){r.readyState>3&&i(r.status>=400?r.statusText:null,{status:r.status,data:r.responseText})},r.send(s)}catch(c){console&&console.log(c)}},nc=function(e,n,s,i){if(typeof s=="function"&&(i=s,s=void 0),i=i||function(){},xe&&n.indexOf("file:")!==0)return ec(e,n,s,i);if(Ms()||typeof ActiveXObject=="function")return tc(e,n,s,i);i(new Error("No fetch and no xhr implementation found!"))};function Ae(t){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(t)}function qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,s)}return n}function zt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qn(Object(n),!0).forEach(function(s){zs(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function sc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ic(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,Is(s.key),s)}}function rc(t,e,n){return e&&ic(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zs(t,e,n){return(e=Is(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Is(t){var e=ac(t,"string");return Ae(e)=="symbol"?e:e+""}function ac(t,e){if(Ae(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Ae(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var oc=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(n){return JSON.parse(n)},stringify:JSON.stringify,parsePayload:function(n,s,i){return zs({},s,i||"")},parseLoadPayload:function(n,s){},request:nc,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Ls=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};sc(this,t),this.services=e,this.options=n,this.allOptions=s,this.type="backend",this.init(e,n,s)}return rc(t,[{key:"init",value:function(n){var s=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=n,this.options=zt(zt(zt({},oc()),this.options||{}),i),this.allOptions=r,this.services&&this.options.reloadInterval){var o=setInterval(function(){return s.reload()},this.options.reloadInterval);Ae(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(n,s,i){this._readAny(n,n,s,s,i)}},{key:"read",value:function(n,s,i){this._readAny([n],n,[s],s,i)}},{key:"_readAny",value:function(n,s,i,r,o){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(n,i)),c=Xl(c),c.then(function(u){if(!u)return o(null,{});var h=l.services.interpolator.interpolate(u,{lng:n.join("+"),ns:i.join("+")});l.loadUrl(h,o,s,r)})}},{key:"loadUrl",value:function(n,s,i,r){var o=this,l=typeof i=="string"?[i]:i,c=typeof r=="string"?[r]:r,u=this.options.parseLoadPayload(l,c);this.options.request(this.options,n,u,function(h,d){if(d&&(d.status>=500&&d.status<600||!d.status))return s("failed loading "+n+"; status code: "+d.status,!0);if(d&&d.status>=400&&d.status<500)return s("failed loading "+n+"; status code: "+d.status,!1);if(!d&&h&&h.message){var m=h.message.toLowerCase(),f=["failed","fetch","network","load"].find(function(x){return m.indexOf(x)>-1});if(f)return s("failed loading "+n+": "+h.message,!0)}if(h)return s(h,!1);var g,v;try{typeof d.data=="string"?g=o.options.parse(d.data,i,r):g=d.data}catch{v="failed parsing "+n+" to json"}if(v)return s(v,!1);s(null,g)})}},{key:"create",value:function(n,s,i,r,o){var l=this;if(this.options.addPath){typeof n=="string"&&(n=[n]);var c=this.options.parsePayload(s,i,r),u=0,h=[],d=[];n.forEach(function(m){var f=l.options.addPath;typeof l.options.addPath=="function"&&(f=l.options.addPath(m,s));var g=l.services.interpolator.interpolate(f,{lng:m,ns:s});l.options.request(l.options,g,c,function(v,x){u+=1,h.push(v),d.push(x),u===n.length&&typeof o=="function"&&o(h,d)})})}}},{key:"reload",value:function(){var n=this,s=this.services,i=s.backendConnector,r=s.languageUtils,o=s.logger,l=i.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],u=function(d){var m=r.toResolveHierarchy(d);m.forEach(function(f){c.indexOf(f)<0&&c.push(f)})};u(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(h){return u(h)}),c.forEach(function(h){n.allOptions.ns.forEach(function(d){i.read(h,d,"read",null,null,function(m,f){m&&o.warn("loading namespace ".concat(d," for language ").concat(h," failed"),m),!m&&f&&o.log("loaded namespace ".concat(d," for language ").concat(h),f),i.loaded("".concat(h,"|").concat(d),m,f)})})})}}}])}();Ls.type="backend";Z.use(Ls).use(Os).use(ta).init({fallbackLng:"zh",lng:"zh",debug:!1,interpolation:{escapeValue:!1},backend:{loadPath:"/locales/{{lng}}/translation.json"},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});function lc(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=t;let l,c;const u=async(d=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(l=await Y(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:d}},[]).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{o==null||o(d)}),!l)return;l.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),l.addEventListener("installed",d=>{d.isUpdate||s==null||s()}),l.register({immediate:e}).then(d=>{r?r("/sw.js",d):i==null||i(d)}).catch(d=>{o==null||o(d)})}}return c=h(),u}function cc(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:s,onRegistered:i,onRegisteredSW:r,onRegisterError:o}=t,[l,c]=p.useState(!1),[u,h]=p.useState(!1),[d]=p.useState(()=>lc({immediate:e,onOfflineReady(){h(!0),s==null||s()},onNeedRefresh(){c(!0),n==null||n()},onRegistered:i,onRegisteredSW:r,onRegisterError:o}));return{needRefresh:[l,c],offlineReady:[u,h],updateServiceWorker:d}}const uc=()=>(cc({onRegisteredSW(){},onNeedRefresh(){},onOfflineReady(){}}),null);li.createRoot(document.getElementById("root")).render(a.jsx(W.StrictMode,{children:a.jsx(ze,{children:a.jsx(W.Suspense,{fallback:a.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center text-white",children:"..."}),children:a.jsxs(a.Fragment,{children:[a.jsx(Ml,{}),a.jsx(uc,{})]})})})}));export{Pt as D,ze as E,oa as F,xc as H,ls as a,Ki as b,Qe as c,U as d,vc as e,gc as f,Re as u};
