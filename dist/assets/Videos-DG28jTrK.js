import{i as E,a as i,j as e,m as g,A}from"./react-vendor-CXoD4tGQ.js";import{U as R}from"./UploadModal-dRvqp98H.js";import{u as D,a as O,c as k,d as h,F as S}from"./index-CUunyc2c.js";import{S as B,a as K,P as L}from"./SortSelector-CEfZugKu.js";import{j as $,a4 as M,x as X,g as q,X as G}from"./ui-vendor-a_EBNgrH.js";import"./three-vendor-DzslHOQR.js";import"./utils-CclGfFy7.js";const ae=()=>{const{t:r}=D(),{settings:u}=O(),[f]=E(),[p,d]=i.useState([]),[v,j]=i.useState(!0),[c,C]=i.useState(1),[P,w]=i.useState(1),[x,_]=i.useState("newest"),[o,n]=i.useState(null),[z,y]=i.useState(!1),[F,H]=i.useState(0),[N,b]=i.useState(!1);k(o!==null,()=>n(null)),k(N,()=>b(!1)),i.useEffect(()=>{const t=f.get("id");t&&h.get(`/videos/${t}`).then(a=>{a.data&&n(a.data)}).catch(a=>console.error("Failed to fetch deep linked video",a))},[f]),i.useEffect(()=>{const t=u.pagination_enabled==="true"?12:1e3,a={page:c,limit:t,sort:x};h.get("/videos",{params:a}).then(s=>{d(s.data.data),w(s.data.pagination.totalPages),j(!1),y(!1)}).catch(s=>{console.error("Failed to fetch videos:",s),j(!1),y(!0)})},[c,x,u.pagination_enabled,F]);const T=t=>{h.post("/videos",t).then(()=>h.get(`/videos?page=${c}&limit=12`)).then(a=>{d(a.data.data),w(a.data.pagination.totalPages)}).catch(a=>console.error("Failed to save video",a))},U=t=>{T(t)},V=t=>{C(t),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("section",{className:"pt-24 pb-40 md:py-24 px-4 md:px-8 min-h-screen flex items-center justify-center relative z-10",children:[e.jsxs("div",{className:"max-w-7xl w-full mx-auto relative",children:[e.jsx("div",{className:"absolute right-0 top-0 flex items-center gap-4 z-20",children:e.jsx("button",{onClick:()=>b(!0),className:"bg-white/10 hover:bg-white/20 text-white p-2 md:p-3 rounded-full backdrop-blur-md border border-white/10 transition-all",title:r("common.upload_video"),children:e.jsx($,{size:18,className:"md:w-5 md:h-5"})})}),e.jsxs(g.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mb-8 md:mb-12 text-center",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold font-serif mb-4 md:mb-6",children:r("videos.title")}),e.jsx("p",{className:"text-gray-400 max-w-xl mx-auto",children:r("videos.subtitle")})]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-4 mb-8",children:e.jsx(B,{sort:x,onSortChange:_})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8",children:v&&p.length===0?[...Array(6)].map((t,a)=>e.jsxs("div",{className:"aspect-video rounded-2xl bg-gray-900 animate-pulse relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),e.jsxs("div",{className:"absolute bottom-6 left-6 right-6 space-y-3",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-1/4"}),e.jsx("div",{className:"h-6 bg-white/10 rounded w-3/4"})]})]},a)):z?e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-20 text-center",children:[e.jsx(M,{size:48,className:"text-red-400 mb-4 opacity-50 mx-auto"}),e.jsx("p",{className:"text-gray-300 mb-6",children:r("common.error_fetching_data")||"Failed to load videos"}),e.jsx("button",{onClick:refresh,className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all border border-white/10",children:"Retry"})]}):e.jsx(e.Fragment,{children:p.map((t,a)=>e.jsxs(g.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},transition:{delay:a*.1},viewport:{once:!0},onClick:()=>n(t),className:"group relative aspect-video rounded-2xl overflow-hidden bg-gray-900 cursor-pointer",children:[e.jsx(K,{src:t.thumbnail,alt:t.title,type:"video",className:"w-full h-full",imageClassName:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-80 group-hover:opacity-100",iconSize:48}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-60 group-hover:opacity-40 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-20 h-20 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center border border-white/30 shadow-[0_0_30px_rgba(255,255,255,0.2)] group-hover:scale-110 transition-transform duration-300",children:e.jsx(X,{size:40,fill:"white",className:"text-white ml-2"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full p-6 translate-y-2 group-hover:translate-y-0 transition-transform duration-300",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-bold text-white",children:t.title})}),e.jsx(S,{itemId:t.id,itemType:"video",size:18,showCount:!0,count:t.likes||0,favorited:t.favorited,initialFavorited:t.favorited,className:"p-2 bg-black/50 hover:bg-pink-500/20 rounded-full backdrop-blur-md transition-colors group/btn border border-white/10",onToggle:(s,l)=>{d(I=>I.map(m=>m.id===t.id?{...m,likes:l!==void 0?l:m.likes,favorited:s}:m))}})]})})]},t.id))})}),p.length===0&&!v&&e.jsxs("div",{className:"text-center py-20 text-gray-500",children:[e.jsx(q,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:r("videos.no_videos")})]}),u.pagination_enabled==="true"&&e.jsx(L,{currentPage:c,totalPages:P,onPageChange:V})]}),e.jsx(A,{children:o&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-md overflow-y-auto",onClick:()=>n(null),children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 md:p-12",children:e.jsxs("div",{className:"relative w-full max-w-5xl bg-black rounded-2xl overflow-hidden shadow-2xl flex flex-col border border-white/10",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"relative aspect-video bg-black",children:[e.jsx("button",{onClick:()=>n(null),className:"absolute top-4 right-4 z-10 p-3 bg-black/50 hover:bg-red-500/80 text-white rounded-full backdrop-blur-md border border-white/10 transition-all hover:rotate-90 shadow-lg",title:r("common.close_video"),children:e.jsx(G,{size:24})}),e.jsx("video",{src:o.video,controls:!0,autoPlay:!0,className:"w-full h-full",ref:t=>{t&&(t.playbackRate=1)}})]}),e.jsxs("div",{className:"p-6 bg-[#111] border-t border-white/10 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:o.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:new Date(o.created_at||Date.now()).toLocaleDateString()})]}),e.jsx(S,{itemId:o.id,itemType:"video",size:24,showCount:!0,count:o.likes||0,favorited:o.favorited,className:"p-3 bg-white/5 hover:bg-pink-500/20 rounded-full transition-colors border border-white/10",onToggle:(t,a)=>{n(s=>({...s,likes:a!==void 0?a:s.likes,favorited:t})),d(s=>s.map(l=>l.id===o.id?{...l,likes:a!==void 0?a:l.likes,favorited:t}:l))}})]})]})})})}),e.jsx(R,{isOpen:N,onClose:()=>b(!1),onUpload:U,type:"video"})]})};export{ae as default};
