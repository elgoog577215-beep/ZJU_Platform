import{a as n,j as s}from"./react-vendor-CXoD4tGQ.js";import{d as N}from"./index-D24czYHj.js";import{aM as k,X as C}from"./ui-vendor-ChojsKpE.js";const D=({value:u="",onChange:g,placeholder:w="Add tags..."})=>{const[o,l]=n.useState([]),[c,m]=n.useState(""),[p,b]=n.useState([]),[y,j]=n.useState([]),[v,a]=n.useState(!1),d=n.useRef(null),f=n.useRef(null);n.useEffect(()=>{l(u?u.split(",").map(e=>e.trim()).filter(Boolean):[])},[u]),n.useEffect(()=>{T()},[]),n.useEffect(()=>{const e=t=>{f.current&&!f.current.contains(t.target)&&!d.current.contains(t.target)&&a(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const T=async()=>{try{const e=await N.get("/tags");j(e.data)}catch(e){console.error("Failed to fetch tags",e)}},S=e=>{const t=e.target.value;if(m(t),t.trim()){const r=y.filter(i=>i.name.toLowerCase().includes(t.toLowerCase())&&!o.includes(i.name));b(r),a(!0)}else a(!1)},x=e=>{var r;const t=e.trim();if(t&&!o.includes(t)){const i=[...o,t];l(i),g(i.join(",")),m(""),a(!1),(r=d.current)==null||r.focus()}},h=e=>{const t=o.filter(r=>r!==e);l(t),g(t.join(","))},E=e=>{e.key==="Enter"?(e.preventDefault(),x(c)):e.key==="Backspace"&&!c&&o.length>0&&h(o[o.length-1])};return s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex flex-wrap gap-2 p-2 bg-black/20 border border-white/10 rounded-xl focus-within:border-indigo-500 transition-colors min-h-[50px]",children:[o.map((e,t)=>s.jsxs("span",{className:"flex items-center gap-1 bg-indigo-500/20 text-indigo-300 px-3 py-1 rounded-full text-sm border border-indigo-500/30",children:[s.jsx(k,{size:12}),e,s.jsx("button",{type:"button",onClick:()=>h(e),className:"hover:text-white transition-colors ml-1",children:s.jsx(C,{size:14})})]},t)),s.jsx("input",{ref:d,type:"text",value:c,onChange:S,onKeyDown:E,onFocus:()=>c&&a(!0),className:"bg-transparent border-none outline-none text-white placeholder-gray-500 flex-1 min-w-[120px]",placeholder:o.length===0?w:""})]}),v&&p.length>0&&s.jsx("div",{ref:f,className:"absolute z-50 left-0 right-0 mt-1 bg-gray-900 border border-white/10 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(e=>s.jsxs("button",{type:"button",onClick:()=>x(e.name),className:"w-full text-left px-4 py-2 text-gray-300 hover:bg-white/10 hover:text-white transition-colors flex justify-between items-center",children:[s.jsx("span",{children:e.name}),s.jsxs("span",{className:"text-xs text-gray-500",children:[e.count," usage"]})]},e.id))})]})};export{D as T};
