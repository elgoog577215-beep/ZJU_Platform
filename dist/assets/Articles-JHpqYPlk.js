import{i as T,a as x,j as e,m as p,A as U}from"./react-vendor-CXoD4tGQ.js";import{S as F,a as M,P as R}from"./SortSelector-B562cBW9.js";import{U as O}from"./UploadModal-BCRhrDF6.js";import{u as B,a as E,c as L,d as y,F as b}from"./index-C673R57o.js";import{u as V}from"./useCachedResource-CW4IgXYI.js";import{j as D,a4 as H,a7 as X,i as q,m as G,A as J,X as K,U as Q}from"./ui-vendor-a_EBNgrH.js";import"./three-vendor-DzslHOQR.js";import"./utils-CclGfFy7.js";const oe=()=>{const{t:l}=B(),{settings:u}=E(),[f]=T(),[n,k]=x.useState(1),[W,Y]=x.useState(null),[d,C]=x.useState("newest"),[a,c]=x.useState(null),[z,v]=x.useState(!1);L(a!==null,()=>c(null));const h=u.pagination_enabled==="true"?6:1e3,{data:j,pagination:g,loading:S,error:w,setData:$}=V("/articles",{page:n,limit:h,sort:d},{dependencies:[u.pagination_enabled]}),P=(g==null?void 0:g.totalPages)||1;x.useEffect(()=>{const t=f.get("id");t&&y.get(`/articles/${t}`).then(s=>{s.data&&c(s.data)}).catch(s=>console.error("Failed to fetch deep linked article",s))},[f]);const N=t=>{const i=t?t.split(/\s+/).length:0;return`${Math.ceil(i/200)} ${l("common.min_read")}`},I=t=>{y.post("/articles",t).then(()=>{mutate(`/articles?page=${n}&limit=${h}&sort=${d}`)}).catch(s=>console.error("Failed to save article",s))},_=t=>{I(t)},A=t=>{k(t),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("section",{className:"pt-24 pb-40 md:py-24 px-4 md:px-8 min-h-screen flex items-center justify-center relative z-10",children:[e.jsxs("div",{className:"max-w-5xl w-full mx-auto relative",children:[e.jsx("div",{className:"absolute right-0 top-0 flex items-center gap-4 z-20",children:e.jsx("button",{onClick:()=>v(!0),className:"bg-white/10 hover:bg-white/20 text-white p-2 md:p-3 rounded-full backdrop-blur-md border border-white/10 transition-all",title:l("common.upload_article"),children:e.jsx(D,{size:18,className:"md:w-5 md:h-5"})})}),e.jsxs(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mb-8 md:mb-12 text-center",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold font-serif mb-4 md:mb-6",children:l("articles.title")}),e.jsx("p",{className:"text-gray-400 max-w-xl mx-auto text-sm md:text-base",children:l("articles.subtitle")})]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-4 mb-12",children:e.jsx(F,{sort:d,onSortChange:C})}),e.jsxs("div",{className:"space-y-6",children:[w&&e.jsxs("div",{className:"text-center py-20 text-gray-500",children:[e.jsx(H,{size:48,className:"text-red-400 mb-4 opacity-50 mx-auto"}),e.jsx("p",{className:"text-gray-300 mb-6",children:l("common.error_fetching_data")||"Failed to load articles"}),e.jsx("button",{onClick:()=>mutate(`/articles?page=${n}&limit=${h}&sort=${d}`),className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all border border-white/10",children:l("common.retry")||"Retry"})]}),j.length===0&&!S&&!w&&e.jsxs("div",{className:"text-center py-20 text-gray-500",children:[e.jsx(X,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:l("articles.no_articles")})]}),j.map((t,s)=>e.jsxs(p.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},transition:{delay:s*.1},viewport:{once:!0},onClick:()=>c(t),className:"group relative bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl p-6 transition-all hover:border-white/20 cursor-pointer overflow-hidden hover:shadow-2xl hover:shadow-orange-500/10",children:[e.jsx("div",{className:"absolute inset-0 z-10 pointer-events-none overflow-hidden rounded-2xl",children:e.jsx("div",{className:"absolute top-0 left-0 w-1/2 h-full bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full shine-effect"})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[t.cover&&e.jsx("div",{className:"w-full md:w-48 h-48 md:h-32 rounded-xl overflow-hidden flex-shrink-0",children:e.jsx(M,{src:t.cover,alt:t.title,type:"article",className:"w-full h-full",imageClassName:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700",iconSize:32})}),e.jsx("div",{className:"absolute top-4 right-4 flex gap-2 md:hidden",children:e.jsx(b,{itemId:t.id,itemType:"article",size:16,showCount:!0,count:t.likes||0,initialFavorited:t.favorited,className:"p-2 bg-black/50 hover:bg-orange-500 rounded-full backdrop-blur-md transition-all group/btn border border-white/10",onToggle:(i,r)=>{mutate(`/articles?page=${n}&limit=${h}&sort=${d}`,m=>m&&{...m,data:m.data.map(o=>o.id===t.id?{...o,likes:r!==void 0?r:o.likes,favorited:i}:o)},!1)}})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{size:12}),t.date]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{size:12}),N(t.content)]})]}),e.jsx("h3",{className:"text-2xl font-bold text-white group-hover:text-orange-400 transition-colors",children:t.title}),e.jsx("p",{className:"text-gray-400 line-clamp-2",children:t.excerpt})]}),e.jsxs("div",{className:"hidden md:flex flex-col items-center justify-between pl-4 border-l border-white/5 py-2",children:[e.jsx("div",{className:"flex flex-col gap-3 items-center",children:e.jsx(b,{itemId:t.id,itemType:"article",size:16,showCount:!0,count:t.likes||0,initialFavorited:t.favorited,className:"p-2 bg-white/5 hover:bg-orange-500 rounded-full backdrop-blur-md transition-all border border-white/10",onToggle:(i,r)=>{$(m=>m.map(o=>o.id===t.id?{...o,likes:r!==void 0?r:o.likes,favorited:i}:o))}})}),e.jsx("div",{className:"p-3 rounded-full bg-white/5 group-hover:bg-orange-500 group-hover:text-black transition-all duration-300",children:e.jsx(J,{size:20,className:"-rotate-45 group-hover:rotate-0 transition-transform duration-300"})})]})]})]},t.id))]}),u.pagination_enabled==="true"&&e.jsx(R,{currentPage:n,totalPages:P,onPageChange:A})]}),e.jsx(U,{children:a&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-md overflow-y-auto",onClick:()=>c(null),children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 md:p-8",children:e.jsxs(p.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},onClick:t=>t.stopPropagation(),className:"relative w-full max-w-3xl bg-[#0a0a0a] border border-white/10 rounded-3xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"h-48 bg-gradient-to-br from-orange-900/40 to-black relative bg-cover bg-center",style:a.cover?{backgroundImage:`url(${a.cover})`}:{},children:[!a.cover&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-900/40 to-black"}),e.jsx("button",{onClick:()=>c(null),className:"absolute top-6 right-6 p-2 bg-black/50 text-white rounded-full hover:bg-white/20 transition-colors z-10",children:e.jsx(K,{size:24})}),e.jsxs("div",{className:"absolute bottom-0 left-0 w-full p-8 bg-gradient-to-t from-[#0a0a0a] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs font-mono text-orange-300 mb-2",children:[e.jsx("span",{children:a.date}),e.jsx("span",{children:"•"}),e.jsx("span",{children:N(a.content)})]}),e.jsx("h2",{className:"text-3xl md:text-4xl font-bold font-serif text-white leading-tight",children:a.title})]})]}),e.jsxs("div",{className:"p-8 md:p-12 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-8 pb-8 border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden",children:e.jsx(Q,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:l("common.admin_name")}),e.jsx("div",{className:"text-xs text-gray-500",children:l("common.author")})]})]}),e.jsx(b,{itemId:a.id,itemType:"article",size:24,showCount:!0,count:a.likes||0,initialFavorited:a.favorited,className:"p-3 bg-white/5 hover:bg-red-500/20 text-white rounded-full transition-all border border-white/10",onToggle:(t,s)=>{c(i=>({...i,likes:s!==void 0?s:i.likes,favorited:t})),mutate(`/articles?page=${n}&limit=${h}&sort=${d}`,i=>i&&{...i,data:i.data.map(r=>r.id===a.id?{...r,likes:s!==void 0?s:r.likes,favorited:t}:r)},!1)}})]}),e.jsx("div",{className:"prose prose-invert prose-lg max-w-none text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:a.content}})]})]})})})}),e.jsx(O,{isOpen:z,onClose:()=>v(!1),onUpload:_,type:"article"})]})};export{oe as default};
